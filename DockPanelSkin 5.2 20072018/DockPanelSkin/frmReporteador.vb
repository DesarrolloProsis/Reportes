Imports Microsoft.Reporting.WinForms
Imports System.Reflection
Imports System.Data
Imports System.IO
Imports System.Data.SqlClient

Public Class frmReporteador

    Dim hr_fecha_ini_varios_turnos As Date
    Dim hr_fecha_fin_varios_turnos As Date
    Dim bl_varios_turnos As Boolean = False

    Dim loc_id_gare As Integer
    Dim loc_voie As String
    Dim strCarril As String

    Dim bl_sin_liquidar As Boolean

    Private Sub frmReporteador_FormClosed(sender As Object, e As FormClosedEventArgs) Handles Me.FormClosed



    End Sub

    Private Sub frmReporteador_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        'ReportViewer1.ShowExportButton
        For Each elemento As RenderingExtension In ReportViewer1.LocalReport.ListRenderingExtensions
            'ponemos la condición para entrar a poner falso la exportación a Excel y a Word
            'If elemento.Name = "Excel" Or elemento.Name = "Word" Then
            If elemento.Name <> "PDF" And elemento.Name <> "Excel" Then
                'traemos la información del campo con sus respectivos flags
                Dim infCampo As FieldInfo = elemento.[GetType]().GetField("m_isVisible", BindingFlags.Instance Or BindingFlags.NonPublic)
                'colocamos el valor de false a la extension 
                infCampo.SetValue(elemento, False)
            End If
        Next


        'ReportViewer1.ShowExportButton
        For Each elemento As RenderingExtension In ReportViewer2.LocalReport.ListRenderingExtensions
            'ponemos la condición para entrar a poner falso la exportación a Excel y a Word
            'If elemento.Name = "Excel" Or elemento.Name = "Word" Then
            If elemento.Name <> "PDF" Then
                'traemos la información del campo con sus respectivos flags
                Dim infCampo As FieldInfo = elemento.[GetType]().GetField("m_isVisible", BindingFlags.Instance Or BindingFlags.NonPublic)
                'colocamos el valor de false a la extension 
                infCampo.SetValue(elemento, False)
            End If
        Next


        'borrar()
        'Exit Sub

        'Me.ReportViewer1.RefreshReport()
        Me.WindowState = FormWindowState.Maximized

        '***********************Cambios Daniel(Prosis)************************************************
        fechaOpeTemp = ""
        '*********************************************************************************************

        Select Case Me.Tag
            Case 1
                PRELIQUIDACION_DE_CAJERO_RECEPTOR()

            Case 2
                PRELIQUIDACION_DE_TURNO()
            Case 3
                PRELIQUIDACION_PLAZA_DE_COBRO()
            Case 4
                BITACORA_DE_OPERACION()
            Case 5
                bl_sin_liquidar = False
                Preliquidacion_Cajero_Receptor_Transito_Vehicular(1)
                If bl_sin_liquidar = False Then
                    Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular(1)
                End If

            Case 6
                '    Preliquidación_de_Turno_Carriles()
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular(2)
            Case 7
                '2015 turno
                Preliquidacion_Cajero_Receptor_Transito_Vehicular(2)
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular(2)

            Case 8
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular(3)

            Case 9
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular(1)

            Case 10
                Preliquidacion_Cajero_Receptor_Transito_Vehicular(3)
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular(3)

            Case 11
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular_cerrados(1)

            Case 12
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular_cerrados(2)

            Case 13
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular_cerrados(3)

            Case 14
                Preliquidacion_Cajero_Receptor_Transito_Vehicular_cerrados(1)
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular_cerrados(1)


            Case 1411
                Preliquidacion_Cajero_Receptor_Transito_Vehicular_cerrados_II(1)
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular_cerrados_II(1)

            Case 15
                Preliquidacion_Cajero_Receptor_Transito_Vehicular_cerrados(2)
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular_cerrados(2)

            Case 16
                Preliquidacion_Cajero_Receptor_Transito_Vehicular_cerrados(3)
                Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular_cerrados(3)
        End Select

    End Sub


    Private Sub PRELIQUIDACION_PLAZA_DE_COBRO()

        Dim strQuerys As String
        Dim odataSetReporte As New DataSet
        Dim oDataTableReporte As DataTable = New DataTable("tabla_reporte")

        Dim h_inicio_turno As Date
        Dim h_fin_turno As Date


        'If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
        '    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
        '    'h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
        'ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
        '    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
        '    'h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
        'ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
        '    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
        '    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
        '    dt_Fecha_Inicio = h_inicio_turno
        '    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
        '    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
        '    h_fin_turno = dt_Fecha_Inicio
        'End If

        ReportViewer1.LocalReport.DataSources.Clear()
        ReportViewer1.LocalReport.ReportEmbeddedResource = "rpt_preliquidacion_ca_re_3.rdlc"

        Dim par_txtDelegacion As New ReportParameter()
        Dim par_txtFechaOperacion As New ReportParameter()
        Dim par_txtGeneracion As New ReportParameter()
        Dim par_txtNoPlazaCobro As New ReportParameter()
        'Dim par_txtTurno As New ReportParameter()



        par_txtDelegacion.Name = "par_txtDelegacion"
        par_txtDelegacion.Values.Add(str_delegacion)


        par_txtNoPlazaCobro.Name = "par_txtNoPlazaCobro"
        par_txtNoPlazaCobro.Values.Add(str_Plaza_Cobro)

        par_txtFechaOperacion.Name = "par_txtFechaOperacion"
        par_txtFechaOperacion.Values.Add(Format(dt_Fecha_Inicio, "MM/dd/yyyy"))

        par_txtGeneracion.Name = "par_txtGeneracion"
        par_txtGeneracion.Values.Add(Format(Now, "MM/dd/yyyy"))


        Dim parameters() As ReportParameter = {par_txtDelegacion, par_txtFechaOperacion, par_txtGeneracion, par_txtNoPlazaCobro}
        ReportViewer1.LocalReport.SetParameters(parameters)


        ReportViewer1.SetDisplayMode(DisplayMode.PrintLayout)
        Me.ReportViewer1.RefreshReport()

    End Sub


    Private Sub PRELIQUIDACION_DE_TURNO()

        Dim strQuerys As String
        Dim odataSetReporte As New DataSet
        Dim oDataTableReporte As DataTable = New DataTable("tabla_reporte")

        Dim h_inicio_turno As Date
        Dim h_fin_turno As Date


        'If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
        '    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
        '    'h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
        'ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
        '    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
        '    'h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
        'ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
        '    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
        '    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
        '    dt_Fecha_Inicio = h_inicio_turno
        '    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
        '    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
        '    h_fin_turno = dt_Fecha_Inicio
        'End If

        ReportViewer1.LocalReport.DataSources.Clear()
        ReportViewer1.LocalReport.ReportEmbeddedResource = "rpt_preliquidacion_ca_re_2.rdlc"

        Dim par_txtDelegacion As New ReportParameter()
        Dim par_txtFechaOperacion As New ReportParameter()
        Dim par_txtGeneracion As New ReportParameter()
        Dim par_txtNoPlazaCobro As New ReportParameter()
        Dim par_txtTurno As New ReportParameter()

        par_txtTurno.Name = "par_txtTurno"
        par_txtTurno.Values.Add(str_Turno_block)


        par_txtDelegacion.Name = "par_txtDelegacion"
        par_txtDelegacion.Values.Add(str_delegacion)


        par_txtNoPlazaCobro.Name = "par_txtNoPlazaCobro"
        par_txtNoPlazaCobro.Values.Add(str_Plaza_Cobro)

        par_txtFechaOperacion.Name = "par_txtFechaOperacion"
        par_txtFechaOperacion.Values.Add(Format(dt_Fecha_Inicio, "MM/dd/yyyy"))

        par_txtGeneracion.Name = "par_txtGeneracion"
        par_txtGeneracion.Values.Add(Format(Now, "MM/dd/yyyy"))


        Dim parameters() As ReportParameter = {par_txtDelegacion, par_txtFechaOperacion, par_txtGeneracion, par_txtNoPlazaCobro, par_txtTurno}
        ReportViewer1.LocalReport.SetParameters(parameters)


        ReportViewer1.SetDisplayMode(DisplayMode.PrintLayout)
        Me.ReportViewer1.RefreshReport()

    End Sub


    Private Sub PRELIQUIDACION_DE_CAJERO_RECEPTOR()

        Dim strQuerys As String
        Dim odataSetReporte As New DataSet
        Dim oDataTableReporte As DataTable = New DataTable("tabla_reporte")

        Dim h_inicio_turno As Date
        Dim h_fin_turno As Date


        If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
            'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
            'h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
        ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
            'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
            'h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
        ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
            'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
            h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
            dt_Fecha_Inicio = h_inicio_turno
            'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
            h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
            h_fin_turno = dt_Fecha_Inicio
        End If



        'PANTALLA: LISTA DE TURNOS
        strQuerys = "SELECT GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE_L2, GEADBA.FIN_POSTE.VOIE, TO_CHAR(GEADBA.FIN_POSTE.NUMERO_POSTE, 'FM09') AS Expr1, " &
        "TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'MM/DD/YY') AS Expr2, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'HH24:MI') AS Expr3, " &
        "GEADBA.FIN_POSTE.MATRICULE, GEADBA.FIN_POSTE.SAC AS Expr4, GEADBA.FIN_POSTE.ID_VOIE, " &
        "TO_CHAR(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE, 'YYYYMMDDHH24MISS') AS Expr5, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'YYYYMMDDHH24MISS') AS Expr6, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE, 0 AS Expr7 " &
        "FROM GEADBA.TYPE_VOIE, GEADBA.FIN_POSTE, GEADBA.SITE_GARE " &
        "WHERE GEADBA.TYPE_VOIE.ID_VOIE = GEADBA.FIN_POSTE.ID_VOIE AND GEADBA.FIN_POSTE.ID_RESEAU = GEADBA.SITE_GARE.ID_RESEAU AND " &
        "GEADBA.FIN_POSTE.ID_GARE = GEADBA.SITE_GARE.ID_GARE AND (GEADBA.SITE_GARE.ID_RESEAU = '01') AND (GEADBA.SITE_GARE.ID_SITE = '" & id_plaza_cobro & "') AND " &
        "(GEADBA.FIN_POSTE.ID_MODE_VOIE IN (1, 6, 7)) " &
        "AND (GEADBA.FIN_POSTE.DATE_FIN_POSTE >= TO_DATE('" & Format(dt_Fecha_Inicio, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
        "(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(dt_Fecha_Fin, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
        "AND (GEADBA.FIN_POSTE.ID_VOIE = '1' OR " &
        "GEADBA.FIN_POSTE.ID_VOIE = '2' OR " &
        "GEADBA.FIN_POSTE.ID_VOIE = '3' OR " &
        "GEADBA.FIN_POSTE.ID_VOIE = '4' OR " &
        "GEADBA.FIN_POSTE.ID_VOIE = 'X') " &
        "AND (GEADBA.FIN_POSTE.NUMERO_POSTE = " & id_Turno & ") AND (GEADBA.FIN_POSTE.MATRICULE = '" & str_Cajero_Receptor & "') " &
        "ORDER BY GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.ID_VOIE, GEADBA.FIN_POSTE.VOIE, GEADBA.FIN_POSTE.DATE_FIN_POSTE, " &
        "GEADBA.FIN_POSTE.NUMERO_POSTE, GEADBA.FIN_POSTE.MATRICULE, Expr4"
        'Tipo de via todos (GEADBA.FIN_POSTE.ID_VOIE)
        'Validar bolsa((Sac IS NOT NULL) AND (Sac = #))
        'Carril (Voie	= 	'x')

        'str_Turno_block
        'PANTALLA: LISTA DE TURNOS
        strQuerys = "SELECT GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE_L2, GEADBA.FIN_POSTE.VOIE, TO_CHAR(GEADBA.FIN_POSTE.NUMERO_POSTE, 'FM09') AS Expr1, " &
        "TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'MM/DD/YY') AS Expr2, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'HH24:MI') AS Expr3, " &
        "GEADBA.FIN_POSTE.MATRICULE, GEADBA.FIN_POSTE.SAC AS Expr4, GEADBA.FIN_POSTE.ID_VOIE, " &
        "TO_CHAR(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE, 'YYYYMMDDHH24MISS') AS Expr5, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'YYYYMMDDHH24MISS') AS Expr6, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE, 0 AS Expr7 " &
        "FROM GEADBA.TYPE_VOIE, GEADBA.FIN_POSTE, GEADBA.SITE_GARE " &
        "WHERE GEADBA.TYPE_VOIE.ID_VOIE = GEADBA.FIN_POSTE.ID_VOIE AND GEADBA.FIN_POSTE.ID_RESEAU = GEADBA.SITE_GARE.ID_RESEAU AND " &
        "GEADBA.FIN_POSTE.ID_GARE = GEADBA.SITE_GARE.ID_GARE AND (GEADBA.SITE_GARE.ID_RESEAU = '01') AND (GEADBA.SITE_GARE.ID_SITE = '" & id_plaza_cobro & "') AND " &
        "(GEADBA.FIN_POSTE.ID_MODE_VOIE IN (1, 6, 7)) "

        If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
            h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
            h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
        ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
            h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
            h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
        ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
            h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
            h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 21:59:59")
        End If

        strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
   "(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

        strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.ID_VOIE = '1' OR " &
       "GEADBA.FIN_POSTE.ID_VOIE = '2' OR " &
       "GEADBA.FIN_POSTE.ID_VOIE = '3' OR " &
       "GEADBA.FIN_POSTE.ID_VOIE = '4' OR " &
       "GEADBA.FIN_POSTE.ID_VOIE = 'X') " &
       "AND (GEADBA.FIN_POSTE.MATRICULE = '" & str_Cajero_Receptor & "') " &
       "ORDER BY GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.ID_VOIE, GEADBA.FIN_POSTE.VOIE, GEADBA.FIN_POSTE.DATE_FIN_POSTE, " &
       "GEADBA.FIN_POSTE.NUMERO_POSTE, GEADBA.FIN_POSTE.MATRICULE, Expr4"
        'AND (GEADBA.FIN_POSTE.NUMERO_POSTE = " & id_Turno & ") se elimina
        'Tipo de via todos (GEADBA.FIN_POSTE.ID_VOIE)
        'Validar bolsa((Sac IS NOT NULL) AND (Sac = #))
        'Carril (Voie	= 	'x')


        ReportViewer1.LocalReport.DataSources.Clear()
        ReportViewer1.LocalReport.ReportEmbeddedResource = "rpt_preliquidacion_ca_re.rdlc"

        Dim par_txtDelegacion As New ReportParameter()
        Dim par_txtFechaOperacion As New ReportParameter()
        Dim par_txtGeneracion As New ReportParameter()
        Dim par_txtNoPlazaCobro As New ReportParameter()
        Dim par_txtCajeroReceptor As New ReportParameter()
        Dim par_txtCarril As New ReportParameter()
        Dim par_txtTurno As New ReportParameter()
        Dim par_txtHoraApertura As New ReportParameter()
        Dim par_txtHoraCierre As New ReportParameter()
        Dim par_txtDiferencia As New ReportParameter()
        Dim par_txtDiferenciaEntregada As New ReportParameter()


        If objQuerys.QueryDataSet(strQuerys, "TYPE_VOIE") = 1 Then

            par_txtCarril.Name = "par_txtCarril"
            par_txtCarril.Values.Add(oDataRow("VOIE"))

            par_txtTurno.Name = "par_txtTurno"
            par_txtTurno.Values.Add(str_Turno_block)

            par_txtHoraApertura.Name = "par_txtHoraApertura"
            par_txtHoraApertura.Values.Add(Format(objControl.fecha(oDataRow("Expr5")), "MM/dd/yyyy HH:mm:ss"))

            par_txtFechaOperacion.Name = "par_txtFechaOperacion"
            par_txtFechaOperacion.Values.Add(Format(objControl.fecha(oDataRow("Expr5")), "MM/dd/yyyy"))

            par_txtHoraCierre.Name = "par_txtHoraCierre"
            par_txtHoraCierre.Values.Add(Format(objControl.fecha(oDataRow("Expr6")), "MM/dd/yyyy HH:mm:ss"))

            par_txtDelegacion.Name = "par_txtDelegacion"
            par_txtDelegacion.Values.Add(str_delegacion)

        Else

            MsgBox("No se ha realizado la declarción de ingresos", MsgBoxStyle.Exclamation, "PRELIQUIDACION DE CAJERO RECEPTOR")
            Me.Close()
            Exit Sub
        End If

        'pantalla:RESUMEN DE INGRESO CAJERO
        strQuerys = "SELECT MATRICULE, SAC AS Expr1, NVL(NB_POSTE, 0) + NVL(NB_POSTE_POS, 0) AS Expr2, NVL(RED_RCT_MONNAIE1, 0) AS Expr3, " &
                    "NVL(RED_RCT_CHQ, 0) AS Expr4, NVL(RED_NB_CHQ, 0) AS Expr5, NVL(RED_RCT_DEVISE, 0) AS Expr6, NVL(RED_RCT_MONNAIE3, 0) AS Expr7, " &
                    "NVL(RED_RCT_MONNAIE4, 0) AS Expr8, NVL(RED_CPT1, 0) AS Expr9, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) + NVL(RED_RCT_MONNAIE3, 0) " &
                    "+ NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_CHQ, 0) + NVL(RED_RCT_DEVISE, 0) AS Expr10, NVL(POSTE_RCT_MONNAIE1, 0) + NVL(POSTE_RCT_MONNAIE2, 0) " &
                    "+ NVL(POSTE_RCT_MONNAIE3, 0) + NVL(POSTE_RCT_MONNAIE4, 0) + NVL(POSTE_RCT_DEVISE, 0) + NVL(POSTE_RCT_CHQ, 0) + NVL(POSTE_POS_RCT_MONNAIE1, " &
                    "0) + NVL(POSTE_POS_RMB_MONNAIE1, 0) + NVL(POSTE_POS_RCT_MONNAIE2, 0) + NVL(POSTE_POS_RCT_MONNAIE3, 0) + NVL(POSTE_POS_RCT_MONNAIE4, 0) " &
                    "+ NVL(POSTE_POS_RCT_DEVISE, 0) + NVL(POSTE_POS_RCT_CHQ, 0) AS Expr11, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) " &
                    "+ NVL(RED_RCT_MONNAIE3, 0) + NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_DEVISE, 0) + NVL(RED_RCT_CHQ, 0) - NVL(POSTE_RCT_MONNAIE1, 0) " &
                    "- NVL(POSTE_RCT_MONNAIE2, 0) - NVL(POSTE_RCT_MONNAIE3, 0) - NVL(POSTE_RCT_MONNAIE4, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_RCT_CHQ, 0) " &
                    "- NVL(POSTE_POS_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE2, 0) - NVL(POSTE_POS_RCT_MONNAIE3, 0) " &
                    "- NVL(POSTE_POS_RCT_MONNAIE4, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr12, NVL(RED_RCT_MONNAIE1, 0) " &
                    "- NVL(POSTE_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE1, 0) AS Expr13, NVL(RED_RCT_CHQ, 0) " &
                    "- NVL(POSTE_RCT_CHQ, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr14, NVL(RED_RCT_DEVISE, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) " &
                    "AS Expr15, NVL(RED_CPT24, 0) AS Expr16, NVL(RED_CPT25, 0) AS Expr17, NVL(RED_JETON, 0) - NVL(POSTE_JETON, 0) AS Expr18, NVL(RED_RDD, 0) " &
                    "- NVL(POSTE_RDD, 0) AS Expr19, NVL(RED_GRATUIT, 0) + NVL(RED_CPT2, 0) - NVL(POSTE_GRATUIT, 0) AS Expr20, MATRICULE_COMMENTAIRE, COMMENTAIRE, " &
                    "0 AS Expr21, TO_CHAR(DATE_REDDITION, 'YYYYMMDDHH24MISS') AS Expr22, ID_SITE " &
                    "FROM REDDITION " &
                    "WHERE  (ID_SITE = '" & id_plaza_cobro & "') AND (MATRICULE = '" & oDataRow("MATRICULE") & "') AND (SAC = '" & oDataRow("Expr4") & "')"
        '(DATE_REDDITION = TO_DATE('20130206071615', 'YYYYMMDDHH24MISS')) AND 'no se obtiene

        If objQuerys.QueryDataSetDos(strQuerys, "REDDITION") = 1 Then


            par_txtGeneracion.Name = "par_txtGeneracion"
            par_txtGeneracion.Values.Add(Format(objControl.fecha(oDataRowDos("Expr22")), "MM/dd/yyyy HH:mm:ss"))

            par_txtDiferencia.Name = "par_txtDiferencia"
            par_txtDiferencia.Values.Add(Format(CDec(oDataRowDos("Expr10")) - CDec(oDataRowDos("Expr11")), "###,###,##0.00"))

            par_txtDiferenciaEntregada.Name = "par_txtDiferenciaEntregada"
            par_txtDiferenciaEntregada.Values.Add(Format(CDec(oDataRowDos("Expr10")), "###,###,##0.00"))

        Else


            'rpt_reporte = Nothing
            MsgBox("No se ha realizado la declarción de ingresos", MsgBoxStyle.Exclamation, "PRELIQUIDACION DE CAJERO RECEPTOR")
            Me.Close()
            Exit Sub

        End If

        strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
        "FROM TABLE_PERSONNEL " &
        "WHERE Matricule = '" & oDataRow("MATRICULE") & "'"
        If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

            par_txtCajeroReceptor.Name = "par_txtCajeroReceptor"
            par_txtCajeroReceptor.Values.Add(Trim(oDataRowTres("MATRICULE")) & "     " & Trim(oDataRowTres("nombre")))

        End If

        strQuerys = "SELECT  ID_RESEAU, ID_GARE, NOM_GARE, NOM_GARE_L2 " &
        "FROM GEADBA.TYPE_GARE " &
        "WHERE ID_GARE = " & oDataRow("ID_GARE") & ""

        If objQuerys.QueryDataSetTres(strQuerys, "TYPE_GARE") = 1 Then

            par_txtNoPlazaCobro.Name = "par_txtNoPlazaCobro"
            par_txtNoPlazaCobro.Values.Add(oDataRowTres("NOM_GARE"))

        End If



        Dim parameters() As ReportParameter = {par_txtDelegacion, par_txtFechaOperacion, par_txtGeneracion, par_txtNoPlazaCobro, par_txtCajeroReceptor, par_txtCarril, par_txtTurno, par_txtHoraApertura, par_txtHoraCierre, par_txtDiferencia, par_txtDiferenciaEntregada}
        ReportViewer1.LocalReport.SetParameters(parameters)


        ReportViewer1.SetDisplayMode(DisplayMode.PrintLayout)
        Me.ReportViewer1.RefreshReport()

    End Sub



    '***************
    Private Sub Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular(ByVal int_reporte As Integer)

        'tabla 1
        Dim strQuerys As String
        Dim odataSetReporte As New DataSet
        Dim oDataTableReporte As DataTable = New DataTable("tabla_reporte")
        Dim oDataColumnaReporte As DataColumn
        Dim oDatarowReporte As DataRow

        Dim odataSetReporte_total As New DataSet
        Dim oDataTableReporte_total As DataTable = New DataTable("tabla_reporte_total")
        Dim oDataColumnaReporte_total As DataColumn
        Dim oDatarowReporte_total As DataRow

        'tabla 2
        '------------------
        Dim odataSetReporte_2 As New DataSet
        Dim oDataTableReporte_2 As DataTable = New DataTable("tabla_reporte_2")
        Dim oDataColumnaReporte_2 As DataColumn
        Dim oDatarowReporte_2 As DataRow

        Dim odataSetReporte_total_2 As New DataSet
        Dim oDataTableReporte_total_2 As DataTable = New DataTable("tabla_reporte_total_2")
        Dim oDataColumnaReporte_total_2 As DataColumn
        Dim oDatarowReporte_total_2 As DataRow
        '------------------
        'tabla 3
        '------------------
        Dim odataSetReporte_3 As New DataSet
        Dim oDataTableReporte_3 As DataTable = New DataTable("tabla_reporte_3")
        Dim oDataColumnaReporte_3 As DataColumn
        Dim oDatarowReporte_3 As DataRow

        Dim odataSetReporte_total_3 As New DataSet
        Dim oDataTableReporte_total_3 As DataTable = New DataTable("tabla_reporte_total_3")
        Dim oDataColumnaReporte_total_3 As DataColumn
        Dim oDatarowReporte_total_3 As DataRow

        'tabla 4
        '------------------
        Dim odataSetReporte_4 As New DataSet
        Dim oDataTableReporte_4 As DataTable = New DataTable("tabla_reporte_4")
        Dim oDataColumnaReporte_4 As DataColumn
        Dim oDatarowReporte_4 As DataRow

        Dim odataSetReporte_total_4 As New DataSet
        Dim oDataTableReporte_total_4 As DataTable = New DataTable("tabla_reporte_total_4")
        Dim oDataColumnaReporte_total_4 As DataColumn
        Dim oDatarowReporte_total_4 As DataRow
        '------------------

        'tabla 5
        '------------------
        Dim odataSetReporte_5 As New DataSet
        Dim oDataTableReporte_5 As DataTable = New DataTable("tabla_reporte_5")
        Dim oDataColumnaReporte_5 As DataColumn
        Dim oDatarowReporte_5 As DataRow

        Dim odataSetReporte_total_5 As New DataSet
        Dim oDataTableReporte_total_5 As DataTable = New DataTable("tabla_reporte_total_5")
        Dim oDataColumnaReporte_total_5 As DataColumn
        Dim oDatarowReporte_total_5 As DataRow
        '------------------

        'tabla 6
        '------------------
        Dim odataSetReporte_6 As New DataSet
        Dim oDataTableReporte_6 As DataTable = New DataTable("tabla_reporte_6")
        Dim oDataColumnaReporte_6 As DataColumn
        Dim oDatarowReporte_6 As DataRow

        Dim odataSetReporte_total_6 As New DataSet
        Dim oDataTableReporte_total_6 As DataTable = New DataTable("tabla_reporte_total_6")
        Dim oDataColumnaReporte_total_6 As DataColumn
        Dim oDatarowReporte_total_6 As DataRow


        'tabla 7
        '------------------
        Dim odataSetReporte_7 As New DataSet
        Dim oDataTableReporte_7 As DataTable = New DataTable("tabla_reporte_7")
        Dim oDataColumnaReporte_7 As DataColumn
        Dim oDatarowReporte_7 As DataRow

        Dim odataSetReporte_total_7 As New DataSet
        Dim oDataTableReporte_total_7 As DataTable = New DataTable("tabla_reporte_total_7")
        Dim oDataColumnaReporte_total_7 As DataColumn
        Dim oDatarowReporte_total_7 As DataRow

        'tabla 8
        '------------------
        Dim odataSetReporte_8 As New DataSet
        Dim oDataTableReporte_8 As DataTable = New DataTable("tabla_reporte_8")
        Dim oDataColumnaReporte_8 As DataColumn
        Dim oDatarowReporte_8 As DataRow

        Dim odataSetReporte_total_8 As New DataSet
        Dim oDataTableReporte_total_8 As DataTable = New DataTable("tabla_reporte_total_8")
        Dim oDataColumnaReporte_total_8 As DataColumn
        Dim oDatarowReporte_total_8 As DataRow

        'tabla 9
        '------------------
        Dim odataSetReporte_9 As New DataSet
        Dim oDataTableReporte_9 As DataTable = New DataTable("tabla_reporte_9")
        Dim oDataColumnaReporte_9 As DataColumn
        Dim oDatarowReporte_9 As DataRow

        Dim odataSetReporte_total_9 As New DataSet
        Dim oDataTableReporte_total_9 As DataTable = New DataTable("tabla_reporte_total_9")
        Dim oDataColumnaReporte_total_9 As DataColumn
        Dim oDatarowReporte_total_9 As DataRow


        'tabla 10 tarjetas bancarias
        '------------------
        Dim odataSetReporte_10 As New DataSet
        Dim oDataTableReporte_10 As DataTable = New DataTable("tabla_reporte_10")
        Dim oDataColumnaReporte_10 As DataColumn
        Dim oDatarowReporte_10 As DataRow

        Dim odataSetReporte_total_10 As New DataSet
        Dim oDataTableReporte_total_10 As DataTable = New DataTable("tabla_reporte_total_10")
        Dim oDataColumnaReporte_total_10 As DataColumn
        Dim oDatarowReporte_total_10 As DataRow


        Dim strGrupo As String
        Dim strConcepto As String



        '---------------------------------------------------
        '--------------------------------------------------
        Dim strQuerys_varios_cortes As String

        'Dim hr_fecha_ini_varios_turnos As Date
        'Dim hr_fecha_fin_varios_turnos As Date
        'Dim bl_varios_turnos As Boolean = False

        Dim str_id_RESEAU As String
        Dim int_id_gare As Integer
        Dim str_id_voie As String
        Dim int_id_voie As String 'Integer
        Dim int_numero_poste As Integer
        Dim dt_ini_poste As Date
        Dim dt_fin_poste As Date
        Dim str_MATRICULE As String

        Dim str_cajero As String = str_Cajero_Receptor
        Dim id_plaza_cobro_local As String = id_plaza_cobro

        Dim h_inicio_turno As Date
        Dim h_fin_turno As Date

        Dim dvEvento As DataView
        Dim dvEventoDos As DataView
        Dim dvTarifa As DataView

        Dim cont As Integer

        Dim db_tot_14 As Double
        Dim db_tot_15 As Double
        Dim db_tot_16 As Double
        Dim db_tot_18 As Double
        Dim db_tot_20 As Double
        Dim db_tot_22 As Double
        Dim db_tot_24 As Double
        Dim db_tot_26 As Double
        Dim db_tot_28 As Double
        Dim db_tot_30 As Double
        Dim db_tot_32 As Double

        Dim db_tot_35 As Double
        Dim db_tot_36 As Double

        Dim db_tot_38 As Double

        Dim db_tot_45 As Double
        Dim db_tot_451 As Double
        Dim db_tot_452 As Double
        Dim db_tot_453 As Double
        Dim db_tot_454 As Double
        Dim db_tot_455 As Double


        Dim db_tot_46 As Double
        Dim db_tot_461 As Double
        Dim db_tot_462 As Double
        Dim db_tot_463 As Double
        Dim db_tot_464 As Double
        Dim db_tot_465 As Double

        Dim db_tot_47 As Double
        Dim db_tot_471 As Double
        Dim db_tot_472 As Double
        Dim db_tot_473 As Double
        Dim db_tot_474 As Double
        Dim db_tot_475 As Double

        Dim db_tot_48 As Double
        Dim db_tot_49 As Double
        Dim db_tot_50 As Double

        Dim db_tot_53 As Double
        Dim db_tot_531 As Double
        Dim db_tot_532 As Double

        Dim db_tot_54 As Double
        Dim db_tot_541 As Double
        Dim db_tot_542 As Double

        Dim db_tot_55 As Double
        Dim db_tot_56 As Double
        Dim db_tot_57 As Double
        Dim db_tot_58 As Double


        Dim db_tot_77 As Double
        Dim db_tot_78 As Double
        Dim db_tot_80 As Double
        Dim db_tot_81 As Double


        Dim db_tot_61 As Double
        Dim db_tot_63 As Double


        Dim db_tot_67 As Double
        Dim db_tot_69 As Double

        Dim db_tot_73 As Double
        Dim db_tot_75 As Double


        'tarjetas bancarias
        Dim db_tot_146 As Double
        Dim db_tot_1461 As Double


        Dim db_tot_147 As Double
        Dim db_tot_1471 As Double


        Dim db_tot_148 As Double
        Dim db_tot_149 As Double
        Dim db_tot_150 As Double


        Dim int_version_tarifa As Double
        Dim dbl_tarifa_excedentes_asignada As Double
        'int_reporte
        'cajero-receptor = 1
        'turno = 2
        'caseta = 3

        Dim No_Turno As String
        Dim id_turno As Integer

        Dim db_acom_excedentes As Double

        Dim bl_carril_automatico As Boolean

        '---------------------------------------------------
        '--------------------------------------------------
        Try

            ReportViewer2.LocalReport.DataSources.Clear()
            ReportViewer2.LocalReport.ReportEmbeddedResource = "rpt_Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular.rdlc"

            'reporte cajero receptor
            If int_reporte = 1 Then

                '--------------------------------------------------------
                '--------------------------------------------------------
                'verifico cuantos cortes tiene en ese turno

                strQuerys = "SELECT GEADBA.FIN_POSTE.ID_RESEAU, GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE_L2, GEADBA.FIN_POSTE.VOIE, TO_CHAR(GEADBA.FIN_POSTE.NUMERO_POSTE, 'FM09') AS Expr1, " &
          "TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'MM/DD/YY') AS Expr2, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'HH24:MI') AS Expr3, " &
          "GEADBA.FIN_POSTE.MATRICULE, GEADBA.FIN_POSTE.SAC AS Expr4, GEADBA.FIN_POSTE.ID_VOIE, " &
          "TO_CHAR(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE, 'YYYYMMDDHH24MISS') AS Expr5, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'YYYYMMDDHH24MISS') AS Expr6, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE, 0 AS Expr7, " &
          "FOLIO_NUMBER_CLOSE, INITIAL_EVENT_NUMBER, FINAL_EVENT_NUMBER " &
          "FROM GEADBA.TYPE_VOIE, GEADBA.FIN_POSTE, GEADBA.SITE_GARE " &
          "WHERE GEADBA.TYPE_VOIE.ID_VOIE = GEADBA.FIN_POSTE.ID_VOIE AND GEADBA.FIN_POSTE.ID_RESEAU = GEADBA.SITE_GARE.ID_RESEAU AND " &
          "GEADBA.FIN_POSTE.ID_GARE = GEADBA.SITE_GARE.ID_GARE AND (GEADBA.SITE_GARE.ID_RESEAU = '01') AND (GEADBA.SITE_GARE.ID_SITE = '" & id_plaza_cobro_local & "') AND " &
          "(GEADBA.FIN_POSTE.ID_MODE_VOIE IN (1, 6, 7)) "

                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "5 MATUTINO"
                    id_turno = 2
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "6 VESPERTINO"
                    id_turno = 3
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "4 NOCTURNO"
                    id_turno = 1
                End If

                strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "



                '    strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_FIN_POSTE >= TO_DATE('" & Format(dt_Fecha_Inicio, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '"(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(dt_Fecha_Fin, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "
                strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.ID_VOIE = '1' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '2' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '3' OR " &
               "GEADBA.FIN_POSTE.ID_VOIE = '4' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = 'X') " &
             "AND (GEADBA.FIN_POSTE.MATRICULE = '" & str_cajero & "') and GEADBA.FIN_POSTE.VOIE = '" & loc_voie & "' " &
             "ORDER BY GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.ID_VOIE, GEADBA.FIN_POSTE.VOIE, GEADBA.FIN_POSTE.DATE_FIN_POSTE, " &
             "GEADBA.FIN_POSTE.NUMERO_POSTE, GEADBA.FIN_POSTE.MATRICULE, Expr4"
                'AND (GEADBA.FIN_POSTE.NUMERO_POSTE = " & id_Turno & ")

                If objQuerys.QueryDataSet(strQuerys, "TYPE_VOIE") = 1 Then

                    If oDataSet.Tables("TYPE_VOIE").Rows.Count = 1 Then
                    ElseIf oDataSet.Tables("TYPE_VOIE").Rows.Count > 1 Then

                        'Dim frmListas As New frmLineas
                        'objControl.limpia_Catalogos()
                        'frmListas.Tag = 4

                        strLinea = strQuerys
                        'If strCarril = Nothing Then
                        '    Exit Sub
                        'End If

                        'frmListas.ShowDialog()
                        'If Trim(strLinea1) <> "" Then

                        'bl_varios_turnos = True

                        'hr_fecha_ini_varios_turnos = CDate(strLinea1)
                        'hr_fecha_fin_varios_turnos = CDate(strLinea2)
                        '

                    End If

                End If

                'fin de verifico cuantos cortes tiene en ese turno




                '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Inicio
                'DATOS GENERALES

                strQuerys = "SELECT GEADBA.FIN_POSTE.ID_RESEAU, GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE_L2, GEADBA.FIN_POSTE.VOIE, TO_CHAR(GEADBA.FIN_POSTE.NUMERO_POSTE, 'FM09') AS Expr1, " &
            "TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'MM/DD/YY') AS Expr2, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'HH24:MI') AS Expr3, " &
            "GEADBA.FIN_POSTE.MATRICULE, GEADBA.FIN_POSTE.SAC AS Expr4, GEADBA.FIN_POSTE.ID_VOIE, " &
            "TO_CHAR(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE, 'YYYYMMDDHH24MISS') AS Expr5, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'YYYYMMDDHH24MISS') AS Expr6, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE, 0 AS Expr7, " &
            "FOLIO_NUMBER_OPEN, FOLIO_NUMBER_CLOSE, INITIAL_EVENT_NUMBER, FINAL_EVENT_NUMBER, FOLIO_ECT_NUMBER_INITIAL, FOLIO_ECT_NUMBER_FINAL " &
            "FROM GEADBA.TYPE_VOIE, GEADBA.FIN_POSTE, GEADBA.SITE_GARE " &
            "WHERE GEADBA.TYPE_VOIE.ID_VOIE = GEADBA.FIN_POSTE.ID_VOIE AND GEADBA.FIN_POSTE.ID_RESEAU = GEADBA.SITE_GARE.ID_RESEAU AND " &
            "GEADBA.FIN_POSTE.ID_GARE = GEADBA.SITE_GARE.ID_GARE AND (GEADBA.SITE_GARE.ID_RESEAU = '01') AND (GEADBA.SITE_GARE.ID_SITE = '" & id_plaza_cobro_local & "') AND " &
            "(GEADBA.FIN_POSTE.ID_MODE_VOIE IN (1, 6, 7)) "


                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                End If

                If bl_varios_turnos = False Then

                    strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

                Else

                    '         strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(hr_fecha_ini_varios_turnos, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                    '"(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(hr_fecha_fin_varios_turnos, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

                    strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE = TO_DATE('" & Format(hr_fecha_ini_varios_turnos, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS'))  "

                End If

                strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.ID_VOIE = '1' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '2' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '3' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '4' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = 'X') " &
             "AND (GEADBA.FIN_POSTE.MATRICULE = '" & str_cajero & "') and GEADBA.FIN_POSTE.VOIE = '" & loc_voie & "'  " &
             "ORDER BY GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.ID_VOIE, GEADBA.FIN_POSTE.VOIE, GEADBA.FIN_POSTE.DATE_FIN_POSTE, " &
             "GEADBA.FIN_POSTE.NUMERO_POSTE, GEADBA.FIN_POSTE.MATRICULE, Expr4"

                Dim par1 As New ReportParameter()
                Dim par2 As New ReportParameter()
                Dim par3 As New ReportParameter()
                Dim par4 As New ReportParameter()
                Dim par5 As New ReportParameter()
                Dim par6 As New ReportParameter()
                Dim par7 As New ReportParameter()
                Dim par8 As New ReportParameter()
                Dim par9 As New ReportParameter()
                Dim par10 As New ReportParameter()
                Dim par11 As New ReportParameter()
                Dim parTituloCajeroReceptor As New ReportParameter()
                Dim parTituloNoCarril As New ReportParameter()
                Dim parTituloHoraInicial As New ReportParameter()
                Dim parTituloHoraFinal As New ReportParameter()
                Dim parTituloFolioInicial As New ReportParameter()
                Dim parTituloFolioFinal As New ReportParameter()
                Dim parTituloTurno As New ReportParameter()

                Dim parTituloNoNombreDelegacion As New ReportParameter()
                Dim parNoNombreCaseta As New ReportParameter()
                Dim parFechaOperacion As New ReportParameter()
                Dim parFechaEdicion As New ReportParameter()
                Dim parTituloReporte As New ReportParameter()

                Dim parRec As New ReportParameter()

                If objQuerys.QueryDataSet(strQuerys, "TYPE_VOIE") = 1 Then

                    For PosicionFilaActual = 0 To oDataSet.Tables("TYPE_VOIE").Rows.Count - 1

                        oDataRow = oDataSet.Tables("TYPE_VOIE").Rows(PosicionFilaActual)

                        par1.Name = "par1"
                        par1.Values.Add(str_delegacion)

                        par3.Name = "par3"
                        par3.Values.Add(oDataRow("VOIE"))

                        str_id_voie = oDataRow("VOIE")
                        int_id_voie = oDataRow("ID_VOIE")
                        int_numero_poste = CInt(oDataRow("Expr1"))

                        par4.Name = "par4"
                        par4.Values.Add(No_Turno)

                        'If bl_varios_turnos = False Then
                        '    par4.Values.Add(str_Turno_block)
                        'Else
                        '    If CInt(Format(objControl.fecha(oDataRow("Expr5")), "HH")) >= 6 And CInt(Format(objControl.fecha(oDataRow("Expr5")), "HH")) < 14 Then
                        '        par4.Values.Add(gl_turno_2)
                        '    ElseIf CInt(Format(objControl.fecha(oDataRow("Expr5")), "HH")) >= 14 And CInt(Format(objControl.fecha(oDataRow("Expr5")), "HH")) < 22 Then
                        '        par4.Values.Add(gl_turno_3)
                        '    Else
                        '        par4.Values.Add(gl_turno_1)
                        '    End If
                        'End If

                        'par6.Name = "par6"
                        'par6.Values.Add(Format(objControl.fecha(oDataRow("Expr5")), "MM/dd/yyyy"))

                        par5.Name = "par5"
                        'par5.Values.Add(Format((dt_Fecha_Inicio), "MM/dd/yyyy"))
                        par5.Values.Add(Format((dt_Fecha_Inicio), "dd/MM/yyyy"))

                        par8.Name = "par8"
                        'par8.Values.Add(Format(objControl.fecha(oDataRow("Expr5")), "MM/dd/yyyy HH:mm:ss"))
                        'par8.Values.Add(Format(objControl.fecha(oDataRow("Expr5")), "dd/MM/yyyy HH:mm:ss"))
                        par8.Values.Add(Format(objControl.fecha(oDataRow("Expr5")), "HH:mm:ss"))
                        dt_ini_poste = Format(objControl.fecha(oDataRow("Expr5")), "MM/dd/yyyy HH:mm:ss")

                        par9.Name = "par9"
                        'par9.Values.Add(Format(objControl.fecha(oDataRow("Expr6")), "MM/dd/yyyy HH:mm:ss"))
                        'par9.Values.Add(Format(objControl.fecha(oDataRow("Expr6")), "dd/MM/yyyy HH:mm:ss"))
                        par9.Values.Add(Format(objControl.fecha(oDataRow("Expr6")), "HH:mm:ss"))
                        dt_fin_poste = Format(objControl.fecha(oDataRow("Expr6")), "MM/dd/yyyy HH:mm:ss")

                        'VERIFICO SI EL CARRIL ES AUTOMATICO
                        'str_id_voie
                        bl_carril_automatico = False
                        'TLALPAN
                        If id_plaza_cobro_local = "08" Then

                            If str_id_voie = "A08" Or str_id_voie = "A09" Or str_id_voie = "B01" Then
                                bl_carril_automatico = True
                            End If
                        End If

                        par10.Name = "par10"
                        par11.Name = "par11"


                        If oDataRow("FOLIO_ECT_NUMBER_INITIAL") < oDataRow("FOLIO_ECT_NUMBER_FINAL") Then


                            If bl_carril_automatico = False Then
                                par10.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_INITIAL"), "###,###,###,##0"))
                                par11.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_FINAL"), "###,###,###,##0"))
                            Else
                                strQuerys = "select  MIN(FOLIO_ECT) AS FOLIO_ECT_NUMBER_INITIAL_C, MAX(FOLIO_ECT) AS FOLIO_ECT_NUMBER_FINAL_C FROM TRANSACTION WHERE ID_GARE = '" & oDataRow("ID_GARE") & "' AND ID_VOIE  = '" & oDataRow("ID_VOIE") & "'  AND VOIE  = '" & oDataRow("VOIE") & "' " &
                    "AND  DATE_DEBUT_POSTE = TO_DATE('" & oDataRow("Expr5") & "', 'YYYYMMDDHH24MISS') and FOLIO_ECT <> 0 "
                                '= TO_DATE('" & Format(oDataRow("Expr5"), "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')

                                If objQuerys.QueryDataSetDos(strQuerys, "TRANSACTION") = 1 Then


                                    If Not IsDBNull(oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C")) Then
                                        par10.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C"), "###,###,###,##0"))
                                        par11.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C"), "###,###,###,##0"))
                                    Else
                                        par10.Values.Add(Format(0, "###,###,###,##0"))
                                        par11.Values.Add(Format(0, "###,###,###,##0"))
                                    End If

                                End If
                            End If

                        Else

                            strQuerys = "select  MIN(FOLIO_ECT) AS FOLIO_ECT_NUMBER_INITIAL_C, MAX(FOLIO_ECT) AS FOLIO_ECT_NUMBER_FINAL_C FROM TRANSACTION WHERE ID_GARE = '" & oDataRow("ID_GARE") & "' AND ID_VOIE  = '" & oDataRow("ID_VOIE") & "'  AND VOIE  = '" & oDataRow("VOIE") & "' " &
                           "AND  DATE_DEBUT_POSTE = TO_DATE('" & oDataRow("Expr5") & "', 'YYYYMMDDHH24MISS') and FOLIO_ECT <> 0 "
                            '= TO_DATE('" & Format(oDataRow("Expr5"), "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')

                            If objQuerys.QueryDataSetDos(strQuerys, "TRANSACTION") = 1 Then


                                If Not IsDBNull(oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C")) Then
                                    par10.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C"), "###,###,###,##0"))
                                    par11.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C"), "###,###,###,##0"))
                                Else
                                    par10.Values.Add(Format(0, "###,###,###,##0"))
                                    par11.Values.Add(Format(0, "###,###,###,##0"))
                                End If

                            End If



                        End If





                        '---------------------------------

                    Next
                Else
                    'rpt_reporte = Nothing
                    MsgBox("No existen datos", MsgBoxStyle.Exclamation, "PRELIQUIDACION DE CAJERO RECEPTOR")
                    Me.Close()
                    Exit Sub
                End If


                'OPERADOR
                strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
             "FROM TABLE_PERSONNEL " &
             "WHERE Matricule = '" & oDataRow("MATRICULE") & "'"
                If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                    par7.Name = "par7"
                    'par7.Values.Add(Trim(oDataRowTres("MATRICULE")) & "     " & Trim(oDataRowTres("nombre")))
                    par7.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", oDataRowTres("Matricule"))) & "     " & Trim(oDataRowTres("nombre")))
                    str_MATRICULE = Trim(oDataRowTres("MATRICULE"))
                End If

                strQuerys = "SELECT  ID_RESEAU, ID_GARE, NOM_GARE, NOM_GARE_L2 " &
             "FROM GEADBA.TYPE_GARE " &
             "WHERE ID_GARE = " & oDataRow("ID_GARE") & ""

                If objQuerys.QueryDataSetTres(strQuerys, "TYPE_GARE") = 1 Then

                    par2.Name = "par2"

                    If id_plaza_cobro_local <> "08" Then

                        If id_plaza_cobro_local <> "09" Then
                            par2.Values.Add("1" & id_plaza_cobro_local & " " & oDataRowTres("NOM_GARE"))
                        Else
                            par2.Values.Add("001 BIS" & " " & oDataRowTres("NOM_GARE"))
                        End If

                    Else
                        par2.Values.Add("001" & " " & oDataRowTres("NOM_GARE"))
                    End If



                    int_id_gare = oDataRowTres("ID_GARE")

                    str_id_RESEAU = oDataRowTres("ID_RESEAU")

                End If

                'pantalla:RESUMEN DE INGRESO CAJERO
                strQuerys = "SELECT MATRICULE,SAC AS Expr1, NVL(NB_POSTE, 0) + NVL(NB_POSTE_POS, 0) AS Expr2, NVL(RED_RCT_MONNAIE1, 0) AS Expr3, " &
                            "NVL(RED_RCT_CHQ, 0) AS Expr4, NVL(RED_NB_CHQ, 0) AS Expr5, NVL(RED_RCT_DEVISE, 0) AS Expr6, NVL(RED_RCT_MONNAIE3, 0) AS Expr7, " &
                            "NVL(RED_RCT_MONNAIE4, 0) AS Expr8, NVL(RED_CPT1, 0) AS Expr9, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) + NVL(RED_RCT_MONNAIE3, 0) " &
                            "+ NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_CHQ, 0) + NVL(RED_RCT_DEVISE, 0) AS Expr10, NVL(POSTE_RCT_MONNAIE1, 0) + NVL(POSTE_RCT_MONNAIE2, 0) " &
                            "+ NVL(POSTE_RCT_MONNAIE3, 0) + NVL(POSTE_RCT_MONNAIE4, 0) + NVL(POSTE_RCT_DEVISE, 0) + NVL(POSTE_RCT_CHQ, 0) + NVL(POSTE_POS_RCT_MONNAIE1, " &
                            "0) + NVL(POSTE_POS_RMB_MONNAIE1, 0) + NVL(POSTE_POS_RCT_MONNAIE2, 0) + NVL(POSTE_POS_RCT_MONNAIE3, 0) + NVL(POSTE_POS_RCT_MONNAIE4, 0) " &
                            "+ NVL(POSTE_POS_RCT_DEVISE, 0) + NVL(POSTE_POS_RCT_CHQ, 0) AS Expr11, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) " &
                            "+ NVL(RED_RCT_MONNAIE3, 0) + NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_DEVISE, 0) + NVL(RED_RCT_CHQ, 0) - NVL(POSTE_RCT_MONNAIE1, 0) " &
                            "- NVL(POSTE_RCT_MONNAIE2, 0) - NVL(POSTE_RCT_MONNAIE3, 0) - NVL(POSTE_RCT_MONNAIE4, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_RCT_CHQ, 0) " &
                            "- NVL(POSTE_POS_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE2, 0) - NVL(POSTE_POS_RCT_MONNAIE3, 0) " &
                            "- NVL(POSTE_POS_RCT_MONNAIE4, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr12, NVL(RED_RCT_MONNAIE1, 0) " &
                            "- NVL(POSTE_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE1, 0) AS Expr13, NVL(RED_RCT_CHQ, 0) " &
                            "- NVL(POSTE_RCT_CHQ, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr14, NVL(RED_RCT_DEVISE, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) " &
                            "AS Expr15, NVL(RED_CPT24, 0) AS Expr16, NVL(RED_CPT25, 0) AS Expr17, NVL(RED_JETON, 0) - NVL(POSTE_JETON, 0) AS Expr18, NVL(RED_RDD, 0) " &
                            "- NVL(POSTE_RDD, 0) AS Expr19, NVL(RED_GRATUIT, 0) + NVL(RED_CPT2, 0) - NVL(POSTE_GRATUIT, 0) AS Expr20, MATRICULE_COMMENTAIRE, COMMENTAIRE, " &
                            "0 AS Expr21, TO_CHAR(DATE_REDDITION, 'YYYYMMDDHH24MISS') AS Expr22, ID_SITE " &
                            "FROM REDDITION " &
                            "WHERE  (ID_SITE = '" & id_plaza_cobro_local & "') AND (MATRICULE = '" & oDataRow("MATRICULE") & "') AND (SAC = '" & oDataRow("Expr4") & "') AND TRIM(RED_TXT1) = '" & loc_voie & "' "
                '(DATE_REDDITION = TO_DATE('20130206071615', 'YYYYMMDDHH24MISS')) AND 'no se obtiene

                If objQuerys.QueryDataSetDos(strQuerys, "REDDITION") = 1 Then

                    'par5.Name = "par5"
                    'par5.Values.Add(Format(objControl.fecha(oDataRowDos("Expr22")), "MM/dd/yyyy HH:mm:ss"))

                    par6.Name = "par6"
                    'par6.Values.Add(Format(objControl.fecha(oDataRowDos("Expr22")), "MM/dd/yyyy HH:mm:ss"))
                    'par6.Values.Add(Format(objControl.fecha(oDataRowDos("Expr22")), "dd/MM/yyyy HH:mm:ss"))
                    par6.Values.Add(Format(objControl.fecha(oDataRowDos("Expr22")), "dd/MM/yyyy"))

                End If

                parTituloCajeroReceptor.Name = "parTituloCajeroReceptor"
                parTituloCajeroReceptor.Values.Add("No. y Nombre del C-Receptor:")

                parTituloNoCarril.Name = "parTituloNoCarril"
                parTituloNoCarril.Values.Add("No.Carril:")

                parTituloHoraInicial.Name = "parTituloHoraInicial"
                parTituloHoraInicial.Values.Add("Hora Inicial:")

                parTituloHoraFinal.Name = "parTituloHoraFinal"
                parTituloHoraFinal.Values.Add("Hora Final:")

                parTituloFolioInicial.Name = "parTituloFolioInicial"
                parTituloFolioInicial.Values.Add("Folio Inicial:")

                parTituloFolioFinal.Name = "parTituloFolioFinal"
                parTituloFolioFinal.Values.Add("Folio Final:")

                parTituloTurno.Name = "porTituloTurno"
                parTituloTurno.Values.Add("No.Turno:")

                parTituloNoNombreDelegacion.Name = "parTituloNoNombreDelegacion"
                parTituloNoNombreDelegacion.Values.Add("No. y Nombre de Delegación:")

                parNoNombreCaseta.Name = "parNoNombreCaseta"
                parNoNombreCaseta.Values.Add("No. y Nombre de Caseta:")

                parFechaOperacion.Name = "parFechaOperacion"
                parFechaOperacion.Values.Add("Fecha de Operación:")

                parFechaEdicion.Name = "parFechaEdicion"
                parFechaEdicion.Values.Add("Fecha de emisión:")

                'parTituloReporte
                'REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR CAJERO-RECEPTOR
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR CAJERO-RECEPTOR")

                parRec.Name = "parRec"
                parRec.Values.Add(Reclasificados)

                Dim parameters() As ReportParameter = {par1, par2, par3, par4, par5, par6, par7, par8, par9, par10, par11, parTituloCajeroReceptor, parTituloNoCarril, parTituloHoraInicial, parTituloHoraFinal, parTituloFolioInicial, parTituloFolioFinal, parTituloTurno, parTituloNoNombreDelegacion, parNoNombreCaseta, parFechaOperacion, parFechaEdicion, parTituloReporte, parRec}
                ReportViewer2.LocalReport.SetParameters(parameters)

                'reporte turno
            ElseIf int_reporte = 2 Then


                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "5 MATUTINO"
                    id_turno = 2
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "6 VESPERTINO"
                    id_turno = 3
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "4 NOCTURNO"
                    id_turno = 1
                End If


                Dim parNoNombreCaseta As New ReportParameter()
                Dim par2 As New ReportParameter()

                parNoNombreCaseta.Name = "parNoNombreCaseta"
                parNoNombreCaseta.Values.Add("No. y Nombre de Delegación:")

                par2.Name = "par2"
                par2.Values.Add(str_delegacion)

                Dim parTituloCajeroReceptor As New ReportParameter()
                Dim par7 As New ReportParameter()

                parTituloCajeroReceptor.Name = "parTituloCajeroReceptor"
                parTituloCajeroReceptor.Values.Add("No. y Nombre de Caseta:")

                'par7.Name = "par7"
                ''+++par7.Values.Add(str_Plaza_Cobro)

                'If id_plaza_cobro_local <> "08" Then
                '    par7.Values.Add("1" & str_Plaza_Cobro)
                'Else
                '    par7.Values.Add("001" & " " & str_Plaza_Cobro)
                'End If


                '+++inicio

                strQuerys = "SELECT ID_SITE, NOM_SITE, NOM_SITE_L2 FROM TYPE_SITE where ID_SITE = '" & Trim(id_plaza_cobro_local) & "'"

                If objQuerys.QueryDataSetTres(strQuerys, "TYPE_SITE") = 1 Then

                    par7.Name = "par7"

                    If id_plaza_cobro_local <> "08" Then
                        If id_plaza_cobro_local <> "09" Then
                            par7.Values.Add("1" & id_plaza_cobro_local & " " & oDataRowTres("NOM_SITE"))
                        Else
                            par7.Values.Add("001 BIS" & " " & oDataRowTres("NOM_SITE"))
                        End If

                    Else
                        par7.Values.Add("001" & " " & oDataRowTres("NOM_SITE"))
                    End If


                End If

                '++++fin


                'par7.Values.Add(str_Plaza_Cobro)


                Dim parTituloNoCarril As New ReportParameter()
                Dim par3 As New ReportParameter()

                parTituloNoCarril.Name = "parTituloNoCarril"
                parTituloNoCarril.Values.Add("No.Turno:")

                par3.Name = "par3"
                par3.Values.Add(No_Turno)

                Dim parTituloHoraInicial As New ReportParameter()

                parTituloHoraInicial.Name = "parTituloHoraInicial"
                parTituloHoraInicial.Values.Add("Tipo de Cambio Aplicado")

                Dim porTituloTurno As New ReportParameter()
                Dim par4 As New ReportParameter()

                porTituloTurno.Name = "porTituloTurno"
                porTituloTurno.Values.Add("Fecha de Operación:")

                par4.Name = "par4"

                If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    par4.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "MM/dd/yyyy"))
                Else
                    par4.Values.Add(Format(dt_ini_poste, "MM/dd/yyyy"))
                End If

                Dim parTituloHoraFinal As New ReportParameter()
                Dim par9 As New ReportParameter()

                parTituloHoraFinal.Name = "parTituloHoraFinal"
                parTituloHoraFinal.Values.Add("Fecha de emisión:")

                par9.Name = "par9"
                par9.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR TURNO")

                Dim parRec As New ReportParameter()
                parRec.Name = "parRec"
                parRec.Values.Add(Reclasificados)

                Dim parameters() As ReportParameter = {parNoNombreCaseta, par2, parTituloCajeroReceptor, par7, parTituloNoCarril, par3, parTituloHoraInicial, porTituloTurno, par4, parTituloHoraFinal, par9, parTituloReporte, parTituloReporte, parRec}
                ReportViewer2.LocalReport.SetParameters(parameters)

                'dt_ini_poste()
                'dt_fin_poste()

            ElseIf int_reporte = 3 Then

                'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")


                Dim parNoNombreCaseta As New ReportParameter()
                Dim par2 As New ReportParameter()

                parNoNombreCaseta.Name = "parNoNombreCaseta"
                parNoNombreCaseta.Values.Add("No. y Nombre de Delegación:")

                par2.Name = "par2"
                par2.Values.Add(str_delegacion)

                Dim parTituloCajeroReceptor As New ReportParameter()
                Dim par7 As New ReportParameter()

                parTituloCajeroReceptor.Name = "parTituloCajeroReceptor"
                parTituloCajeroReceptor.Values.Add("No. y Nombre de Caseta:")

                'par7.Name = "par7"
                ''+++par7.Values.Add(str_Plaza_Cobro)
                'If id_plaza_cobro_local <> "08" Then
                '    par7.Values.Add("1" & str_Plaza_Cobro)
                'Else
                '    par7.Values.Add("001" & " " & str_Plaza_Cobro)
                'End If
                '+++inicio

                strQuerys = "SELECT ID_SITE, NOM_SITE, NOM_SITE_L2 FROM TYPE_SITE where ID_SITE = '" & Trim(id_plaza_cobro_local) & "'"

                If objQuerys.QueryDataSetTres(strQuerys, "TYPE_SITE") = 1 Then

                    par7.Name = "par7"

                    If id_plaza_cobro_local <> "08" Then
                        If id_plaza_cobro_local <> "09" Then
                            par7.Values.Add("1" & id_plaza_cobro_local & " " & oDataRowTres("NOM_SITE"))
                        Else
                            par7.Values.Add("001 BIS" & " " & oDataRowTres("NOM_SITE"))
                        End If

                    Else
                        par7.Values.Add("001" & " " & oDataRowTres("NOM_SITE"))
                    End If


                End If

                '++++fin





                'Dim parTituloNoCarril As New ReportParameter()
                'Dim par3 As New ReportParameter()

                'parTituloNoCarril.Name = "parTituloNoCarril"
                'parTituloNoCarril.Values.Add("No.Turno:")

                'par3.Name = "par3"
                'par3.Values.Add(str_Turno_block)

                Dim parTituloHoraInicial As New ReportParameter()

                parTituloHoraInicial.Name = "parTituloHoraInicial"
                parTituloHoraInicial.Values.Add("Tipo de Cambio Aplicado")

                Dim porTituloTurno As New ReportParameter()
                Dim par4 As New ReportParameter()

                porTituloTurno.Name = "porTituloTurno"
                porTituloTurno.Values.Add("Fecha de Operación:")

                par4.Name = "par4"

                'If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                '    par4.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "ddm/MM/yyyy"))
                'Else
                par4.Values.Add(Format(dt_fin_poste, "MM/dd/yyyy"))
                'End If

                Dim parTituloHoraFinal As New ReportParameter()
                Dim par9 As New ReportParameter()

                parTituloHoraFinal.Name = "parTituloHoraFinal"
                parTituloHoraFinal.Values.Add("Fecha de emisión:")

                par9.Name = "par9"
                par9.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR DIA")

                Dim parRec As New ReportParameter()
                parRec.Name = "parRec"
                parRec.Values.Add(Reclasificados)

                Dim parameters() As ReportParameter = {parNoNombreCaseta, par2, parTituloCajeroReceptor, par7, parTituloHoraInicial, porTituloTurno, par4, parTituloHoraFinal, par9, parTituloReporte, parTituloReporte, parRec}
                ReportViewer2.LocalReport.SetParameters(parameters)


            End If

            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Grupo")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Concepto")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Descricion_clase")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Numero_clase")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 1, "Numero")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "strNumero")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            odataSetReporte.Tables.Add(oDataTableReporte)
            '--------------------------------------------------------
            '--------------------------------------------------------
            'ARMO MI TIPO TARIFA
            strQuerys = "SELECT MAX(Version_Tarif) as version " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                int_version_tarifa = oDataRow("version")

            End If


            'If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

            '    If Not IsDBNull(oDataRow("version")) Then
            '        If oDataRow("version") < 700 Then
            '            int_version_tarifa = oDataRow("version")
            '        Else
            '            int_version_tarifa = 5
            '        End If

            '    Else
            '        int_version_tarifa = 5
            '        'MsgBox("No existen datos", MsgBoxStyle.Information, "Verificar")
            '        'Me.Close()
            '        'Exit Sub
            '    End If



            'End If
            ''+palo blanco
            ''int_version_tarifa = 112

            ''+paso morelos
            ''If int_reporte = 1 Then

            ''    Select Case str_id_voie

            ''        Case "A01"
            ''            int_version_tarifa = 3
            ''        Case "A02"
            ''            int_version_tarifa = 16
            ''        Case "A03"
            ''            int_version_tarifa = 16
            ''        Case "A04"
            ''            int_version_tarifa = 16
            ''        Case "A05"
            ''            int_version_tarifa = 16
            ''        Case "A06"
            ''            int_version_tarifa = 16
            ''        Case "B03"
            ''            int_version_tarifa = 17
            ''        Case "B04"
            ''            int_version_tarifa = 17
            ''        Case "B05"
            ''            int_version_tarifa = 17
            ''        Case "B06"
            ''            int_version_tarifa = 17
            ''        Case "B07"
            ''            int_version_tarifa = 17
            ''        Case "B08"
            ''            int_version_tarifa = 3

            ''    End Select

            ''Else
            ''    int_version_tarifa = 16
            ''End If


            ''+tlalpan
            'int_version_tarifa = 5

            ''TRES MARIAS
            ''int_version_tarifa = 4


            'armo mis encabezados con las clases
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
            "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
            "FROM TYPE_CLASSE WHERE ID_CLASSE >= 1 AND ID_CLASSE <= 18"

            If objQuerys.QueryDataSetSiete(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'clases sin excedentes
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE ((ID_CLASSE >= 1 AND ID_CLASSE <= 9) or (ID_CLASSE >= 12 AND ID_CLASSE <= 15)) "

            If objQuerys.QueryDataSetCuatro(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'clases con excedentes
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE ((ID_CLASSE >= 10 AND ID_CLASSE <= 11) or (ID_CLASSE >= 16 AND ID_CLASSE <= 18)) "
            '"FROM TYPE_CLASSE WHERE ((ID_CLASSE >= 10 AND ID_CLASSE <= 11) or (ID_CLASSE >= 16 AND ID_CLASSE <= 18)) "
            '"FROM TYPE_CLASSE WHERE ((ID_CLASSE >= 10 AND ID_CLASSE <= 11) or (ID_CLASSE >= 17 AND ID_CLASSE <= 17)) "

            If objQuerys.QueryDataSetSeis(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'clases con excedentes asignados
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE ID_CLASSE >= 16 AND ID_CLASSE <= 17 "

            If objQuerys.QueryDataSetOcho(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'solo excedentes directos aclase
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE (ID_CLASSE >= 10 AND ID_CLASSE <= 11) or (ID_CLASSE = 18)"

            If objQuerys.QueryDataSetNueve(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'Totales Tabla 1
            'Tarifa referenciada normal C12A
            'INICIO TARIFAS
            strQuerys = "SELECT " &
                "TYPE_PAIEMENT.libelle_paiement_L2 " &
                ",Prix_Cl01 ,Prix_Cl02 ,Prix_Cl03 ,Prix_Cl04 ,Prix_Cl05 ,Prix_Cl06 ,Prix_Cl07 ,Prix_Cl08 ,Prix_Cl09 " &
                ",Prix_Cl10 ,Prix_Cl11 ,Prix_Cl12 ,Prix_Cl13 ,Prix_Cl14 ,Prix_Cl15 ,Prix_Cl16 ,Prix_Cl17 ,Prix_Cl18 " &
                ",Prix_Cl19, Prix_Cl20 " &
                ",TYPE_PAIEMENT.libelle_paiement " &
                ",TABLE_TARIF.CODE " &
                "FROM TABLE_TARIF, " &
                "TYPE_PAIEMENT " &
                "WHERE   TABLE_TARIF.CODE =	TYPE_PAIEMENT.Id_Paiement(+) "

            If int_reporte = 1 Then
                strQuerys = strQuerys & "AND TABLE_TARIF.Id_Gare = '" & int_id_gare & "' "
            End If

            strQuerys = strQuerys & "AND TABLE_TARIF.Version_Tarif = " & int_version_tarifa & " " &
           "ORDER BY TABLE_TARIF.CODE "

            If objQuerys.QueryDataSetTarifa(strQuerys, "TABLE_TARIF") = 1 Then
            End If

            dvTarifa = oDataSetTarifa.Tables("TABLE_TARIF").DefaultView
            dvTarifa.RowFilter = "CODE = 1 "

            For cont = 0 To oDataSetSiete.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSiete = oDataSetSiete.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " TARIFA REF. Normal"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowSiete("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                'oDatarowReporte("strNumero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                'oDatarowReporte("Numero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                oDatarowReporte("Numero") = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSiete("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSiete("ID_CLASSE")), oDataRowSiete("ID_CLASSE"))), "###,###,##0.00")

                oDataTableReporte.Rows.Add(oDatarowReporte)
            Next

            '-------------------------------------------------------------------------
            dvTarifa = oDataSetTarifa.Tables("TABLE_TARIF").DefaultView
            dvTarifa.RowFilter = "CODE = 2 "

            For cont = 0 To oDataSetSiete.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSiete = oDataSetSiete.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " TARIFA REF. Reducida"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowSiete("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                'oDatarowReporte("strNumero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                'oDatarowReporte("Numero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                oDatarowReporte("Numero") = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSiete("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSiete("ID_CLASSE")), oDataRowSiete("ID_CLASSE"))), "###,###,##0.00")

                oDataTableReporte.Rows.Add(oDatarowReporte)
            Next

            '-------------------------------------------------------------------------
            dvTarifa = oDataSetTarifa.Tables("TABLE_TARIF").DefaultView
            dvTarifa.RowFilter = "CODE = 72 "

            For cont = 0 To oDataSetSiete.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSiete = oDataSetSiete.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "TARIFA REF. Pago Inmediato "

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowSiete("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                'oDatarowReporte("strNumero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                'oDatarowReporte("Numero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                oDatarowReporte("Numero") = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSiete("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSiete("ID_CLASSE")), oDataRowSiete("ID_CLASSE"))), "###,###,##0.00")

                oDataTableReporte.Rows.Add(oDatarowReporte)
            Next
            ' ''''''''''''''''''FIN TARIFAS





            'normal aforo C13 C15
            'strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_PARTIEL) AS Total, count(*) as cruces " & _
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
    "FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
    "WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
    "AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " &
    "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_14 = db_tot_14 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_15 = db_tot_15 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_14 = db_tot_14 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next
            'FIN EXCEDENTES


            'reducida aforo C17 C19 new
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
    "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_18 = db_tot_18 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_20 = db_tot_20 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_18 = db_tot_18 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_20 = db_tot_20 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_20 = db_tot_20 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_20 = db_tot_20 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_20 = db_tot_20 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_20 = db_tot_20 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'reducida aforo C17 C19 new fin



            '------------------------------------------------
            '------------------------------------------------
            '        'reducida aforo C17 C19
            '        'ingreso

            '        strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '        If int_reporte = 1 Then

            '            strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '            "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '            "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '            "AND ID_VOIE = '" & int_id_voie & "' " & _
            '            "AND VOIE = '" & str_id_voie & "' "

            '        ElseIf int_reporte = 2 Then
            '            strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '        ElseIf int_reporte = 3 Then
            '            strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '        End If


            '        strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '        If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '        End If

            '        dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '        For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '            oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '            strGrupo = "c"
            '            strConcepto = " REDUCIDA Aforo"

            '            oDatarowReporte = oDataTableReporte.NewRow

            '            oDatarowReporte("Grupo") = strGrupo
            '            oDatarowReporte("Concepto") = strConcepto
            '            oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '            oDatarowReporte("Numero_clase") = strLinea

            '            dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '            If dvEvento.Count >= 1 Then
            '                'oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
            '                oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                db_tot_18 = db_tot_18 + dvEvento(0).Item("cruces")

            '            Else
            '                'oDatarowReporte("Numero") = 0
            '                oDatarowReporte("strNumero") = Format(0, "###,###,##0")
            '            End If
            '            oDataTableReporte.Rows.Add(oDatarowReporte)



            '            strGrupo = "c"
            '            strConcepto = "Ingreso"

            '            oDatarowReporte = oDataTableReporte.NewRow

            '            oDatarowReporte("Grupo") = strGrupo
            '            oDatarowReporte("Concepto") = strConcepto
            '            oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '            oDatarowReporte("Numero_clase") = strLinea

            '            dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '            If dvEvento.Count >= 1 Then
            '                'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '                oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '                db_tot_20 = db_tot_20 + dvEvento(0).Item("Total")

            '            Else
            '                'oDatarowReporte("Numero") = 0
            '                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '            End If
            '            oDataTableReporte.Rows.Add(oDatarowReporte)

            '        Next

            'res pago inmediato aforo C21  C23 new 

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
    "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_22 = db_tot_22 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_24 = db_tot_24 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_22 = db_tot_22 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_24 = db_tot_24 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_24 = db_tot_24 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)

                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_24 = db_tot_24 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_24 = db_tot_24 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_24 = db_tot_24 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'res pago inmediato aforo C21  C23 new fin



            '        'res pago inmediato aforo C21  C23
            '        'ingresos
            '        strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '        If int_reporte = 1 Then

            '            strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '            "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '            "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '            "AND ID_VOIE = '" & int_id_voie & "' " & _
            '            "AND VOIE = '" & str_id_voie & "' "

            '        ElseIf int_reporte = 2 Then
            '            strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '        ElseIf int_reporte = 3 Then
            '            strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '        End If

            '        strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '        If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '        End If

            '        dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '        For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '            oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '            strGrupo = "d"
            '            strConcepto = " Res. Pago Inmediato Aforo"

            '            oDatarowReporte = oDataTableReporte.NewRow

            '            oDatarowReporte("Grupo") = strGrupo
            '            oDatarowReporte("Concepto") = strConcepto
            '            oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '            oDatarowReporte("Numero_clase") = strLinea

            '            dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '            If dvEvento.Count >= 1 Then
            '                oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                db_tot_22 = db_tot_22 + dvEvento(0).Item("cruces")

            '            Else
            '                oDatarowReporte("strNumero") = 0
            '            End If
            '            oDataTableReporte.Rows.Add(oDatarowReporte)



            '            strGrupo = "d"
            '            strConcepto = "Ingreso"

            '            oDatarowReporte = oDataTableReporte.NewRow

            '            oDatarowReporte("Grupo") = strGrupo
            '            oDatarowReporte("Concepto") = strConcepto
            '            oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '            oDatarowReporte("Numero_clase") = strLinea

            '            dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '            If dvEvento.Count >= 1 Then
            '                oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '                db_tot_24 = db_tot_24 + dvEvento(0).Item("Total")

            '            Else
            '                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '            End If
            '            oDataTableReporte.Rows.Add(oDatarowReporte)

            '        Next


            'aforo total new
            '''''''''''''''''''''''''''''''
            'normal
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '" Normal Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_26 = db_tot_26 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_26 = db_tot_26 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


            Next

            'aforo total new fin


            ''ingreso sin iva new
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        oDatarowReporte("Numero") = dvEvento(0).Item("Total") / 1.16
            '        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total") / 1.16, "###,###,##0.00")
            '        db_tot_28 = db_tot_28 + dvEvento(0).Item("Total") / 1.16
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 1 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

            '        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16, "###,###,##0.00")
            '        db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 1 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

            '        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16, "###,###,##0.00")
            '        db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16)
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 1 "

            '        If oDataRowNueve("ID_CLASSE") = 10 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16
            '            oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16, "###,###,##0.00")
            '            db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)

            '        ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16
            '            oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16, "###,###,##0.00")
            '            db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16)


            '        ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") / 1.16)
            '            oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") / 1.16), "###,###,##0.00")
            '            db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)

            '        End If



            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''ingreso sin iva new fin


            ''IVA NEW
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        oDatarowReporte("Numero") = dvEvento(0).Item("Total") - (dvEvento(0).Item("Total") / 1.16)
            '        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total") - (dvEvento(0).Item("Total") / 1.16), "###,###,##0.00")
            '        db_tot_30 = db_tot_30 + (dvEvento(0).Item("Total") - (dvEvento(0).Item("Total") / 1.16))
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 1 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

            '        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16), "###,###,##0.00")
            '        db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16))
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 1 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

            '        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16)
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16), "###,###,##0.00")
            '        db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16))
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 1 "

            '        If oDataRowNueve("ID_CLASSE") = 10 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '            oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16), "###,###,##0.00")
            '            db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16))

            '        ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2) - ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16)
            '            oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2) - ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16), "###,###,##0.00")
            '            db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2) - ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16))


            '        ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '            oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16), "###,###,##0.00")
            '            db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16))

            '        End If



            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next
            ''IVA NEW FIN

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_32 = db_tot_32 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_26 = db_tot_26 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_26 = db_tot_26 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


            Next

            'aforo total new fin


            ''ingreso sin iva new
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        oDatarowReporte("Numero") = dvEvento(0).Item("Total") / 1.16
            '        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total") / 1.16, "###,###,##0.00")
            '        db_tot_28 = db_tot_28 + dvEvento(0).Item("Total") / 1.16
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 2 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

            '        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16, "###,###,##0.00")
            '        db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 2 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

            '        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16, "###,###,##0.00")
            '        db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16)
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 2 "

            '        If oDataRowNueve("ID_CLASSE") = 10 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16
            '            oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16, "###,###,##0.00")
            '            db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)

            '        ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16
            '            oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16, "###,###,##0.00")
            '            db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16)


            '        ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") / 1.16)
            '            oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") / 1.16), "###,###,##0.00")
            '            db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)

            '        End If



            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''ingreso sin iva new fin


            ''IVA NEW
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        oDatarowReporte("Numero") = dvEvento(0).Item("Total") - (dvEvento(0).Item("Total") / 1.16)
            '        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total") - (dvEvento(0).Item("Total") / 1.16), "###,###,##0.00")
            '        db_tot_30 = db_tot_30 + (dvEvento(0).Item("Total") - (dvEvento(0).Item("Total") / 1.16))
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 2 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

            '        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16), "###,###,##0.00")
            '        db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16))
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 2 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

            '        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16)
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16), "###,###,##0.00")
            '        db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16))
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 2 "

            '        If oDataRowNueve("ID_CLASSE") = 10 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '            oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16), "###,###,##0.00")
            '            db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16))

            '        ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2) - ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16)
            '            oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2) - ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16), "###,###,##0.00")
            '            db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2) - ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16))


            '        ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '            oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16), "###,###,##0.00")
            '            db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16))

            '        End If



            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next
            ''IVA NEW FIN

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_32 = db_tot_32 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_26 = db_tot_26 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_26 = db_tot_26 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte.Rows.Add(oDatarowReporte)


            Next

            'aforo total new fin


            ''ingreso sin iva new
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        oDatarowReporte("Numero") = dvEvento(0).Item("Total") / 1.16
            '        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total") / 1.16, "###,###,##0.00")
            '        db_tot_28 = db_tot_28 + dvEvento(0).Item("Total") / 1.16
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 72 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

            '        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16, "###,###,##0.00")
            '        db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 72 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

            '        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16, "###,###,##0.00")
            '        db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16)
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 72 "

            '        If oDataRowNueve("ID_CLASSE") = 10 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16
            '            oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16, "###,###,##0.00")
            '            db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)

            '        ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16
            '            oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16, "###,###,##0.00")
            '            db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16)


            '        ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") / 1.16)
            '            oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") / 1.16), "###,###,##0.00")
            '            db_tot_28 = db_tot_28 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)

            '        End If



            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''ingreso sin iva new fin


            ''IVA NEW
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        oDatarowReporte("Numero") = dvEvento(0).Item("Total") - (dvEvento(0).Item("Total") / 1.16)
            '        oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total") - (dvEvento(0).Item("Total") / 1.16), "###,###,##0.00")
            '        db_tot_30 = db_tot_30 + (dvEvento(0).Item("Total") - (dvEvento(0).Item("Total") / 1.16))
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 72 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

            '        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16), "###,###,##0.00")
            '        db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16))
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 72 "
            '        'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
            '        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

            '        oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16)
            '        'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16), "###,###,##0.00")
            '        db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")) / 1.16))
            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then

            '        dvTarifa.RowFilter = "CODE = 72 "

            '        If oDataRowNueve("ID_CLASSE") = 10 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '            oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16), "###,###,##0.00")
            '            db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16))

            '        ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2) - ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16)
            '            oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2) - ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16), "###,###,##0.00")
            '            db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2) - ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)) / 1.16))


            '        ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

            '            dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
            '            oDatarowReporte("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16)
            '            oDatarowReporte("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16), "###,###,##0.00")
            '            db_tot_30 = db_tot_30 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces") - ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")) / 1.16))

            '        End If



            '    Else
            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next
            ''IVA NEW FIN

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_32 = db_tot_32 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_32 = db_tot_32 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte("Numero") = 0
                    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next
            'Ingreso Total new fin



            Dim rds As New ReportDataSource
            rds.Name = "DataSet1"
            rds.Value = odataSetReporte.Tables("tabla_reporte")

            ReportViewer2.LocalReport.DataSources.Add(rds)



            'Totales Tabla 1
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "Cantidad")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "Total")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "Tipo_Total")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "strNumero")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            odataSetReporte_total.Tables.Add(oDataTableReporte_total)
            '--------------------------------------------------------


            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "001"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Nothing

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)

            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "002"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Nothing

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)



            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "003"
            oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Nothing

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '----------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "14"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_14, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "15"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            'oDatarowReporte_total("strNumero") = Format(db_tot_15 / 1.16, "###,###,##0.00")
            oDatarowReporte_total("strNumero") = Format(db_tot_15, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "15"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_15 - (db_tot_15 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "18"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_18, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "20"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            'oDatarowReporte_total("strNumero") = Format(db_tot_20 / 1.16, "###,###,##0.00")
            oDatarowReporte_total("strNumero") = Format(db_tot_20, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "20"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_20 - (db_tot_20 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '22
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "22"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_22, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "24"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            'oDatarowReporte_total("strNumero") = Format(db_tot_24 / 1.16, "###,###,##0.00")
            oDatarowReporte_total("strNumero") = Format(db_tot_24, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "24"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_24 - (db_tot_24 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "26"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_26, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '------------------------------------------------------------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "28"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = " Ingreso"
            'oDatarowReporte_total("strNumero") = Format(db_tot_28, "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "30"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_30, "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            'Total
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "32"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total("strNumero") = "Total:"

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)

            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "32"
            oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Format(db_tot_32, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)

            '--------------------------------------------------------------------



            Dim rds_Total As New ReportDataSource
            rds_Total.Name = "DataSet2"
            rds_Total.Value = odataSetReporte_total.Tables("tabla_reporte_total")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total)




            'Tabla Dos
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Grupo")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Concepto")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Descricion_clase")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Numero_clase")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 1, "Numero")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "strNumero")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            odataSetReporte_2.Tables.Add(oDataTableReporte_2)
            '--------------------------------------------------------
            'pago en efectivo dollares new
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 1000 " &
    "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("Total")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 'dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_2("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("excedentes")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_2("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_2("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next




            'pago en efectivo dollares new fin

            'Pago en efectivo dlls por cajero-receptor C33 C34 (pend)
            '        strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '        If int_reporte = 1 Then

            '            strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '            "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '            "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '            "AND ID_VOIE = '" & int_id_voie & "' " & _
            '            "AND VOIE = '" & str_id_voie & "' "

            '        ElseIf int_reporte = 2 Then
            '            strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '        ElseIf int_reporte = 3 Then
            '            strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '        End If


            '        strQuerys = strQuerys & "AND ID_PAIEMENT = 1000 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '        If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '        End If

            '        dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '        For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '            oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '            strGrupo = "a"
            '            strConcepto = " Tarifa Ref."

            '            oDatarowReporte_2 = oDataTableReporte_2.NewRow

            '            oDatarowReporte_2("Grupo") = strGrupo
            '            oDatarowReporte_2("Concepto") = strConcepto
            '            oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '            oDatarowReporte_2("Numero_clase") = strLinea

            '            dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '            If dvEvento.Count >= 1 Then
            '                'oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
            '                oDatarowReporte_2("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '                db_tot_35 = db_tot_35 + dvEvento(0).Item("Total")

            '            Else
            '                'oDatarowReporte("Numero") = 0
            '                oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
            '            End If
            '            oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


            '            strGrupo = "b"
            '            strConcepto = "Aforo"

            '            oDatarowReporte_2 = oDataTableReporte_2.NewRow

            '            oDatarowReporte_2("Grupo") = strGrupo
            '            oDatarowReporte_2("Concepto") = strConcepto
            '            oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '            oDatarowReporte_2("Numero_clase") = strLinea

            '            dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '            If dvEvento.Count >= 1 Then
            '                'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '                oDatarowReporte_2("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                db_tot_36 = db_tot_36 + dvEvento(0).Item("cruces")
            '            Else
            '                'oDatarowReporte("Numero") = 0
            '                oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
            '            End If

            '            oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            '        Next

            Dim rds_2 As New ReportDataSource
            rds_2.Name = "DataSet3"
            rds_2.Value = odataSetReporte_2.Tables("tabla_reporte_2")

            ReportViewer2.LocalReport.DataSources.Add(rds_2)


            'Totales Tabla 2
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "Cantidad")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "Total")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "Tipo_Total")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "strNumero")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            odataSetReporte_total_2.Tables.Add(oDataTableReporte_total_2)
            '--------------------------------------------------------


            oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            oDatarowReporte_total_2("Cantidad") = "36"
            oDatarowReporte_total_2("Total") = "             Total           "
            oDatarowReporte_total_2("Tipo_Total") = " Aforo"
            oDatarowReporte_total_2("strNumero") = Format(db_tot_36, "###,###,##0")

            oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            'oDatarowReporte_total_2("Cantidad") = "36"
            'oDatarowReporte_total_2("Total") = "             Total           "
            'oDatarowReporte_total_2("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_2("strNumero") = Format(db_tot_35 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            ''-------------------------------------------------------
            'oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            'oDatarowReporte_total_2("Cantidad") = "36"
            'oDatarowReporte_total_2("Total") = "             Total           "
            'oDatarowReporte_total_2("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_2("strNumero") = Format(db_tot_35 - (db_tot_35 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            ''-------------------------------------------------------
            'oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            'oDatarowReporte_total_2("Cantidad") = "38"
            'oDatarowReporte_total_2("Total") = "             Total           "
            'oDatarowReporte_total_2("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_2("strNumero") = "Total:"

            'oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '---------------------------------------------------
            oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            oDatarowReporte_total_2("Cantidad") = "38"
            oDatarowReporte_total_2("Total") = "             Total           "
            'oDatarowReporte_total_2("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_2("Tipo_Total") = " Ingreso "
            oDatarowReporte_total_2("strNumero") = Format(db_tot_35, "###,###,##0.00")

            oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '-------------------------------------------------------


            Dim rds_Total_2 As New ReportDataSource
            rds_Total_2.Name = "DataSet4"
            rds_Total_2.Value = odataSetReporte_total_2.Tables("tabla_reporte_total_2")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_2)



            'Tabla 3
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Grupo")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Concepto")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Descricion_clase")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Numero_clase")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 1, "Numero")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "strNumero")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            odataSetReporte_3.Tables.Add(oDataTableReporte_3)
            '--------------------------------------------------------
            'PAGO ANTICIPADO RESIDENTES NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 1000 " &
    "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("Total")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 'dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_3("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("excedentes")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_3("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_3("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next

            'PAGO ANTICIPADO RESIDENTES NEW FIN



            '        'Pago en efectivo dlls por cajero-receptor C33 C34 (pend)
            '        strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '        If int_reporte = 1 Then

            '            strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '            "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '            "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '            "AND ID_VOIE = '" & int_id_voie & "' " & _
            '            "AND VOIE = '" & str_id_voie & "' "

            '        ElseIf int_reporte = 2 Then
            '            strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '        ElseIf int_reporte = 3 Then
            '            strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '        End If


            '        strQuerys = strQuerys & "AND ID_PAIEMENT = 1000 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '        If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '        End If

            '        dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '        For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '            oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '            strGrupo = "a"
            '            strConcepto = " Tarifa Ref."

            '            oDatarowReporte_3 = oDataTableReporte_3.NewRow

            '            oDatarowReporte_3("Grupo") = strGrupo
            '            oDatarowReporte_3("Concepto") = strConcepto
            '            oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '            oDatarowReporte_3("Numero_clase") = strLinea

            '            dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '            If dvEvento.Count >= 1 Then
            '                'oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
            '                oDatarowReporte_3("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '                db_tot_35 = db_tot_35 + dvEvento(0).Item("Total")

            '            Else
            '                'oDatarowReporte("Numero") = 0
            '                oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
            '            End If
            '            oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


            '            strGrupo = "b"
            '            strConcepto = "Aforo"

            '            oDatarowReporte_3 = oDataTableReporte_3.NewRow

            '            oDatarowReporte_3("Grupo") = strGrupo
            '            oDatarowReporte_3("Concepto") = strConcepto
            '            oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '            oDatarowReporte_3("Numero_clase") = strLinea

            '            dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '            If dvEvento.Count >= 1 Then
            '                'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '                oDatarowReporte_3("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                db_tot_36 = db_tot_36 + dvEvento(0).Item("cruces")
            '            Else
            '                'oDatarowReporte("Numero") = 0
            '                oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
            '            End If

            '            oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            '        Next

            Dim rds_3 As New ReportDataSource
            rds_3.Name = "DataSet5"
            rds_3.Value = odataSetReporte_3.Tables("tabla_reporte_3")

            ReportViewer2.LocalReport.DataSources.Add(rds_3)


            'Totales Tabla 3
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "Cantidad")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "Total")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "Tipo_Total")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "strNumero")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            odataSetReporte_total_3.Tables.Add(oDataTableReporte_total_3)
            '--------------------------------------------------------
            '***insertar
            oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            oDatarowReporte_total_3("Cantidad") = "001"
            oDatarowReporte_total_3("Total") = "             Total           "
            oDatarowReporte_total_3("Tipo_Total") = " Aforo"
            oDatarowReporte_total_3("strNumero") = Nothing

            oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '-----------------------------------------------------------------------------


            oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            oDatarowReporte_total_3("Cantidad") = "36"
            oDatarowReporte_total_3("Total") = "             Total           "
            oDatarowReporte_total_3("Tipo_Total") = " Aforo"
            oDatarowReporte_total_3("strNumero") = Format(db_tot_36, "###,###,##0")

            oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            'oDatarowReporte_total_3("Cantidad") = "36"
            'oDatarowReporte_total_3("Total") = "             Total           "
            'oDatarowReporte_total_3("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_3("strNumero") = Format(db_tot_35 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            ''-------------------------------------------------------
            'oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            'oDatarowReporte_total_3("Cantidad") = "36"
            'oDatarowReporte_total_3("Total") = "             Total           "
            'oDatarowReporte_total_3("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_3("strNumero") = Format(db_tot_35 - (db_tot_35 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            ''-------------------------------------------------------
            'oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            'oDatarowReporte_total_3("Cantidad") = "38"
            'oDatarowReporte_total_3("Total") = "             Total           "
            'oDatarowReporte_total_3("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_3("strNumero") = "Total:"

            'oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '---------------------------------------------------
            oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            oDatarowReporte_total_3("Cantidad") = "38"
            oDatarowReporte_total_3("Total") = "             Total           "
            'oDatarowReporte_total_3("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_3("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_3("strNumero") = Format(db_tot_35, "###,###,##0.00")

            oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '-------------------------------------------------------


            Dim rds_Total_3 As New ReportDataSource
            rds_Total_3.Name = "DataSet6"
            rds_Total_3.Value = odataSetReporte_total_3.Tables("tabla_reporte_total_3")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_3)
            'fin tabla 3


            'tabla 4
            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Grupo")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Concepto")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Descricion_clase")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Numero_clase")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 1, "Numero")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "strNumero")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            odataSetReporte_4.Tables.Add(oDataTableReporte_4)

            'c45
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' and SHIFT_NUMBER = " & id_turno & " "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) and SHIFT_NUMBER = " & id_turno & " "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                    db_tot_47 = db_tot_47 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            Next

            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    'db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                    db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_4("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_46 = db_tot_46 + dvEvento(0).Item("excedentes")
                    db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")


                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES

            'excedentes fin

            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            'c45b (pend)
            '            '---------------------------------------------------------------------------------
            '            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '            If int_reporte = 1 Then

            '            strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '            "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '            "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '            "AND ID_VOIE = '" & int_id_voie & "' " & _
            '            "AND VOIE = '" & str_id_voie & "' "

            '            ElseIf int_reporte = 2 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            ElseIf int_reporte = 3 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            End If


            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 75 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '            End If

            '            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = " TAG"

            '                oDatarowReporte_4 = oDataTableReporte_4.NewRow

            '                oDatarowReporte_4("Grupo") = strGrupo
            '                oDatarowReporte_4("Concepto") = strConcepto
            '                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '                oDatarowReporte_4("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then
            '                    oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
            '                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    db_tot_461 = db_tot_461 + dvEvento(0).Item("cruces")
            '                    db_tot_471 = db_tot_471 + dvEvento(0).Item("cruces")
            '                Else
            '                    oDatarowReporte_4("Numero") = 0
            '                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '                End If

            '                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            Next

            '            'excedentes
            '            'excedentes fin

            '            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            '            oDatarowReporte_4("Grupo") = strGrupo
            '            oDatarowReporte_4("Concepto") = strConcepto
            '            oDatarowReporte_4("Descricion_clase") = encabezados_clases(10)
            '            oDatarowReporte_4("Numero_clase") = strLinea
            '            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            '            oDatarowReporte_4("Grupo") = strGrupo
            '            oDatarowReporte_4("Concepto") = strConcepto
            '            oDatarowReporte_4("Descricion_clase") = encabezados_clases(16)
            '            oDatarowReporte_4("Numero_clase") = strLinea
            '            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            'c45c (pend)
            '            '---------------------------------------------------------------------------------
            '            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '            If int_reporte = 1 Then

            '            strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '            "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '            "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '            "AND ID_VOIE = '" & int_id_voie & "' " & _
            '            "AND VOIE = '" & str_id_voie & "' "

            '            ElseIf int_reporte = 2 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            ElseIf int_reporte = 3 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            End If


            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 75 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '            End If

            '            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = " Tarjeta Proximidad"

            '                oDatarowReporte_4 = oDataTableReporte_4.NewRow

            '                oDatarowReporte_4("Grupo") = strGrupo
            '                oDatarowReporte_4("Concepto") = strConcepto
            '                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '                oDatarowReporte_4("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then
            '                    oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
            '                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    db_tot_462 = db_tot_462 + dvEvento(0).Item("cruces")
            '                    db_tot_472 = db_tot_472 + dvEvento(0).Item("cruces")
            '                Else
            '                    oDatarowReporte_4("Numero") = 0
            '                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '                End If

            '                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            Next

            '            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            '            oDatarowReporte_4("Grupo") = strGrupo
            '            oDatarowReporte_4("Concepto") = strConcepto
            '            oDatarowReporte_4("Descricion_clase") = encabezados_clases(10)
            '            oDatarowReporte_4("Numero_clase") = strLinea
            '            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            '            oDatarowReporte_4("Grupo") = strGrupo
            '            oDatarowReporte_4("Concepto") = strConcepto
            '            oDatarowReporte_4("Descricion_clase") = encabezados_clases(16)
            '            oDatarowReporte_4("Numero_clase") = strLinea
            '            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)







            '            'c45d (pend)
            '            '---------------------------------------------------------------------------------
            '            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '            If int_reporte = 1 Then

            '            strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '            "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '            "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '            "AND ID_VOIE = '" & int_id_voie & "' " & _
            '            "AND VOIE = '" & str_id_voie & "' "

            '            ElseIf int_reporte = 2 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            ElseIf int_reporte = 3 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            End If


            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 75 " & _
            '"AND(ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '            End If

            '            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = " Tarjeta Desechable Prepago"

            '                oDatarowReporte_4 = oDataTableReporte_4.NewRow

            '                oDatarowReporte_4("Grupo") = strGrupo
            '                oDatarowReporte_4("Concepto") = strConcepto
            '                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '                oDatarowReporte_4("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then
            '                    oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
            '                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    db_tot_463 = db_tot_463 + dvEvento(0).Item("cruces")
            '                    db_tot_473 = db_tot_473 + dvEvento(0).Item("cruces")
            '                Else
            '                    oDatarowReporte_4("Numero") = 0
            '                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '                End If

            '                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            Next

            '            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            '            oDatarowReporte_4("Grupo") = strGrupo
            '            oDatarowReporte_4("Concepto") = strConcepto
            '            oDatarowReporte_4("Descricion_clase") = encabezados_clases(10)
            '            oDatarowReporte_4("Numero_clase") = strLinea
            '            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            '            oDatarowReporte_4("Grupo") = strGrupo
            '            oDatarowReporte_4("Concepto") = strConcepto
            '            oDatarowReporte_4("Descricion_clase") = encabezados_clases(16)
            '            oDatarowReporte_4("Numero_clase") = strLinea
            '            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)


            '            'inicio tarjeta de credito
            '            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '            If int_reporte = 1 Then

            '            strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '            "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '            "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '            "AND ID_VOIE = '" & int_id_voie & "' " & _
            '            "AND VOIE = '" & str_id_voie & "' "

            '            ElseIf int_reporte = 2 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            ElseIf int_reporte = 3 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            End If


            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 12 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '            End If

            '            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Tarjeta de Credito"

            '                oDatarowReporte_4 = oDataTableReporte_4.NewRow

            '                oDatarowReporte_4("Grupo") = strGrupo
            '                oDatarowReporte_4("Concepto") = strConcepto
            '                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '                oDatarowReporte_4("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then
            '                    oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
            '                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    db_tot_462 = db_tot_462 + dvEvento(0).Item("cruces")
            '                    db_tot_472 = db_tot_472 + dvEvento(0).Item("cruces")
            '                Else
            '                    oDatarowReporte_4("Numero") = 0
            '                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '                End If

            '                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            Next

            '            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            '            oDatarowReporte_4("Grupo") = strGrupo
            '            oDatarowReporte_4("Concepto") = strConcepto
            '            oDatarowReporte_4("Descricion_clase") = encabezados_clases(10)
            '            oDatarowReporte_4("Numero_clase") = strLinea
            '            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            '            oDatarowReporte_4("Grupo") = strGrupo
            '            oDatarowReporte_4("Concepto") = strConcepto
            '            oDatarowReporte_4("Descricion_clase") = encabezados_clases(16)
            '            oDatarowReporte_4("Numero_clase") = strLinea
            '            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
            '            'fin tarjeta de credito

            '            'inicio tarjeta de debito
            '            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '            If int_reporte = 1 Then

            '                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '                "AND ID_VOIE = '" & int_id_voie & "' " & _
            '                "AND VOIE = '" & str_id_voie & "' "

            '            ElseIf int_reporte = 2 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            ElseIf int_reporte = 3 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            End If


            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 14 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '            End If

            '            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Tarjeta de Debito"

            '                oDatarowReporte_4 = oDataTableReporte_4.NewRow

            '                oDatarowReporte_4("Grupo") = strGrupo
            '                oDatarowReporte_4("Concepto") = strConcepto
            '                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '                oDatarowReporte_4("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then
            '                    oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
            '                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    db_tot_462 = db_tot_462 + dvEvento(0).Item("cruces")
            '                    db_tot_472 = db_tot_472 + dvEvento(0).Item("cruces")
            '                Else
            '                    oDatarowReporte_4("Numero") = 0
            '                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '                End If

            '                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            Next

            '            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            '            oDatarowReporte_4("Grupo") = strGrupo
            '            oDatarowReporte_4("Concepto") = strConcepto
            '            oDatarowReporte_4("Descricion_clase") = encabezados_clases(10)
            '            oDatarowReporte_4("Numero_clase") = strLinea
            '            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            '            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            '            oDatarowReporte_4("Grupo") = strGrupo
            '            oDatarowReporte_4("Concepto") = strConcepto
            '            oDatarowReporte_4("Descricion_clase") = encabezados_clases(16)
            '            oDatarowReporte_4("Numero_clase") = strLinea
            '            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            '            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
            '            'fin tarjeta de debito



            'c48 (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "'  and SHIFT_NUMBER = " & id_turno & " "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) and SHIFT_NUMBER = " & id_turno & " "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS'))  "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            ' or ID_PAIEMENT = 12 or ID_PAIEMENT = 14
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 15) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_4("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                    db_tot_50 = db_tot_50 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            Next

            'éxcedentes iave
            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                    'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                    db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                    db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    'oDatarowReporte_4("Numero") = dvEvento(0).Item("excedentes")
                    'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")

                    'db_tot_49 = db_tot_49 + dvEvento(0).Item("excedentes")
                    db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11
                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces") * 2
                        'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")

                        ' db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        'db_tot_49 = db_tot_49 + (dvEvento(0).Item("cruces") * 2)
                        db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES



            'fin excedentes iave


            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)


            Dim rds_4 As New ReportDataSource
            rds_4.Name = "DataSet7"
            rds_4.Value = odataSetReporte_4.Tables("tabla_reporte_4")

            ReportViewer2.LocalReport.DataSources.Add(rds_4)


            'Fin Tabla 4----------------------------
            'inicio tabla 4 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "Cantidad")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "Total")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "Tipo_Total")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "strNumero")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            odataSetReporte_total_4.Tables.Add(oDataTableReporte_total_4)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            oDatarowReporte_total_4("Cantidad") = "46"
            oDatarowReporte_total_4("Total") = "             Total           "
            oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            oDatarowReporte_total_4("strNumero") = Format(db_tot_46, "###,###,##0")

            oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '--------------------------------------------------------

            '---------------------------------------------------
            oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            oDatarowReporte_total_4("Cantidad") = "52"
            oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_4("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_4("strNumero") = Format(db_tot_50, "###,###,##0.00")

            oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '-------------------------------------------------------

            Dim rds_Total_4 As New ReportDataSource
            rds_Total_4.Name = "DataSet8"
            rds_Total_4.Value = odataSetReporte_total_4.Tables("tabla_reporte_total_4")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_4)
            'fin tabla 4 totoales



            'tarjetas bancarias inicia


            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Grupo")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Concepto")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Descricion_clase")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Numero_clase")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 1, "Numero")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "strNumero")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            odataSetReporte_10.Tables.Add(oDataTableReporte_10)

            'c45
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " ' & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 12 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_146 = db_tot_146 + dvEvento(0).Item("cruces")
                    db_tot_147 = db_tot_147 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    'db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_146 = db_tot_146 + dvEvento(0).Item("cruces")
                    db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_46 = db_tot_46 + dvEvento(0).Item("excedentes")
                    db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")


                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES

            'excedentes fin

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            'inicio tarjeta de debito

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " ' & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 14 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_1461 = db_tot_1461 + dvEvento(0).Item("cruces")
                    db_tot_1471 = db_tot_1471 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    'db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_1461 = db_tot_1461 + dvEvento(0).Item("cruces")
                    db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_46 = db_tot_46 + dvEvento(0).Item("excedentes")
                    db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")


                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES

            'excedentes fin

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            'fin tarjeta de debito



            'c48 (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            ' or ID_PAIEMENT = 12 or ID_PAIEMENT = 14
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 12 or ID_PAIEMENT = 14) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    db_tot_150 = db_tot_150 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'éxcedentes iave
            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_49 = db_tot_49 + dvEvento(0).Item("excedentes")
                    db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        ' db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        'db_tot_49 = db_tot_49 + (dvEvento(0).Item("cruces") * 2)
                        db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES



            'fin excedentes iave


            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            '***ingreso tarjetas bancarias
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    'db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    'db_tot_150 = db_tot_150 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'éxcedentes iave
            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    'db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    'oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    'db_tot_49 = db_tot_49 + dvEvento(0).Item("excedentes")
                    'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11
                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")

                        ' db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        'db_tot_49 = db_tot_49 + (dvEvento(0).Item("cruces") * 2)
                        'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES



            'fin excedentes iave


            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            '***ingreso tarjetas bancarias fin



            Dim rds_10 As New ReportDataSource
            rds_10.Name = "DataSet19"
            rds_10.Value = odataSetReporte_10.Tables("tabla_reporte_10")

            ReportViewer2.LocalReport.DataSources.Add(rds_10)


            'Fin Tabla 4----------------------------
            'inicio tabla 4 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "Cantidad")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "Total")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "Tipo_Total")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "strNumero")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            odataSetReporte_total_10.Tables.Add(oDataTableReporte_total_10)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "146"
            oDatarowReporte_total_10("Total") = "             Total           "
            oDatarowReporte_total_10("Tipo_Total") = " Aforo"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_146, "###,###,##0")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '--------------------------------------------------------
            'oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            'oDatarowReporte_total_10("Cantidad") = "146"
            'oDatarowReporte_total_10("Total") = "             Total           "
            'oDatarowReporte_total_10("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_10("strNumero") = Format(db_tot_147 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '----------------------------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "1461"
            oDatarowReporte_total_10("Total") = "             Total           "
            oDatarowReporte_total_10("Tipo_Total") = " Aforo"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_1461, "###,###,##0")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '--------------------------------------------------------
            'oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow



            ' ''tarjeta bancaria
            ' ''fin tarjeta bancaria
            ''--------------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "149"
            oDatarowReporte_total_10("Total") = "             Total           "
            oDatarowReporte_total_10("Tipo_Total") = " Aforo"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_149, "###,###,##0")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '--------------------------------------------------------

            '---------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "152"
            oDatarowReporte_total_10("Total") = "             Total           "
            'oDatarowReporte_total_10("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_10("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_150, "###,###,##0.00")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '-------------------------------------------------------

            Dim rds_Total_10 As New ReportDataSource
            rds_Total_10.Name = "DataSet20"
            rds_Total_10.Value = odataSetReporte_total_10.Tables("tabla_reporte_total_10")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_10)


            'tarjetas bancarias fin




            'inicio_tabla_5


            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Grupo")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Concepto")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Descricion_clase")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Numero_clase")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 1, "Numero")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "strNumero")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            odataSetReporte_5.Tables.Add(oDataTableReporte_5)

            '*** eludido
            '            'c53
            '            '---------------------------------------------------------------------------------
            '            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '            If int_reporte = 1 Then

            '                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '                "AND ID_VOIE = '" & int_id_voie & "' " & _
            '                "AND VOIE = '" & str_id_voie & "' "

            '            ElseIf int_reporte = 2 Then

            '                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            ElseIf int_reporte = 3 Then

            '                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            '            End If

            '            'ID_PAIEMENT
            '            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '            '"AND ID_OBS_SEQUENCE = '5' " & _
            '            '"AND ID_OBS_PASSAGE = '3' " & _
            '            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 13000 " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"


            '            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '            End If

            '            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '            'ELUDIDO NEW
            '            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Eludido"

            '                oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '                oDatarowReporte_5("Grupo") = strGrupo
            '                oDatarowReporte_5("Concepto") = strConcepto
            '                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '                oDatarowReporte_5("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then
            '                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
            '                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    db_tot_53 = db_tot_53 + dvEvento(0).Item("cruces")

            '                Else
            '                    oDatarowReporte_5("Numero") = 0
            '                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '                End If
            '                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    db_tot_54 = db_tot_54 + dvEvento(0).Item("Total")
            '                Else

            '                End If

            '            Next

            '            'excedentes asignados
            '            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Eludido"

            '                oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '                oDatarowReporte_5("Grupo") = strGrupo
            '                oDatarowReporte_5("Concepto") = strConcepto

            '                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(1)
            '                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(9)
            '                End If

            '                oDatarowReporte_5("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then
            '                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
            '                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    db_tot_53 = db_tot_53 + dvEvento(0).Item("cruces")

            '                Else
            '                    oDatarowReporte_5("Numero") = 0
            '                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '                End If
            '                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    dvTarifa.RowFilter = "CODE = 1 "

            '                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
            '                    db_tot_54 = db_tot_54 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
            '                Else

            '                End If

            '            Next

            '            'solo exedentes
            '            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Eludido"

            '                oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '                oDatarowReporte_5("Grupo") = strGrupo
            '                oDatarowReporte_5("Concepto") = strConcepto
            '                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '                oDatarowReporte_5("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    '10,12

            '                    oDatarowReporte_5("Numero") = dvEvento(0).Item("excedentes")
            '                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
            '                    'db_tot_53 = db_tot_53 + dvEvento(0).Item("excedentes")

            '                Else
            '                    oDatarowReporte_5("Numero") = 0
            '                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '                End If
            '                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    dvTarifa.RowFilter = "CODE = 1 "
            '                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
            '                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


            '                    db_tot_54 = db_tot_54 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
            '                Else

            '                End If

            '            Next


            '            'solo excedentes directos aclase
            '            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Eludido"

            '                oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '                oDatarowReporte_5("Grupo") = strGrupo
            '                oDatarowReporte_5("Concepto") = strConcepto
            '                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '                oDatarowReporte_5("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    '10,11

            '                    If oDataRowNueve("ID_CLASSE") = 10 Then
            '                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
            '                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
            '                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces") * 2
            '                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
            '                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
            '                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
            '                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    End If

            '                    'db_tot_53 = db_tot_53 + dvEvento(0).Item("excedentes")

            '                Else
            '                    oDatarowReporte_5("Numero") = 0
            '                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '                End If
            '                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)


            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    dvTarifa.RowFilter = "CODE = 1 "

            '                    If oDataRowNueve("ID_CLASSE") = 10 Then
            '                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

            '                        db_tot_54 = db_tot_54 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

            '                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
            '                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

            '                        db_tot_54 = db_tot_54 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


            '                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

            '                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

            '                        db_tot_54 = db_tot_54 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

            '                    End If

            '                Else

            '                End If



            '            Next

            '            'ELUDIDO NEW FIN

            '*** eludido fin

            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "a"
            '    strConcepto = "Eludido"

            '    oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '    oDatarowReporte_5("Grupo") = strGrupo
            '    oDatarowReporte_5("Concepto") = strConcepto
            '    oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_5("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_53 = db_tot_53 + dvEvento(0).Item("cruces")
            '        db_tot_54 = db_tot_54 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            'Next




            'c45b (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 75 and ID_OBS_SEQUENCE = '0') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView


            'residente new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_531 = db_tot_531 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_541 = db_tot_541 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_531 = db_tot_531 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_5("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_531 = db_tot_531 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_531 = db_tot_531 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next
            'residente new fin

            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "a"
            '    strConcepto = "Residente"

            '    oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '    oDatarowReporte_5("Grupo") = strGrupo
            '    oDatarowReporte_5("Concepto") = strConcepto
            '    oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_5("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_531 = db_tot_531 + dvEvento(0).Item("cruces")
            '        db_tot_541 = db_tot_541 + dvEvento(0).Item("cruces")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            'Next

            'c45c (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            strQuerys = strQuerys & "AND (ID_PAIEMENT = 27 and (ID_OBS_SEQUENCE = '0' or ID_OBS_SEQUENCE = 'F')) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            'gruas
            '            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or " & _
            '"  (ID_PAIEMENT = 0 AND ID_OBS_SEQUENCE = 'E')) " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'VSC NEW
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_532 = db_tot_532 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_542 = db_tot_542 + dvEvento(0).Item("Total")
                Else

                End If



            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_532 = db_tot_532 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If



            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_5("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_532 = db_tot_532 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If



            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_532 = db_tot_532 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else

                End If



            Next
            'VSC NEW FIN




            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "a"
            '    strConcepto = "V.S.C."

            '    oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '    oDatarowReporte_5("Grupo") = strGrupo
            '    oDatarowReporte_5("Concepto") = strConcepto
            '    oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_5("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_532 = db_tot_532 + dvEvento(0).Item("cruces")
            '        db_tot_542 = db_tot_542 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            'Next




            'c48 (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '13000
            '            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 13)) " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and (ID_OBS_SEQUENCE = '0' or ID_OBS_SEQUENCE = 'F')) or (ID_PAIEMENT = 75 and ID_OBS_SEQUENCE = '0')) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            'gruas
            '            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or " & _
            '"  (ID_PAIEMENT = 0 AND ID_OBS_SEQUENCE = 'E')) " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"



            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'aforo total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_56 = db_tot_56 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_57 = db_tot_57 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_56 = db_tot_56 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_5("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_56 = db_tot_56 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_56 = db_tot_56 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next

            'aforo total new fin


            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "b"
            '    strConcepto = "Aforo Total"

            '    oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '    oDatarowReporte_5("Grupo") = strGrupo
            '    oDatarowReporte_5("Concepto") = strConcepto
            '    oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_5("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_56 = db_tot_56 + dvEvento(0).Item("cruces")
            '        db_tot_57 = db_tot_57 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            'Next


            Dim rds_5 As New ReportDataSource
            rds_5.Name = "DataSet9"
            rds_5.Value = odataSetReporte_5.Tables("tabla_reporte_5")

            ReportViewer2.LocalReport.DataSources.Add(rds_5)


            'Fin Tabla 4----------------------------
            'inicio tabla 4 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "Cantidad")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "Total")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "Tipo_Total")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "strNumero")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            odataSetReporte_total_5.Tables.Add(oDataTableReporte_total_5)
            '--------------------------------------------------------
            '--------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "53"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_5("strNumero") = Format(db_tot_53, "###,###,##0")

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '--------------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "531"
            oDatarowReporte_total_5("Total") = "             Total           "
            oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_531, "###,###,##0")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)

            '--------------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "532"
            oDatarowReporte_total_5("Total") = "             Total           "
            oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_532, "###,###,##0")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '--------------------------------------------------------

            '--------------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "56"
            oDatarowReporte_total_5("Total") = "             Total           "
            oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_56, "###,###,##0")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '--------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "56"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_5("strNumero") = Format(db_tot_57 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            ''----------------------------------------------------------------------------
            ''--------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "56"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_5("strNumero") = Format(db_tot_57 - (db_tot_57 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            ''----------------------------------------------------------------------------
            ''-------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "59"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_5("strNumero") = "Total:"

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '---------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "59"
            oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_5("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_57, "###,###,##0.00")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '-------------------------------------------------------

            Dim rds_Total_5 As New ReportDataSource
            rds_Total_5.Name = "DataSet10"
            rds_Total_5.Value = odataSetReporte_total_5.Tables("tabla_reporte_total_5")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_5)
            'fin tabla 5

            'tabla 6
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Grupo")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Concepto")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Descricion_clase")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Numero_clase")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 1, "Numero")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "strNumero")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            odataSetReporte_6.Tables.Add(oDataTableReporte_6)
            '--------------------------------------------------------

            'Pago en efectivo dlls por cajero-receptor C77 C78 (pend)
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
    "FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
    "WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
    "AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'F' " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            'AND ID_PAIEMENT = 0

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'reclasificaciones new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_77 = db_tot_77 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_78 = db_tot_78 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_77 = db_tot_77 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_6("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_77 = db_tot_77 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_77 = db_tot_77 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next

            'reclasificaciones new fin


            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "a"
            '    strConcepto = " Reclasificaciones"

            '    oDatarowReporte_6 = oDataTableReporte_6.NewRow

            '    oDatarowReporte_6("Grupo") = strGrupo
            '    oDatarowReporte_6("Concepto") = strConcepto
            '    oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_6("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_77 = db_tot_77 + dvEvento(0).Item("cruces")
            '        db_tot_78 = db_tot_78 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_6.Rows.Add(oDatarowReporte_6)


            'Next


            'Pago en efectivo dlls por cajero-receptor C77 C78 (pend)
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
    "FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
    "WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
    "AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            'ID_CLASSE TAB_ID_CLASSE
            '        strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'F' " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            'JORGE / Cambio de ID_OBS_PASSAGE de 6 (Discordancia de clase) a 1 (Retroceder), para que salga en cero comparativo en file "De" (detecciones erroneas) / 18/04/2018
            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '10' " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView


            '"De" new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_80 = db_tot_80 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_81 = db_tot_81 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_80 = db_tot_80 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_6("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_80 = db_tot_80 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_80 = db_tot_80 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next
            '"De" new fin


            'If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            'End If

            'dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "b"
            '    strConcepto = "De"

            '    oDatarowReporte_6 = oDataTableReporte_6.NewRow

            '    oDatarowReporte_6("Grupo") = strGrupo
            '    oDatarowReporte_6("Concepto") = strConcepto
            '    oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_6("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_80 = db_tot_80 + dvEvento(0).Item("cruces")
            '        db_tot_81 = db_tot_81 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

            'Next



            Dim rds_6 As New ReportDataSource
            rds_6.Name = "DataSet11"
            rds_6.Value = odataSetReporte_6.Tables("tabla_reporte_6")

            ReportViewer2.LocalReport.DataSources.Add(rds_6)


            'Totales Tabla 6
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "Cantidad")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "Total")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "Tipo_Total")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "strNumero")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            odataSetReporte_total_6.Tables.Add(oDataTableReporte_total_6)
            '--------------------------------------------------------
            oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            oDatarowReporte_total_6("Cantidad") = "77"
            oDatarowReporte_total_6("Total") = "             Total           "
            oDatarowReporte_total_6("Tipo_Total") = " Aforo"
            oDatarowReporte_total_6("strNumero") = Format(db_tot_77, "###,###,##0")

            oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "77"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_6("strNumero") = "Total:"

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "77"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_6("strNumero") = Format(db_tot_78, "###,###,##0.00")

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------
            '-------------------------------------------------------
            oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            oDatarowReporte_total_6("Cantidad") = "80"
            oDatarowReporte_total_6("Total") = "             Total           "
            oDatarowReporte_total_6("Tipo_Total") = " Aforo"
            oDatarowReporte_total_6("strNumero") = Format(db_tot_80, "###,###,##0")

            oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "80"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_6("strNumero") = "Total:"

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "80"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_6("strNumero") = Format(db_tot_81, "###,###,##0.00")

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------

            Dim rds_Total_6 As New ReportDataSource
            rds_Total_6.Name = "DataSet12"
            rds_Total_6.Value = odataSetReporte_total_6.Tables("tabla_reporte_total_6")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_6)


            'fin tabla 6


            'inicio tabla 7

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Grupo")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Concepto")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Descricion_clase")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Numero_clase")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 1, "Numero")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "strNumero")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            odataSetReporte_7.Tables.Add(oDataTableReporte_7)

            'TOTAL MARCADO POR CAJERO RECEPTOR NEW
            'TABLA1 TABLA 7 NEW
            'aforo total new
            '''''''''''''''''''''''''''''''
            'normal
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '" Normal Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next
            'Ingreso Total new fin

            'TABLA1 TABLA 7 NEW FIN

            'TABLA 4 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' and SHIFT_NUMBER = " & id_turno & " "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) and SHIFT_NUMBER = " & id_turno & " "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'TABLA 4 TABLA 7 FIN

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '13000
            '            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 13)) " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and (ID_OBS_SEQUENCE = '0' or ID_OBS_SEQUENCE = 'F'))) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'TABLA 5 TABLA 7 NEW FIN

            'TABLA 6 TABLA 7 NEW FIN

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 75 and ID_OBS_SEQUENCE = '0') " &
  "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'TABLA 6 TABLA 7 NEW FIN

            'tarjeta bancaria
            'TABLA 6_2 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 12 or ID_PAIEMENT = 14)  " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            Dim rds_7 As New ReportDataSource
            rds_7.Name = "DataSet13"
            rds_7.Value = odataSetReporte_7.Tables("tabla_reporte_7")

            ReportViewer2.LocalReport.DataSources.Add(rds_7)



            'inicio tabla 7 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "Cantidad")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "Total")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "Tipo_Total")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "strNumero")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            odataSetReporte_total_7.Tables.Add(oDataTableReporte_total_7)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            oDatarowReporte_total_7("Cantidad") = "61"
            oDatarowReporte_total_7("Total") = "             Total           "
            oDatarowReporte_total_7("Tipo_Total") = " Aforo"
            oDatarowReporte_total_7("strNumero") = Format(db_tot_61, "###,###,##0")

            oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            '--------------------------------------------------------

            'oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            'oDatarowReporte_total_7("Cantidad") = "63"
            'oDatarowReporte_total_7("Total") = "             Total           "
            'oDatarowReporte_total_7("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_7("strNumero") = Format(db_tot_63 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            ''----------------------------------------------------------------------------

            ''--------------------------------------------------------
            'oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            'oDatarowReporte_total_7("Cantidad") = "63"
            'oDatarowReporte_total_7("Total") = "             Total           "
            'oDatarowReporte_total_7("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_7("strNumero") = Format(db_tot_63 - (db_tot_63 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            ''----------------------------------------------------------------------------
            ''-------------------------------------------------------
            'oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            'oDatarowReporte_total_7("Cantidad") = "65"
            'oDatarowReporte_total_7("Total") = "             Total           "
            'oDatarowReporte_total_7("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_7("strNumero") = "Total:"

            'oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            '---------------------------------------------------
            oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            oDatarowReporte_total_7("Cantidad") = "65"
            oDatarowReporte_total_7("Total") = "             Total           "
            'oDatarowReporte_total_7("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_7("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_7("strNumero") = Format(db_tot_63, "###,###,##0.00")

            oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            '-------------------------------------------------------

            Dim rds_Total_7 As New ReportDataSource
            rds_Total_7.Name = "DataSet14"
            rds_Total_7.Value = odataSetReporte_total_7.Tables("tabla_reporte_total_7")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_7)

            'fin tabla 7



            'TABLA 8
            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Grupo")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Concepto")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Descricion_clase")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Numero_clase")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 1, "Numero")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "strNumero")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            odataSetReporte_8.Tables.Add(oDataTableReporte_8)


            'TOTAL DETECTADO POR EL EQUIPO DE CONTROL
            'TABLA1 TABLA 8 NEW
            'aforo total new
            '''''''''''''''''''''''''''''''
            'normal
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(TRANSACTION_CPT1/100) AS Total, count(*) as cruces, SUM(ID_OBS_TT) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            '" Normal Aforo"
            ' "AND ID_PAIEMENT = 1 " & _
            strQuerys = strQuerys &
" AND (ID_PAIEMENT <> 2 and ID_PAIEMENT <> 15 and ID_PAIEMENT <> 27 and ID_PAIEMENT <> 13 and ID_PAIEMENT <> 75) AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")


                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    'no todos tienen tarifa
                    'oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    'db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                    'no todos tienen tarifa fin
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & oDataRowCuatro("ID_CLASSE"))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))


                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next
            'Ingreso Total new fin



            'cuota reducida
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(TRANSACTION_CPT1/100) AS Total, count(*) as cruces, SUM(ID_OBS_TT) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            '" Normal Aforo"
            ' "AND ID_PAIEMENT = 1 " & _
            strQuerys = strQuerys &
" AND (ID_PAIEMENT = 2 and ID_PAIEMENT <> 15 and ID_PAIEMENT <> 27 and ID_PAIEMENT <> 13 and ID_PAIEMENT <> 75) AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")


                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    'no todos tienen tarifa
                    'oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    'db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                    'no todos tienen tarifa fin
                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & oDataRowCuatro("ID_CLASSE"))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))


                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'fin cuota reducida


            '            'TABLA1 TABLA 7 NEW FIN

            'TABLA 4 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(TRANSACTION_CPT1/100) AS Total, count(*) as cruces, SUM(ID_OBS_TT) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' and SHIFT_NUMBER = " & id_turno & " "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) and SHIFT_NUMBER = " & id_turno & " "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'TABLA 4 TABLA 7 FIN

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(TRANSACTION_CPT1/100) AS Total, count(*) as cruces, SUM(ID_OBS_TT) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and (ID_OBS_SEQUENCE = '0' or ID_OBS_SEQUENCE = 'F')) or (ID_PAIEMENT = 13) ) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next



            '***residentes aforo vehiculos sin pago  #75  *tlmdc
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(TRANSACTION_CPT1/100) AS Total, count(*) as cruces, SUM(ID_OBS_TT) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 75 and ID_OBS_SEQUENCE = '0')) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE")))
                    'oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    'db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next
            '***fin residentes aforo vehiculos sin pago  #75




            Dim rds_8 As New ReportDataSource
            rds_8.Name = "DataSet15"
            rds_8.Value = odataSetReporte_8.Tables("tabla_reporte_8")

            ReportViewer2.LocalReport.DataSources.Add(rds_8)




            'inicio tabla 8 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "Cantidad")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "Total")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "Tipo_Total")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "strNumero")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            odataSetReporte_total_8.Tables.Add(oDataTableReporte_total_8)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            oDatarowReporte_total_8("Cantidad") = "61"
            oDatarowReporte_total_8("Total") = "             Total           "
            oDatarowReporte_total_8("Tipo_Total") = " Aforo"
            oDatarowReporte_total_8("strNumero") = Format(db_tot_67, "###,###,##0")

            oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            '--------------------------------------------------------

            'oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            'oDatarowReporte_total_8("Cantidad") = "63"
            'oDatarowReporte_total_8("Total") = "             Total           "
            'oDatarowReporte_total_8("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_8("strNumero") = Format(db_tot_69 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            ''----------------------------------------------------------------------------

            ''--------------------------------------------------------
            'oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            'oDatarowReporte_total_8("Cantidad") = "63"
            'oDatarowReporte_total_8("Total") = "             Total           "
            'oDatarowReporte_total_8("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_8("strNumero") = Format(db_tot_69 - (db_tot_69 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            ''----------------------------------------------------------------------------
            ''-------------------------------------------------------
            'oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            'oDatarowReporte_total_8("Cantidad") = "65"
            'oDatarowReporte_total_8("Total") = "             Total           "
            'oDatarowReporte_total_8("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_8("strNumero") = "Total:"

            'oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            '---------------------------------------------------
            oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            oDatarowReporte_total_8("Cantidad") = "65"
            oDatarowReporte_total_8("Total") = "             Total           "
            'oDatarowReporte_total_8("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_8("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_8("strNumero") = Format(db_tot_69, "###,###,##0.00")

            oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            '-------------------------------------------------------

            Dim rds_Total_8 As New ReportDataSource
            rds_Total_8.Name = "DataSet16"
            rds_Total_8.Value = odataSetReporte_total_8.Tables("tabla_reporte_total_8")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_8)


            'FIN TABLA 8

            'inicio tabla 9
            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Grupo")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Concepto")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Descricion_clase")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Numero_clase")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 1, "Numero")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "strNumero")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            odataSetReporte_9.Tables.Add(oDataTableReporte_9)

            'DIFERENCIA ENTRE TOTAL MARCADO POR EL CAJERO Y EL EQUIPO DE CONTROL DE TRANSITO NEW

            'DIF TABLA 7
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '" Normal Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin

            'TABLA1 TABLA 7 NEW FIN

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '13000
            '            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 13)) " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"


            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and (ID_OBS_SEQUENCE = '0' or ID_OBS_SEQUENCE = 'F'))) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next



            '***residentes aforo vehiculos sin pago  #75  *tlmdc
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '13000
            '            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 13)) " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"


            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 75 and ID_OBS_SEQUENCE = '0')) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea
                'cambiar
                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    'dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE")))
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")

                    'oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    'db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            '***residentes aforo vehiculos sin pago  #75  *tlmdc fin




            'TABLA 5 TABLA 7 NEW FIN

            'TABLA 6 TABLA 7 NEW FIN

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If
            'bancarias ultima tabla
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 12 or ID_PAIEMENT = 14) " &
  "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'TABLA 6 TABLA 7 NEW FIN


            'TABLA 6_2 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' and SHIFT_NUMBER = " & id_turno & " "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) and SHIFT_NUMBER = " & id_turno & " "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & " AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'DIF TABLA 7 FIN

            'DIF TABLA 8
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(TRANSACTION_CPT1/100) AS Total, count(*) as cruces, SUM(ID_OBS_TT) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '" Normal Aforo"
            ' "AND ID_PAIEMENT = 1 " & _
            strQuerys = strQuerys &
" AND (ID_PAIEMENT <> 2 and ID_PAIEMENT <> 15 and ID_PAIEMENT <> 27 and ID_PAIEMENT <> 13  and ID_PAIEMENT <> 75) AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"



            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces") * 2

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    'no todos tienen tarifa
                    'oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")
                    'db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                    'no todos tienen tarifa fin

                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If

                Else
                    oDatarowReporte_9("Numero") = 0
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin



            'cuota reducida
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(TRANSACTION_CPT1/100) AS Total, count(*) as cruces, SUM(ID_OBS_TT) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            '" Normal Aforo"
            ' "AND ID_PAIEMENT = 1 " & _
            strQuerys = strQuerys &
" AND (ID_PAIEMENT = 2 and ID_PAIEMENT <> 15 and ID_PAIEMENT <> 27 and ID_PAIEMENT <> 13  and ID_PAIEMENT <> 75) AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"



            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces") * 2

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    'no todos tienen tarifa
                    'oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")
                    'db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                    'no todos tienen tarifa fin

                    dvTarifa.RowFilter = "CODE = 2 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If

                Else
                    oDatarowReporte_9("Numero") = 0
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'fin cuota reducida



            'inicia tag
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(TRANSACTION_CPT1/100) AS Total, count(*) as cruces, SUM(ID_OBS_TT) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' and SHIFT_NUMBER = " & id_turno & " "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) and SHIFT_NUMBER = " & id_turno & " "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    'oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    'oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    'oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    'oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    'oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    'oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    'oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    'oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                        'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -(dvEvento(0).Item("cruces") * 2)
                        'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                        'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        'oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        'oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        'oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    'oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'termina tag

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(TRANSACTION_CPT1/100) AS Total, count(*) as cruces, SUM(ID_OBS_TT) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and (ID_OBS_SEQUENCE = '0' or ID_OBS_SEQUENCE = 'F')) or (ID_PAIEMENT = 13)) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -(dvEvento(0).Item("cruces") * 2)

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            '***residentes aforo vehiculos sin pago  #75  *tlmdc
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(TRANSACTION_CPT1/100) AS Total, count(*) as cruces, SUM(ID_OBS_TT) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 75 and ID_OBS_SEQUENCE = '0') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    'oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")
                    'oDatarowReporte_9("strNumero") = Format(-dvEvento(0).Item("Total"), "###,###,##0.00")
                    'db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")

                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    oDatarowReporte_9("strNumero") = Format(-(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))



                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -(dvEvento(0).Item("cruces") * 2)

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next




            Dim rds_9 As New ReportDataSource
            rds_9.Name = "DataSet17"
            rds_9.Value = odataSetReporte_9.Tables("tabla_reporte_9")

            ReportViewer2.LocalReport.DataSources.Add(rds_9)


            'tabla 9 totales
            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "Cantidad")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "Total")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "Tipo_Total")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "strNumero")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            odataSetReporte_total_9.Tables.Add(oDataTableReporte_total_9)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_9 = oDataTableReporte_total_9.NewRow

            oDatarowReporte_total_9("Cantidad") = "73"
            oDatarowReporte_total_9("Total") = "             Total           "
            oDatarowReporte_total_9("Tipo_Total") = " Aforo"
            oDatarowReporte_total_9("strNumero") = Format(db_tot_73, "###,###,##0")

            oDataTableReporte_total_9.Rows.Add(oDatarowReporte_total_9)
            '--------------------------------------------------------

            'oDatarowReporte_total_9 = oDataTableReporte_total_9.NewRow

            'oDatarowReporte_total_9("Cantidad") = "75"
            'oDatarowReporte_total_9("Total") = "             Total           "
            'oDatarowReporte_total_9("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_9("strNumero") = "Total:"

            'oDataTableReporte_total_9.Rows.Add(oDatarowReporte_total_9)
            '----------------------------------------------------------------------------

            '--------------------------------------------------------
            oDatarowReporte_total_9 = oDataTableReporte_total_9.NewRow

            oDatarowReporte_total_9("Cantidad") = "75"
            oDatarowReporte_total_9("Total") = "             Total           "
            'oDatarowReporte_total_9("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_9("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_9("strNumero") = Format(db_tot_75, "###,###,##0.00")

            oDataTableReporte_total_9.Rows.Add(oDatarowReporte_total_9)
            '----------------------------------------------------------------------------
            '-------------------------------------------------------

            Dim rds_Total_9 As New ReportDataSource
            rds_Total_9.Name = "DataSet18"
            rds_Total_9.Value = odataSetReporte_total_9.Tables("tabla_reporte_total_9")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_9)

            'fin tabla 9




            ReportViewer2.SetDisplayMode(DisplayMode.PrintLayout)
            Me.ReportViewer2.RefreshReport()

            '--------------------------------Codigo para generar PDF ----------------------
            Dim lstMeses = New String() {"Enero", "Fecbrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"}
            Dim turno As String = ""
            Dim banFechaOp As Boolean = False
            Select Case RTrim(LTrim(str_Turno_block))
                Case "22:00 - 06:00"
                    turno = "Nocturno"
                    banFechaOp = True
                Case "06:00 - 14:00"
                    turno = "Matutino"
                Case "14:00 - 22:00"
                    turno = "Vespertino"
                Case Else
                    turno = "Dia"
            End Select

            Dim Bytes() As Byte = ReportViewer2.LocalReport.Render("PDF", "", Nothing, Nothing, Nothing, Nothing, Nothing)
            Dim str_archivo As String

            If bl_varios_turnos = False Then
                str_archivo = Format(h_inicio_turno, "yyyyMMddHHmmss") & "_" & No_Turno & "_" & "_" & str_MATRICULE
            Else
                str_archivo = Format(hr_fecha_ini_varios_turnos, "yyyyMMddHHmmss") & "_" & No_Turno & "_" & "_" & str_MATRICULE
            End If

            If banFechaOp And fechaOpeTemp <> "" Then
                str_archivo = fechaOpeTemp + str_archivo.Substring(8, str_archivo.Length() - 9)
            End If

            Using Stream As New FileStream("C:\reportes_pdf\" + lstMeses(Integer.Parse(dt_Fecha_Inicio.Month) - 1).ToString() + "\Dia" + dt_Fecha_Inicio.Day.ToString() + "\" + turno + "\" & "Com_" & str_archivo + " " + carrilTemp & ".pdf", FileMode.Create)
                Stream.Write(Bytes, 0, Bytes.Length)
                Stream.Close()
            End Using
            '--------------------------------Codigo para generar EXCEL ----------------------
            Dim Bytes1() As Byte = ReportViewer2.LocalReport.Render("Excel", "", Nothing, Nothing, Nothing, Nothing, Nothing)
            Dim str_archivo2 As String

            If bl_varios_turnos = False Then
                str_archivo2 = Format(h_inicio_turno, "yyyyMMddHHmmss") & "_" & No_Turno & "_" & "_" & str_MATRICULE
            Else
                str_archivo2 = Format(hr_fecha_ini_varios_turnos, "yyyyMMddHHmmss") & "_" & No_Turno & "_" & "_" & str_MATRICULE
            End If

            If banFechaOp And fechaOpeTemp <> "" Then
                str_archivo2 = fechaOpeTemp + str_archivo.Substring(8, str_archivo2.Length() - 9)
            End If

            Using Stream As New FileStream("C:\reportes_xls\" + lstMeses(Integer.Parse(dt_Fecha_Inicio.Month) - 1).ToString() + "\Dia" + dt_Fecha_Inicio.Day.ToString() + "\" + turno + "\" & "Com_" & str_archivo + " " + carrilTemp & ".xls", FileMode.Create)
                Stream.Write(Bytes1, 0, Bytes1.Length)
                Stream.Close()
            End Using


        Catch ex As Exception
            'MsgBox(ex)
        End Try



    End Sub


    Function encabezados_clases(ByVal id_clase As Integer) As String

        objControl.limpia_Catalogos()

        Select Case id_clase

            Case 1
                encabezados_clases = " Autos"
                strLinea = id_clase

            Case 2, 3, 4, 5, 6, 7, 8, 9
                encabezados_clases = "Camiones"
                strLinea = id_clase

            Case 12, 13, 14
                encabezados_clases = "Autobuses"
                strLinea = Mid(Trim(CStr(id_clase)), 2, 2)
            Case 15
                encabezados_clases = " Motos"
                strLinea = id_clase

            Case 10, 11, 17
                encabezados_clases = "Ejes Excedentes"
                'strLinea = id_clase
                strLinea = "EE1"

            Case 16, 18
                encabezados_clases = "Ejes Excedentes"
                'strLinea = id_clase
                strLinea = "EE2"



            Case Else
                MsgBox(id_clase)

        End Select

    End Function


    Function asignacion_excedente_clase(ByVal id_clase As Integer) As String

        objControl.limpia_Catalogos()

        Select Case id_clase

            Case 10, 11, 17
                asignacion_excedente_clase = "01"

            Case 16, 18
                asignacion_excedente_clase = "09"

            Case Else
                MsgBox(id_clase)

        End Select

    End Function


    Private Sub Preliquidacion_Cajero_Receptor_Transito_Vehicular(ByVal int_reporte As Integer)


        Try

            Dim strQuerys As String
            Dim strQuerys_varios_cortes As String

            'Dim hr_fecha_ini_varios_turnos As Date
            'Dim hr_fecha_fin_varios_turnos As Date
            'Dim bl_varios_turnos As Boolean = False

            Dim odataSetReporte As New DataSet
            Dim oDataTableReporte As DataTable = New DataTable("tabla_reporte")
            Dim oDataColumnaReporte As DataColumn
            Dim oDatarowReporte As DataRow

            Dim strGrupo As String
            Dim strConcepto As String
            Dim strTipoConcepto_A As String
            Dim strTipoConcepto_B As String
            Dim strTipoConcepto_C As String
            Dim strTipoConceptoGenero_A As String
            Dim strTipoConceptoGenero_B As String

            strQuerys = strLinea

            'Dim rpt_reporte As New rptPreliquidacion_Cajero_Receptor_Transito_Vehicular
            'Dim objText As TextObject

            Dim str_id_RESEAU As String
            Dim int_id_gare As Integer
            Dim str_id_voie As String
            Dim int_id_voie As String 'Integer
            Dim int_numero_poste As Integer
            Dim dt_ini_poste As Date
            Dim dt_fin_poste As Date
            Dim str_MATRICULE As String

            Dim str_Voie_varios_turnos As String

            Dim str_cajero As String = str_Cajero_Receptor
            Dim id_plaza_cobro_local As String = id_plaza_cobro

            Dim h_inicio_turno As Date
            Dim h_fin_turno As Date

            '        'VARIABLES DE CAMPO
            Dim VAR_11 As Double = 0
            Dim VAR_12 As Double = 0
            Dim VAR_13 As Double = 0
            Dim VAR_14 As Double = 0
            Dim VAR_15 As Double = 0
            Dim VAR_16 As Double = 0
            Dim VAR_17 As Double = 0
            Dim VAR_18 As Double = 0
            Dim VAR_19 As Double = 0
            Dim VAR_20 As Double = 0
            Dim VAR_21 As Double = 0
            Dim VAR_22 As Double = 0
            Dim VAR_23 As Double = 0

            Dim VAR_24 As Double = 0
            Dim VAR_25 As Double = 0
            Dim VAR_26 As Double = 0
            Dim VAR_27 As Double = 0

            Dim VAR_28 As Double = 0
            Dim VAR_29 As Double = 0
            Dim VAR_30 As Double = 0
            Dim VAR_31 As Double = 0
            Dim VAR_32 As Double = 0
            Dim VAR_33 As Double = 0
            Dim VAR_34 As Double = 0
            Dim VAR_35 As Double = 0
            Dim VAR_36 As Double = 0
            Dim VAR_37 As Double = 0
            Dim VAR_38 As Double = 0
            Dim VAR_39 As Double = 0

            Dim VAR_40 As Double = 0
            Dim VAR_41 As Double = 0
            Dim VAR_42 As Double = 0
            Dim VAR_43 As Double = 0

            Dim VAR_140 As Double = 0
            Dim VAR_141 As Double = 0
            Dim VAR_142 As Double = 0
            Dim VAR_143 As Double = 0



            Dim VAR_44 As Double = 0
            Dim VAR_45 As Double = 0
            Dim VAR_46 As Double = 0
            Dim VAR_47 As Double = 0
            Dim VAR_48 As Double = 0
            Dim VAR_49 As Double = 0

            Dim VAR_50 As Double = 0
            Dim VAR_51 As Double = 0
            Dim VAR_52 As Double = 0
            Dim VAR_53 As Double = 0
            Dim VAR_54 As Double = 0
            Dim VAR_55 As Double = 0
            Dim VAR_56 As Double = 0
            Dim VAR_57 As Double = 0
            Dim VAR_58 As Double = 0
            Dim VAR_59 As Double = 0

            Dim VAR_60 As Double = 0
            Dim VAR_61 As Double = 0
            Dim VAR_62 As Double = 0
            Dim VAR_63 As Double = 0
            Dim VAR_64 As Double = 0
            Dim VAR_65 As Double = 0
            Dim VAR_66 As Double = 0
            Dim VAR_67 As Double = 0
            Dim VAR_68 As Double = 0
            Dim VAR_69 As Double = 0

            Dim VAR_70 As Double = 0
            Dim VAR_71 As Double = 0
            Dim VAR_72 As Double = 0
            Dim VAR_73 As Double = 0
            Dim VAR_74 As Double = 0
            Dim VAR_75 As Double = 0
            Dim VAR_76 As Double = 0
            Dim VAR_77 As Double = 0
            Dim VAR_78 As Double = 0
            Dim VAR_79 As Double = 0

            Dim VAR_80 As Double = 0
            Dim VAR_81 As Double = 0
            Dim VAR_82 As Double = 0
            Dim VAR_83 As Double = 0
            Dim VAR_84 As Double = 0
            Dim VAR_85 As Double = 0
            Dim VAR_86 As Double = 0
            Dim VAR_87 As Double = 0
            Dim VAR_88 As Double = 0
            Dim VAR_89 As Double = 0

            Dim VAR_90 As Double = 0
            Dim VAR_91 As Double = 0
            Dim VAR_92 As Double = 0
            Dim VAR_93 As Double = 0
            Dim VAR_94 As Double = 0
            Dim VAR_95 As Double = 0
            Dim VAR_96 As Double = 0
            Dim VAR_97 As Double = 0
            Dim VAR_98 As Double = 0
            Dim VAR_99 As Double = 0


            Dim cont As Double

            Dim db_acom_63 As Double = 0
            Dim db_acom_94 As Double = 0
            Dim db_acom_65 As Double = 0
            Dim db_acom_67 As Double = 0
            Dim db_acom_folios As Double = 0
            Dim db_acom_folios2 As Double = 0
            Dim db_acom_folios3 As Double = 0
            Dim db_acom_eventos As Double = 0

            Dim No_Turno As String
            Dim id_Turno As String

            Dim saco As String

            Dim bl_carril_automatico As Boolean



            'reporte cajero receptor
            If int_reporte = 1 Then


                ReportViewer1.LocalReport.DataSources.Clear()
                ReportViewer1.LocalReport.ReportEmbeddedResource = "rptPreliquidacion_Cajero_Receptor_Transito_Vehicular.rdlc"

                'verifico cuantos cortes tiene en ese turno

                strQuerys = "SELECT GEADBA.FIN_POSTE.ID_RESEAU, GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE_L2, GEADBA.FIN_POSTE.VOIE, TO_CHAR(GEADBA.FIN_POSTE.NUMERO_POSTE, 'FM09') AS Expr1, " &
          "TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'MM/DD/YY') AS Expr2, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'HH24:MI') AS Expr3, " &
          "GEADBA.FIN_POSTE.MATRICULE, GEADBA.FIN_POSTE.SAC AS Expr4, GEADBA.FIN_POSTE.ID_VOIE, " &
          "TO_CHAR(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE, 'YYYYMMDDHH24MISS') AS Expr5, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'YYYYMMDDHH24MISS') AS Expr6, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE, 0 AS Expr7, " &
          "FOLIO_NUMBER_CLOSE, INITIAL_EVENT_NUMBER, FINAL_EVENT_NUMBER " &
          "FROM GEADBA.TYPE_VOIE, GEADBA.FIN_POSTE, GEADBA.SITE_GARE " &
          "WHERE GEADBA.TYPE_VOIE.ID_VOIE = GEADBA.FIN_POSTE.ID_VOIE AND GEADBA.FIN_POSTE.ID_RESEAU = GEADBA.SITE_GARE.ID_RESEAU AND " &
          "GEADBA.FIN_POSTE.ID_GARE = GEADBA.SITE_GARE.ID_GARE AND (GEADBA.SITE_GARE.ID_RESEAU = '01') AND (GEADBA.SITE_GARE.ID_SITE = '" & id_plaza_cobro_local & "') AND " &
          "(GEADBA.FIN_POSTE.ID_MODE_VOIE IN (1, 6, 7)) "


                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "5 MATUTINO"
                    id_Turno = 2
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "6 VESPERTINO"
                    id_Turno = 3
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "4 NOCTURNO"
                    id_Turno = 1
                End If

                strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

                'mando señal automatica
                If gl_bl_bolsa_automatica = True Then

                    strQuerys = strQuerys & "AND SAC = '" & gl_str_bolsa_automatica & "' "



                End If

                '    strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_FIN_POSTE >= TO_DATE('" & Format(dt_Fecha_Inicio, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '"(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(dt_Fecha_Fin, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "
                strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.ID_VOIE = '1' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '2' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '3' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '4' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = 'X') " &
             "AND (GEADBA.FIN_POSTE.MATRICULE = '" & str_cajero & "') " &
             "AND GEADBA.FIN_POSTE.SAC is not null " &
             "ORDER BY GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.ID_VOIE, GEADBA.FIN_POSTE.VOIE, GEADBA.FIN_POSTE.DATE_FIN_POSTE, " &
             "GEADBA.FIN_POSTE.NUMERO_POSTE, GEADBA.FIN_POSTE.MATRICULE, Expr4"
                'AND (GEADBA.FIN_POSTE.NUMERO_POSTE = " & id_Turno & ")

                If objQuerys.QueryDataSet(strQuerys, "TYPE_VOIE") = 1 Then

                    If oDataSet.Tables("TYPE_VOIE").Rows.Count = 1 Then

                        If gl_bl_bolsa_automatica = True Then

                            bl_varios_turnos = False

                            hr_fecha_ini_varios_turnos = objControl.fecha(oDataRow("Expr5"))
                            hr_fecha_fin_varios_turnos = objControl.fecha(oDataRow("Expr6"))

                            gl_bl_bolsa_automatica = False
                        End If

                    ElseIf oDataSet.Tables("TYPE_VOIE").Rows.Count > 1 Then

                        Dim frmListas As New frmLineas
                        objControl.limpia_Catalogos()
                        frmListas.Tag = 4

                        strLinea = strQuerys

                        frmListas.ShowDialog()
                        If Trim(strLinea1) <> "" Then

                            bl_varios_turnos = True

                            hr_fecha_ini_varios_turnos = CDate(strLinea1)
                            hr_fecha_fin_varios_turnos = CDate(strLinea2)
                            str_Voie_varios_turnos = Trim(strLinea3)



                        Else
                            Me.Close()
                            Exit Sub
                        End If

                    End If

                Else
                    MsgBox("No existen datos", MsgBoxStyle.Information, "Verificar")
                    bl_sin_liquidar = True
                    Me.Close()
                    Exit Sub
                End If

                'fin de verifico cuantos cortes tiene en ese turno


                '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Inicio
                'DATOS GENERALES

                strQuerys = "SELECT GEADBA.FIN_POSTE.ID_RESEAU, GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE_L2, GEADBA.FIN_POSTE.VOIE, TO_CHAR(GEADBA.FIN_POSTE.NUMERO_POSTE, 'FM09') AS Expr1, " &
            "TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'MM/DD/YY') AS Expr2, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'HH24:MI') AS Expr3, " &
            "GEADBA.FIN_POSTE.MATRICULE, GEADBA.FIN_POSTE.SAC AS Expr4, GEADBA.FIN_POSTE.ID_VOIE, " &
            "TO_CHAR(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE, 'YYYYMMDDHH24MISS') AS Expr5, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'YYYYMMDDHH24MISS') AS Expr6, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE, 0 AS Expr7, " &
            "FOLIO_NUMBER_OPEN, FOLIO_NUMBER_CLOSE, INITIAL_EVENT_NUMBER, FINAL_EVENT_NUMBER, FOLIO_ECT_NUMBER_INITIAL, FOLIO_ECT_NUMBER_FINAL, " &
            "FOLIO2_NUMBER_INITIAL,FOLIO2_NUMBER_FINAL,FOLIO3_NUMBER_INITIAL,FOLIO3_NUMBER_FINAL " &
            "FROM GEADBA.TYPE_VOIE, GEADBA.FIN_POSTE, GEADBA.SITE_GARE " &
            "WHERE GEADBA.TYPE_VOIE.ID_VOIE = GEADBA.FIN_POSTE.ID_VOIE AND GEADBA.FIN_POSTE.ID_RESEAU = GEADBA.SITE_GARE.ID_RESEAU AND " &
            "GEADBA.FIN_POSTE.ID_GARE = GEADBA.SITE_GARE.ID_GARE AND (GEADBA.SITE_GARE.ID_RESEAU = '01') AND (GEADBA.SITE_GARE.ID_SITE = '" & id_plaza_cobro_local & "') AND " &
            "(GEADBA.FIN_POSTE.ID_MODE_VOIE IN (1, 6, 7)) "


                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                End If

                If bl_varios_turnos = False Then

                    strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

                Else


                    '         strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(hr_fecha_ini_varios_turnos, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                    '"(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(hr_fecha_fin_varios_turnos, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

                    strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE = TO_DATE('" & Format(hr_fecha_ini_varios_turnos, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) and GEADBA.FIN_POSTE.VOIE = '" & str_Voie_varios_turnos & "' "


                End If

                '    strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_FIN_POSTE >= TO_DATE('" & Format(dt_Fecha_Inicio, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '"(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(dt_Fecha_Fin, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "
                strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.ID_VOIE = '1' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '2' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '3' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '4' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = 'X') " &
             "AND (GEADBA.FIN_POSTE.MATRICULE = '" & str_cajero & "') " &
             "ORDER BY GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.ID_VOIE, GEADBA.FIN_POSTE.VOIE, GEADBA.FIN_POSTE.DATE_FIN_POSTE, " &
             "GEADBA.FIN_POSTE.NUMERO_POSTE, GEADBA.FIN_POSTE.MATRICULE, Expr4"
                'AND (GEADBA.FIN_POSTE.NUMERO_POSTE = " & id_Turno & ")


                If objQuerys.QueryDataSet(strQuerys, "TYPE_VOIE") = 1 Then

                    For PosicionFilaActual = 0 To oDataSet.Tables("TYPE_VOIE").Rows.Count - 1



                        oDataRow = oDataSet.Tables("TYPE_VOIE").Rows(PosicionFilaActual)



                        Dim par3 As New ReportParameter()
                        par3.Name = "par3"
                        par3.Values.Add(str_delegacion)

                        Dim par8 As New ReportParameter()
                        par8.Name = "par8"
                        par8.Values.Add(oDataRow("VOIE"))

                        str_id_voie = oDataRow("VOIE")
                        loc_voie = oDataRow("VOIE")
                        int_id_voie = oDataRow("ID_VOIE")
                        int_numero_poste = CInt(oDataRow("Expr1"))


                        Dim par7 As New ReportParameter()
                        par7.Name = "par7"


                        If bl_varios_turnos = False Then
                            'par7.Values.Add(str_Turno_block)
                            par7.Values.Add(No_Turno)
                        Else

                            If CInt(Format(objControl.fecha(oDataRow("Expr5")), "HH")) >= 6 And CInt(Format(objControl.fecha(oDataRow("Expr5")), "HH")) < 14 Then
                                'par7.Values.Add(gl_turno_2)
                                par7.Values.Add(No_Turno)
                            ElseIf CInt(Format(objControl.fecha(oDataRow("Expr5")), "HH")) >= 14 And CInt(Format(objControl.fecha(oDataRow("Expr5")), "HH")) < 22 Then
                                par7.Values.Add(No_Turno)
                                'par7.Values.Add(gl_turno_3)
                            Else
                                par7.Values.Add(No_Turno)
                                'par7.Values.Add(gl_turno_1)
                            End If

                        End If

                        Dim par4 As New ReportParameter()
                        par4.Name = "par4"
                        'par4.Values.Add(Format(objControl.fecha(oDataRow("Expr5")), "MM/dd/yyyy HH:mm:ss"))
                        'par4.Values.Add(Format(objControl.fecha(oDataRow("Expr5")), "dd/MM/yyyy HH:mm:ss"))
                        par4.Values.Add(Format(objControl.fecha(oDataRow("Expr5")), "HH:mm:ss"))
                        dt_ini_poste = Format(objControl.fecha(oDataRow("Expr5")), "MM/dd/yyyy HH:mm:ss")

                        Dim par1 As New ReportParameter()
                        par1.Name = "par1"
                        'par1.Values.Add(Format(objControl.fecha(oDataRow("Expr5")), "MM/dd/yyyy"))
                        'dt_Fecha_Inicio
                        'par1.Values.Add(Format(dt_Fecha_Inicio, "MM/dd/yyyy"))
                        'Pruebad IMAXD
                        par1.Values.Add(Format(dt_Fecha_Inicio, "dd/MM/yyyy"))

                        '***********************Cambios Daniel(Prosis)************************************************
                        fechaOpeTemp = Format(dt_Fecha_Inicio, "yyyyMMdd")
                        '*********************************************************************************************

                        Dim par6 As New ReportParameter()
                        par6.Name = "par6"
                        'par6.Values.Add(Format(objControl.fecha(oDataRow("Expr6")), "MM/dd/yyyy HH:mm:ss"))
                        'par6.Values.Add(Format(objControl.fecha(oDataRow("Expr6")), "dd/MM/yyyy HH:mm:ss"))
                        par6.Values.Add(Format(objControl.fecha(oDataRow("Expr6")), "HH:mm:ss"))
                        dt_fin_poste = Format(objControl.fecha(oDataRow("Expr6")), "MM/dd/yyyy HH:mm:ss")

                        'folios
                        Dim par69 As New ReportParameter()
                        par69.Name = "par69"

                        Dim FOLIO_NUMBER_OPEN As Double
                        Dim FOLIO_NUMBER_CLOSE As Double


                        If Not Len(CStr(oDataRow("FOLIO_NUMBER_OPEN"))) = 10 Then
                            FOLIO_NUMBER_OPEN = oDataRow("FOLIO_NUMBER_OPEN")
                        Else
                            FOLIO_NUMBER_OPEN = Mid(CStr(oDataRow("FOLIO_NUMBER_OPEN")), 1, 9)
                        End If

                        If Not Len(CStr(oDataRow("FOLIO_NUMBER_CLOSE"))) = 10 Then
                            FOLIO_NUMBER_CLOSE = oDataRow("FOLIO_NUMBER_CLOSE")
                        Else
                            FOLIO_NUMBER_CLOSE = Mid(CStr(oDataRow("FOLIO_NUMBER_CLOSE")), 1, 9)
                        End If

                        'par69.Values.Add(Format(oDataRow("FOLIO_NUMBER_OPEN"), "###,###,###,##0"))
                        'If Not oDataRow("FOLIO_NUMBER_OPEN") > oDataRow("FOLIO_NUMBER_CLOSE") Then
                        '    par69.Values.Add(Format(oDataRow("FOLIO_NUMBER_OPEN"), "###,###,###,##0"))
                        'Else
                        '    par69.Values.Add(Format(oDataRow("FOLIO_NUMBER_CLOSE"), "###,###,###,##0"))
                        'End If

                        If Not FOLIO_NUMBER_OPEN > FOLIO_NUMBER_CLOSE Then
                            par69.Values.Add(Format(FOLIO_NUMBER_OPEN, "###,###,###,##0"))
                        Else
                            par69.Values.Add(Format(FOLIO_NUMBER_CLOSE, "###,###,###,##0"))
                        End If

                        Dim par70 As New ReportParameter()
                        par70.Name = "par70"
                        'par70.Values.Add(Format(oDataRow("FOLIO_NUMBER_CLOSE"), "###,###,###,##0"))
                        par70.Values.Add(Format(FOLIO_NUMBER_CLOSE, "###,###,###,##0"))

                        Dim par71 As New ReportParameter()
                        par71.Name = "par71"
                        'par71.Values.Add(Format(oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1, "###,###,###,##0"))
                        'If Not oDataRow("FOLIO_NUMBER_OPEN") > oDataRow("FOLIO_NUMBER_CLOSE") Then
                        '    If oDataRow("FOLIO_NUMBER_OPEN") = oDataRow("FOLIO_NUMBER_CLOSE") Then
                        '        par71.Values.Add(Format(0, "###,###,###,##0"))
                        '    Else
                        '        par71.Values.Add(Format(oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1, "###,###,###,##0"))
                        '    End If
                        'Else
                        '    par71.Values.Add(Format(oDataRow("FOLIO_NUMBER_CLOSE"), "###,###,###,##0"))
                        'End If

                        If Not FOLIO_NUMBER_OPEN > FOLIO_NUMBER_CLOSE Then
                            If FOLIO_NUMBER_OPEN = FOLIO_NUMBER_CLOSE Then
                                par71.Values.Add(Format(0, "###,###,###,##0"))
                            Else
                                par71.Values.Add(Format(FOLIO_NUMBER_CLOSE - FOLIO_NUMBER_OPEN + 1, "###,###,###,##0"))
                            End If
                        Else
                            If FOLIO_NUMBER_CLOSE = 0 Then
                                par71.Values.Add(Format(FOLIO_NUMBER_CLOSE, "###,###,###,##0"))
                            Else
                                par71.Values.Add(Format(FOLIO_NUMBER_CLOSE - FOLIO_NUMBER_CLOSE + 1, "###,###,###,##0"))
                            End If

                        End If

                        'Dim par73 As New ReportParameter()
                        'par73.Name = "par73"
                        'par73.Values.Add(Format(oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1, "###,###,###,##0"))
                        'If Not oDataRow("FOLIO_NUMBER_OPEN") > oDataRow("FOLIO_NUMBER_CLOSE") Then
                        '    If oDataRow("FOLIO_NUMBER_OPEN") = oDataRow("FOLIO_NUMBER_CLOSE") Then
                        '        'par73.Values.Add(Format(0, "###,###,###,##0"))
                        '        VAR_73 = 0
                        '    Else
                        '        'par73.Values.Add(Format(oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1, "###,###,###,##0"))
                        '        VAR_73 = oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1
                        '    End If
                        'Else
                        '    'par73.Values.Add(Format(oDataRow("FOLIO_NUMBER_CLOSE"), "###,###,###,##0"))
                        '    VAR_73 = oDataRow("FOLIO_NUMBER_CLOSE")
                        'End If

                        If Not FOLIO_NUMBER_OPEN > FOLIO_NUMBER_CLOSE Then
                            If FOLIO_NUMBER_OPEN = FOLIO_NUMBER_CLOSE Then
                                'par73.Values.Add(Format(0, "###,###,###,##0"))
                                VAR_73 = 0
                            Else
                                'par73.Values.Add(Format(oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1, "###,###,###,##0"))
                                VAR_73 = FOLIO_NUMBER_CLOSE - FOLIO_NUMBER_OPEN + 1
                            End If
                        Else
                            'par73.Values.Add(Format(oDataRow("FOLIO_NUMBER_CLOSE"), "###,###,###,##0"))

                            If FOLIO_NUMBER_CLOSE = 0 Then
                                VAR_73 = FOLIO_NUMBER_CLOSE
                            Else
                                VAR_73 = FOLIO_NUMBER_CLOSE - FOLIO_NUMBER_CLOSE + 1
                            End If

                        End If


                        'FOLIOS 2
                        Dim FOLIO2_NUMBER_OPEN As Double
                        Dim FOLIO2_NUMBER_CLOSE As Double

                        If Not Len(CStr(oDataRow("FOLIO2_NUMBER_INITIAL"))) = 10 Then
                            FOLIO2_NUMBER_OPEN = oDataRow("FOLIO2_NUMBER_INITIAL")
                        Else
                            FOLIO2_NUMBER_OPEN = Mid(CStr(oDataRow("FOLIO2_NUMBER_INITIAL")), 1, 9)
                        End If

                        If Not Len(CStr(oDataRow("FOLIO2_NUMBER_FINAL"))) = 10 Then
                            FOLIO2_NUMBER_CLOSE = oDataRow("FOLIO2_NUMBER_FINAL")
                        Else
                            FOLIO2_NUMBER_CLOSE = Mid(CStr(oDataRow("FOLIO2_NUMBER_FINAL")), 1, 9)
                        End If


                        Dim par74 As New ReportParameter()
                        par74.Name = "par74"
                        'par74.Values.Add(Format(oDataRow("FOLIO2_NUMBER_INITIAL"), "###,###,###,##0"))
                        par74.Values.Add(Format(FOLIO2_NUMBER_OPEN, "###,###,###,##0"))

                        Dim par75 As New ReportParameter()
                        par75.Name = "par75"
                        'par75.Values.Add(Format(oDataRow("FOLIO2_NUMBER_FINAL"), "###,###,###,##0"))
                        par75.Values.Add(Format(FOLIO2_NUMBER_CLOSE, "###,###,###,##0"))

                        Dim par76 As New ReportParameter()
                        par76.Name = "par76"
                        'If oDataRow("FOLIO2_NUMBER_INITIAL") = 0 And oDataRow("FOLIO2_NUMBER_FINAL") = 0 Then
                        If FOLIO2_NUMBER_OPEN = 0 And FOLIO2_NUMBER_CLOSE = 0 Then
                            par76.Values.Add(0)
                        Else
                            'par76.Values.Add(Format(oDataRow("FOLIO2_NUMBER_FINAL") - oDataRow("FOLIO2_NUMBER_INITIAL") + 1, "###,###,###,##0"))
                            par76.Values.Add(Format(FOLIO2_NUMBER_CLOSE - FOLIO2_NUMBER_OPEN + 1, "###,###,###,##0"))
                        End If


                        Dim par78 As New ReportParameter()
                        par78.Name = "par78"
                        'If oDataRow("FOLIO2_NUMBER_FINAL") = 0 And oDataRow("FOLIO2_NUMBER_FINAL") = 0 Then
                        If FOLIO2_NUMBER_OPEN = 0 And FOLIO2_NUMBER_CLOSE = 0 Then
                            par78.Values.Add(0)
                        Else
                            'par78.Values.Add(Format(oDataRow("FOLIO2_NUMBER_FINAL") - oDataRow("FOLIO2_NUMBER_INITIAL") + 1, "###,###,###,##0"))
                            par78.Values.Add(Format(FOLIO2_NUMBER_CLOSE - FOLIO2_NUMBER_OPEN + 1, "###,###,###,##0"))
                        End If



                        'FOLIOS 3
                        Dim FOLIO3_NUMBER_OPEN As Double
                        Dim FOLIO3_NUMBER_CLOSE As Double

                        If Not Len(CStr(oDataRow("FOLIO3_NUMBER_INITIAL"))) = 10 Then
                            FOLIO3_NUMBER_OPEN = oDataRow("FOLIO3_NUMBER_INITIAL")
                        Else
                            FOLIO3_NUMBER_OPEN = Mid(CStr(oDataRow("FOLIO3_NUMBER_INITIAL")), 1, 9)
                        End If

                        If Not Len(CStr(oDataRow("FOLIO3_NUMBER_FINAL"))) = 10 Then
                            FOLIO3_NUMBER_CLOSE = oDataRow("FOLIO3_NUMBER_FINAL")
                        Else
                            FOLIO3_NUMBER_CLOSE = Mid(CStr(oDataRow("FOLIO3_NUMBER_FINAL")), 1, 9)
                        End If



                        Dim par79 As New ReportParameter()
                        par79.Name = "par79"
                        'par79.Values.Add(Format(oDataRow("FOLIO3_NUMBER_INITIAL"), "###,###,###,##0"))
                        par79.Values.Add(Format(FOLIO3_NUMBER_OPEN, "###,###,###,##0"))

                        Dim par80 As New ReportParameter()
                        par80.Name = "par80"
                        'par80.Values.Add(Format(oDataRow("FOLIO3_NUMBER_FINAL"), "###,###,###,##0"))
                        par80.Values.Add(Format(FOLIO3_NUMBER_CLOSE, "###,###,###,##0"))

                        Dim par81 As New ReportParameter()
                        par81.Name = "par81"
                        'If oDataRow("FOLIO3_NUMBER_FINAL") = 0 And oDataRow("FOLIO3_NUMBER_FINAL") = 0 Then
                        If FOLIO3_NUMBER_CLOSE = 0 And FOLIO3_NUMBER_OPEN = 0 Then
                            par81.Values.Add(0)
                        Else
                            'par81.Values.Add(Format(oDataRow("FOLIO3_NUMBER_FINAL") - oDataRow("FOLIO3_NUMBER_INITIAL") + 1, "###,###,###,##0"))
                            par81.Values.Add(Format(FOLIO3_NUMBER_CLOSE - FOLIO3_NUMBER_OPEN + 1, "###,###,###,##0"))
                        End If


                        Dim par83 As New ReportParameter()
                        par83.Name = "par83"
                        'If oDataRow("FOLIO3_NUMBER_FINAL") = 0 And oDataRow("FOLIO3_NUMBER_FINAL") = 0 Then
                        If FOLIO3_NUMBER_CLOSE = 0 And FOLIO3_NUMBER_OPEN = 0 Then
                            par83.Values.Add(0)
                        Else
                            'par83.Values.Add(Format(oDataRow("FOLIO3_NUMBER_FINAL") - oDataRow("FOLIO3_NUMBER_INITIAL") + 1, "###,###,###,##0"))
                            par83.Values.Add(Format(FOLIO3_NUMBER_CLOSE - FOLIO3_NUMBER_OPEN + 1, "###,###,###,##0"))
                        End If

                        'VERIFICO SI EL CARRIL ES AUTOMATICO
                        bl_carril_automatico = False

                        'TLALPAN
                        If id_plaza_cobro_local = "08" Then

                            If str_id_voie = "A08" Or str_id_voie = "A09" Or str_id_voie = "B01" Then
                                bl_carril_automatico = True
                            End If
                        End If

                        'par74, par75, par76, par78, par79, par80,par81, par83
                        '---------------------------------
                        Dim par84 As New ReportParameter()
                        par84.Name = "par84"
                        'par84.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_INITIAL"), "###,###,###,##0"))


                        Dim par85 As New ReportParameter()
                        par85.Name = "par85"

                        Dim par86 As New ReportParameter()
                        par86.Name = "par86"

                        'Dim par87 As New ReportParameter()
                        'par87.Name = "par87"

                        'Dim par88 As New ReportParameter()
                        'par88.Name = "par88"


                        If oDataRow("FOLIO_ECT_NUMBER_INITIAL") < oDataRow("FOLIO_ECT_NUMBER_FINAL") Then


                            If bl_carril_automatico = False Then

                                par84.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_INITIAL"), "###,###,###,##0"))
                                par85.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_FINAL"), "###,###,###,##0"))
                                par86.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_FINAL") - oDataRow("FOLIO_ECT_NUMBER_INITIAL") + 1, "###,###,###,##0"))
                                'par87.Values.Add(Format(VAR_13, "###,###,###,##0"))
                                'par88.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_FINAL") - oDataRow("FOLIO_ECT_NUMBER_INITIAL") + 1, "###,###,###,##0"))
                                'par88.Values.Add(Format((oDataRow("FOLIO_ECT_NUMBER_FINAL") - oDataRow("FOLIO_ECT_NUMBER_INITIAL") + 1) - VAR_13, "###,###,###,##0"))
                                VAR_88 = oDataRow("FOLIO_ECT_NUMBER_FINAL") - oDataRow("FOLIO_ECT_NUMBER_INITIAL") + 1

                            Else

                                strQuerys = "select  MIN(FOLIO_ECT) AS FOLIO_ECT_NUMBER_INITIAL_C, MAX(FOLIO_ECT) AS FOLIO_ECT_NUMBER_FINAL_C FROM TRANSACTION WHERE ID_GARE = '" & oDataRow("ID_GARE") & "' AND ID_VOIE  = '" & oDataRow("ID_VOIE") & "'  AND VOIE  = '" & oDataRow("VOIE") & "' " &
"AND  DATE_DEBUT_POSTE = TO_DATE('" & oDataRow("Expr5") & "', 'YYYYMMDDHH24MISS') and FOLIO_ECT <> 0   "
                                '= TO_DATE('" & Format(oDataRow("Expr5"), "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')

                                If objQuerys.QueryDataSetDos(strQuerys, "TRANSACTION") = 1 Then


                                    If Not IsDBNull(oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C")) Then
                                        par84.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C"), "###,###,###,##0"))
                                        par85.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C"), "###,###,###,##0"))
                                        par86.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C") - oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C") + 1, "###,###,###,##0"))
                                        'par87.Values.Add(Format(VAR_13, "###,###,###,##0"))
                                        'par88.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C") - oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C") + 1, "###,###,###,##0"))
                                        'par88.Values.Add(Format((oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C") - oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C") + 1) - VAR_13, "###,###,###,##0"))
                                        VAR_88 = oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C") - oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C") + 1
                                    Else
                                        par84.Values.Add(Format(0, "###,###,###,##0"))
                                        par85.Values.Add(Format(0, "###,###,###,##0"))
                                        par86.Values.Add(Format(0, "###,###,###,##0"))
                                        'par88.Values.Add(Format(0, "###,###,###,##0"))
                                        VAR_88 = 0
                                    End If

                                End If


                            End If


                        Else

                            strQuerys = "select  MIN(FOLIO_ECT) AS FOLIO_ECT_NUMBER_INITIAL_C, MAX(FOLIO_ECT) AS FOLIO_ECT_NUMBER_FINAL_C FROM TRANSACTION WHERE ID_GARE = '" & oDataRow("ID_GARE") & "' AND ID_VOIE  = '" & oDataRow("ID_VOIE") & "'  AND VOIE  = '" & oDataRow("VOIE") & "' " &
        "AND  DATE_DEBUT_POSTE = TO_DATE('" & oDataRow("Expr5") & "', 'YYYYMMDDHH24MISS') and FOLIO_ECT <> 0   "
                            '= TO_DATE('" & Format(oDataRow("Expr5"), "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')

                            If objQuerys.QueryDataSetDos(strQuerys, "TRANSACTION") = 1 Then


                                If Not IsDBNull(oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C")) Then
                                    par84.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C"), "###,###,###,##0"))
                                    par85.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C"), "###,###,###,##0"))
                                    par86.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C") - oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C") + 1, "###,###,###,##0"))
                                    'par87.Values.Add(Format(VAR_13, "###,###,###,##0"))
                                    'par88.Values.Add(Format(oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C") - oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C") + 1, "###,###,###,##0"))
                                    'par88.Values.Add(Format((oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C") - oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C") + 1) - VAR_13, "###,###,###,##0"))
                                    VAR_88 = oDataRowDos("FOLIO_ECT_NUMBER_FINAL_C") - oDataRowDos("FOLIO_ECT_NUMBER_INITIAL_C") + 1
                                Else
                                    par84.Values.Add(Format(0, "###,###,###,##0"))
                                    par85.Values.Add(Format(0, "###,###,###,##0"))
                                    par86.Values.Add(Format(0, "###,###,###,##0"))
                                    'par88.Values.Add(Format(0, "###,###,###,##0"))
                                    VAR_88 = 0
                                End If

                            End If

                        End If

                        '-----------------------------------------------------------------------------
                        'Dim par89 As New ReportParameter()
                        'par89.Name = "par89"
                        'par89.Values.Add(Format(oDataRow("INITIAL_EVENT_NUMBER"), "###,###,###,##0"))

                        'Dim par90 As New ReportParameter()
                        'par90.Name = "par90"
                        'par90.Values.Add(Format(oDataRow("FINAL_EVENT_NUMBER"), "###,###,###,##0"))

                        'Dim par91 As New ReportParameter()
                        'par91.Name = "par91"
                        'par91.Values.Add(Format(oDataRow("FINAL_EVENT_NUMBER") - oDataRow("INITIAL_EVENT_NUMBER") + 1, "###,###,###,##0"))

                        'Dim par93 As New ReportParameter()
                        'par93.Name = "par93"
                        'par93.Values.Add(Format(oDataRow("FINAL_EVENT_NUMBER") - oDataRow("INITIAL_EVENT_NUMBER") + 1, "###,###,###,##0"))

                        Dim par89 As New ReportParameter()
                        par89.Name = "par89"

                        Dim par90 As New ReportParameter()
                        par90.Name = "par90"

                        Dim par91 As New ReportParameter()
                        par91.Name = "par91"

                        Dim par93 As New ReportParameter()
                        par93.Name = "par93"

                        If oDataRow("INITIAL_EVENT_NUMBER") < oDataRow("FINAL_EVENT_NUMBER") Then

                            If bl_carril_automatico = False Then

                                'par89.Values.Add(Format(oDataRow("INITIAL_EVENT_NUMBER"), "###,###,###,##0"))
                                'par90.Values.Add(Format(oDataRow("FINAL_EVENT_NUMBER"), "###,###,###,##0"))
                                'par91.Values.Add(Format(oDataRow("FINAL_EVENT_NUMBER") - oDataRow("INITIAL_EVENT_NUMBER") + 1, "###,###,###,##0"))
                                'par93.Values.Add(Format(oDataRow("FINAL_EVENT_NUMBER") - oDataRow("INITIAL_EVENT_NUMBER") + 1, "###,###,###,##0"))

                                strQuerys = "select  MIN(EVENT_NUMBER) AS INITIAL_EVENT_NUMBER_C, MAX(EVENT_NUMBER) AS FINAL_EVENT_NUMBER_C FROM TRANSACTION WHERE ID_GARE = '" & oDataRow("ID_GARE") & "' AND ID_VOIE  = '" & oDataRow("ID_VOIE") & "'  AND VOIE  = '" & oDataRow("VOIE") & "' " &
                                "AND  DATE_DEBUT_POSTE = TO_DATE('" & oDataRow("Expr5") & "', 'YYYYMMDDHH24MISS') AND EVENT_NUMBER <> 0 AND ID_OBS_PASSAGE <> '1' "
                                '= TO_DATE('" & Format(oDataRow("Expr5"), "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')

                                If objQuerys.QueryDataSetDos(strQuerys, "TRANSACTION") = 1 Then


                                    If Not IsDBNull(oDataRowDos("INITIAL_EVENT_NUMBER_C")) Then
                                        par89.Values.Add(Format(oDataRowDos("INITIAL_EVENT_NUMBER_C"), "###,###,###,##0"))
                                        par90.Values.Add(Format(oDataRowDos("FINAL_EVENT_NUMBER_C"), "###,###,###,##0"))
                                        par91.Values.Add(Format(oDataRowDos("FINAL_EVENT_NUMBER_C") - oDataRowDos("INITIAL_EVENT_NUMBER_C") + 1, "###,###,###,##0"))
                                        par93.Values.Add(Format(oDataRowDos("FINAL_EVENT_NUMBER_C") - oDataRowDos("INITIAL_EVENT_NUMBER_C") + 1, "###,###,###,##0"))
                                    Else
                                        par89.Values.Add(Format(0, "###,###,###,##0"))
                                        par90.Values.Add(Format(0, "###,###,###,##0"))
                                        par91.Values.Add(Format(0, "###,###,###,##0"))
                                        par93.Values.Add(Format(0, "###,###,###,##0"))
                                    End If

                                End If


                            Else

                                strQuerys = "select  MIN(EVENT_NUMBER) AS INITIAL_EVENT_NUMBER_C, MAX(EVENT_NUMBER) AS FINAL_EVENT_NUMBER_C FROM TRANSACTION WHERE ID_GARE = '" & oDataRow("ID_GARE") & "' AND ID_VOIE  = '" & oDataRow("ID_VOIE") & "'  AND VOIE  = '" & oDataRow("VOIE") & "' " &
                                "AND  DATE_DEBUT_POSTE = TO_DATE('" & oDataRow("Expr5") & "', 'YYYYMMDDHH24MISS') AND EVENT_NUMBER <> 0 AND ID_OBS_PASSAGE <> '1' "
                                '= TO_DATE('" & Format(oDataRow("Expr5"), "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')

                                If objQuerys.QueryDataSetDos(strQuerys, "TRANSACTION") = 1 Then


                                    If Not IsDBNull(oDataRowDos("INITIAL_EVENT_NUMBER_C")) Then
                                        par89.Values.Add(Format(oDataRowDos("INITIAL_EVENT_NUMBER_C"), "###,###,###,##0"))
                                        par90.Values.Add(Format(oDataRowDos("FINAL_EVENT_NUMBER_C"), "###,###,###,##0"))
                                        par91.Values.Add(Format(oDataRowDos("FINAL_EVENT_NUMBER_C") - oDataRowDos("INITIAL_EVENT_NUMBER_C") + 1, "###,###,###,##0"))
                                        par93.Values.Add(Format(oDataRowDos("FINAL_EVENT_NUMBER_C") - oDataRowDos("INITIAL_EVENT_NUMBER_C") + 1, "###,###,###,##0"))
                                    Else
                                        par89.Values.Add(Format(0, "###,###,###,##0"))
                                        par90.Values.Add(Format(0, "###,###,###,##0"))
                                        par91.Values.Add(Format(0, "###,###,###,##0"))
                                        par93.Values.Add(Format(0, "###,###,###,##0"))
                                    End If

                                End If

                            End If


                        Else

                            strQuerys = "select  MIN(EVENT_NUMBER) AS INITIAL_EVENT_NUMBER_C, MAX(EVENT_NUMBER) AS FINAL_EVENT_NUMBER_C FROM TRANSACTION WHERE ID_GARE = '" & oDataRow("ID_GARE") & "' AND ID_VOIE  = '" & oDataRow("ID_VOIE") & "'  AND VOIE  = '" & oDataRow("VOIE") & "' " &
                                "AND  DATE_DEBUT_POSTE = TO_DATE('" & oDataRow("Expr5") & "', 'YYYYMMDDHH24MISS') AND EVENT_NUMBER <> 0 AND ID_OBS_PASSAGE <> '1' "
                            '= TO_DATE('" & Format(oDataRow("Expr5"), "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')

                            If objQuerys.QueryDataSetDos(strQuerys, "TRANSACTION") = 1 Then


                                If Not IsDBNull(oDataRowDos("INITIAL_EVENT_NUMBER_C")) Then
                                    par89.Values.Add(Format(oDataRowDos("INITIAL_EVENT_NUMBER_C"), "###,###,###,##0"))
                                    par90.Values.Add(Format(oDataRowDos("FINAL_EVENT_NUMBER_C"), "###,###,###,##0"))
                                    par91.Values.Add(Format(oDataRowDos("FINAL_EVENT_NUMBER_C") - oDataRowDos("INITIAL_EVENT_NUMBER_C") + 1, "###,###,###,##0"))
                                    par93.Values.Add(Format(oDataRowDos("FINAL_EVENT_NUMBER_C") - oDataRowDos("INITIAL_EVENT_NUMBER_C") + 1, "###,###,###,##0"))
                                Else
                                    par89.Values.Add(Format(0, "###,###,###,##0"))
                                    par90.Values.Add(Format(0, "###,###,###,##0"))
                                    par91.Values.Add(Format(0, "###,###,###,##0"))
                                    par93.Values.Add(Format(0, "###,###,###,##0"))
                                End If

                            End If
                        End If




                        Dim parTituloReporte As New ReportParameter()
                        parTituloReporte.Name = "parTituloReporte"
                        parTituloReporte.Values.Add("PRELIQUIDACIÓN DE CAJERO-RECEPTOR")


                        Dim parametersTitulos() As ReportParameter = {par3, par8, par7, par4, par1, par6, par69, par70, par71, par74, par75, par76, par78, par79, par80, par81, par83, par84, par85, par86, par89, par90, par91, par93, parTituloReporte}
                        ReportViewer1.LocalReport.SetParameters(parametersTitulos)

                    Next


                Else
                    ' rpt_reporte = Nothing
                    ReportViewer1 = Nothing
                    MsgBox("No existen datos", MsgBoxStyle.Exclamation, "PRELIQUIDACION DE CAJERO RECEPTOR")
                    Me.Close()
                    Exit Sub
                End If

                'OPERADOR
                strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
             "FROM TABLE_PERSONNEL " &
             "WHERE Matricule = '" & oDataRow("MATRICULE") & "'"
                If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                    Dim par97 As New ReportParameter()
                    par97.Name = "par97"
                    'par97.Values.Add(Trim(oDataRowTres("MATRICULE")) & "     " & Trim(oDataRowTres("nombre")))
                    'str_detalle = str_detalle & objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", oDataRow("Matricule")) & ","
                    par97.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", oDataRowTres("Matricule"))) & "     " & Trim(oDataRowTres("nombre")))


                    str_MATRICULE = Trim(oDataRowTres("MATRICULE"))

                    Dim parametersTitulos_2() As ReportParameter = {par97}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_2)

                End If

                'encargado de turno

                strQuerys = "SELECT	LANE_ASSIGN.Id_plaza,LANE_ASSIGN.Id_lane,TO_CHAR(LANE_ASSIGN.MSG_DHM,'MM/DD/YY HH24:MI:SS'),LANE_ASSIGN.SHIFT_NUMBER,LANE_ASSIGN.OPERATION_ID, " &
    "LANE_ASSIGN.DELEGATION, TO_CHAR(LANE_ASSIGN.ASSIGN_DHM,'MM/DD/YY'),LTRIM(TO_CHAR(LANE_ASSIGN.JOB_NUMBER,'09')),	LANE_ASSIGN.STAFF_NUMBER,LANE_ASSIGN.IN_CHARGE_SHIFT_NUMBER " &
    "FROM 	LANE_ASSIGN, SITE_GARE " &
    "WHERE	LANE_ASSIGN.id_NETWORK = SITE_GARE.id_Reseau " &
    "AND LANE_ASSIGN.id_plaza = SITE_GARE.id_Gare " &
    "AND SITE_GARE.id_reseau = '01' " &
    "AND	SITE_GARE.id_Site ='" & id_plaza_cobro_local & "' " &
    "AND LANE_ASSIGN.Id_lane = '" & Trim(oDataRow("Voie")) & "' "
                '"AND ((MSG_DHM >= TO_DATE('" & Format(oDataRow("DATE_DEBUT_POSTE"), "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) AND (MSG_DHM <= TO_DATE('" & Format(oDataRow("DATE_DEBUT_POSTE"), "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS'))) " & _

                If bl_varios_turnos = False Then
                    strQuerys = strQuerys & "AND (MSG_DHM >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(MSG_DHM <= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

                Else

                    strQuerys = strQuerys & "AND (MSG_DHM >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(MSG_DHM <= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

                End If

                strQuerys = strQuerys & "ORDER BY LANE_ASSIGN.Id_PLAZA, LANE_ASSIGN.Id_LANE, LANE_ASSIGN.MSG_DHM"

                If objQuerys.QueryDataSetTres(strQuerys, "Asig_Carril") = 1 Then

                    'str_detalle = str_detalle & oDataRowtres("OPERATION_ID") & ","

                    'str_encargado = oDataRowTres("IN_CHARGE_SHIFT_NUMBER")
                    strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
                    "FROM TABLE_PERSONNEL " &
                    "WHERE Matricule = '" & oDataRowTres("IN_CHARGE_SHIFT_NUMBER") & "'"


                    If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                        'Dim par98 As New ReportParameter()
                        'par98.Name = "par98"

                        'par98.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", oDataRowTres("Matricule"))) & "     " & Trim(oDataRowTres("nombre")))

                        'Dim parametersTitulos_encargado() As ReportParameter = {par98}
                        'ReportViewer1.LocalReport.SetParameters(parametersTitulos_encargado)

                    End If

                End If
                'fin encargado de turno

                'Jorge
                Dim par98 As New ReportParameter()
                par98.Name = "par98"

                'Dim x As String = oDataRowTres("Matricule")
                Dim y As String = oDataRowTres("nombre")

                par98.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", oDataRowTres("Matricule"))) & "     " & Trim(oDataRowTres("nombre")))
                'par98.Values.Add(srt_Encargado_Reporte) 'Jorge
                'par98.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", int_Encargado_Reporte.ToString())) & "     " & srt_Encargado_Reporte)

                ''***** JORGE - Comentario linea uno (1)
                'Dim parLineaUno As New ReportParameter()
                'parLineaUno.Name = "parLineaUno"
                'parLineaUno.Values.Add(PrimeraLinea)

                'Dim parLineaDos As New ReportParameter()
                'parLineaDos.Name = "parLineaDos"
                'parLineaDos.Values.Add(SegundaLinea)

                'Dim parLineaTres As New ReportParameter()
                'parLineaTres.Name = "parLineaTres"
                'parLineaTres.Values.Add(TerceraLinea)

                Dim parametersTitulos_encargado() As ReportParameter = {par98}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_encargado)

                '*****

                'no empleado  admon general
                '   str_detalle = str_detalle & objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", "encargado_plaza") & ","

                strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
                "FROM TABLE_PERSONNEL " &
                "WHERE Matricule = '" & objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", "encargado_plaza") & "'"


                If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                    Dim par99 As New ReportParameter()
                    par99.Name = "par99"

                    par99.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", oDataRowTres("Matricule"))) & "     " & Trim(oDataRowTres("nombre")))

                    Dim parametersTitulos_admon() As ReportParameter = {par99}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_admon)

                End If

                'fin no empleado  admon general


                strQuerys = "SELECT  ID_RESEAU, ID_GARE, NOM_GARE, NOM_GARE_L2 " &
             "FROM GEADBA.TYPE_GARE " &
             "WHERE ID_GARE = " & oDataRow("ID_GARE") & ""

                If objQuerys.QueryDataSetTres(strQuerys, "TYPE_GARE") = 1 Then

                    Dim par5 As New ReportParameter()
                    par5.Name = "par5"

                    If id_plaza_cobro_local <> "08" Then

                        If id_plaza_cobro_local <> "09" Then
                            par5.Values.Add("1" & id_plaza_cobro_local & " " & oDataRowTres("NOM_GARE"))

                        Else
                            par5.Values.Add("001 BIS" & " " & oDataRowTres("NOM_GARE"))

                        End If

                    Else
                        par5.Values.Add("001" & " " & oDataRowTres("NOM_GARE"))
                    End If


                    int_id_gare = oDataRowTres("ID_GARE")

                    str_id_RESEAU = oDataRowTres("ID_RESEAU")

                    Dim parametersTitulos_3() As ReportParameter = {par5}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_3)

                End If


                'pantalla:RESUMEN DE INGRESO CAJERO
                strQuerys = "SELECT MATRICULE,SAC AS Expr1, NVL(NB_POSTE, 0) + NVL(NB_POSTE_POS, 0) AS Expr2, NVL(RED_RCT_MONNAIE1, 0) AS Expr3, " &
                            "NVL(RED_RCT_CHQ, 0) AS Expr4, NVL(RED_NB_CHQ, 0) AS Expr5, NVL(RED_RCT_DEVISE, 0) AS Expr6, NVL(RED_RCT_MONNAIE3, 0) AS Expr7, " &
                            "NVL(RED_RCT_MONNAIE4, 0) AS Expr8, NVL(RED_CPT1, 0) AS Expr9, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) + NVL(RED_RCT_MONNAIE3, 0) " &
                            "+ NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_CHQ, 0) + NVL(RED_RCT_DEVISE, 0) AS Expr10, NVL(POSTE_RCT_MONNAIE1, 0) + NVL(POSTE_RCT_MONNAIE2, 0) " &
                            "+ NVL(POSTE_RCT_MONNAIE3, 0) + NVL(POSTE_RCT_MONNAIE4, 0) + NVL(POSTE_RCT_DEVISE, 0) + NVL(POSTE_RCT_CHQ, 0) + NVL(POSTE_POS_RCT_MONNAIE1, " &
                            "0) + NVL(POSTE_POS_RMB_MONNAIE1, 0) + NVL(POSTE_POS_RCT_MONNAIE2, 0) + NVL(POSTE_POS_RCT_MONNAIE3, 0) + NVL(POSTE_POS_RCT_MONNAIE4, 0) " &
                            "+ NVL(POSTE_POS_RCT_DEVISE, 0) + NVL(POSTE_POS_RCT_CHQ, 0) AS Expr11, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) " &
                            "+ NVL(RED_RCT_MONNAIE3, 0) + NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_DEVISE, 0) + NVL(RED_RCT_CHQ, 0) - NVL(POSTE_RCT_MONNAIE1, 0) " &
                            "- NVL(POSTE_RCT_MONNAIE2, 0) - NVL(POSTE_RCT_MONNAIE3, 0) - NVL(POSTE_RCT_MONNAIE4, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_RCT_CHQ, 0) " &
                            "- NVL(POSTE_POS_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE2, 0) - NVL(POSTE_POS_RCT_MONNAIE3, 0) " &
                            "- NVL(POSTE_POS_RCT_MONNAIE4, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr12, NVL(RED_RCT_MONNAIE1, 0) " &
                            "- NVL(POSTE_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE1, 0) AS Expr13, NVL(RED_RCT_CHQ, 0) " &
                            "- NVL(POSTE_RCT_CHQ, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr14, NVL(RED_RCT_DEVISE, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) " &
                            "AS Expr15, NVL(RED_CPT24, 0) AS Expr16, NVL(RED_CPT25, 0) AS Expr17, NVL(RED_JETON, 0) - NVL(POSTE_JETON, 0) AS Expr18, NVL(RED_RDD, 0) " &
                            "- NVL(POSTE_RDD, 0) AS Expr19, NVL(RED_GRATUIT, 0) + NVL(RED_CPT2, 0) - NVL(POSTE_GRATUIT, 0) AS Expr20, MATRICULE_COMMENTAIRE, COMMENTAIRE, " &
                            "0 AS Expr21, TO_CHAR(DATE_REDDITION, 'YYYYMMDDHH24MISS') AS Expr22, ID_SITE, RED_CPT21, NB_POSTE, ETAT_REDDITION, " &
                            "NVL(Red_Rct_Monnaie1,0)	+ NVL(Red_Rct_Devise,0)	+ NVL(Red_Rct_Chq,0) + NVL(Red_cpt21,0)	- NVL(Poste_Rct_Monnaie1,0) - NVL(Poste_Rct_Devise,0) - NVL(Poste_Rct_Chq,0) AS Expr23, RED_CPT22  " &
                            "FROM REDDITION " &
                            "WHERE  (ID_SITE = '" & id_plaza_cobro_local & "') AND (MATRICULE = '" & oDataRow("MATRICULE") & "') AND (SAC = '" & oDataRow("Expr4") & "')"
                '(DATE_REDDITION = TO_DATE('20130206071615', 'YYYYMMDDHH24MISS')) AND 'no se obtiene

                If objQuerys.QueryDataSetDos(strQuerys, "REDDITION") = 1 Then


                    VAR_11 = oDataRowDos("Expr3")
                    VAR_50 = oDataRowDos("Expr6")

                    If Not IsDBNull(oDataRowDos("RED_CPT21")) Then
                        VAR_63 = oDataRowDos("RED_CPT21")
                    End If


                    If Not IsDBNull(oDataRowDos("RED_CPT22")) Then
                        VAR_13 = oDataRowDos("RED_CPT22")
                    End If


                    If oDataRowDos("Expr23") > 0 Then

                        VAR_67 = oDataRowDos("Expr23")
                        VAR_65 = 0

                    ElseIf oDataRowDos("Expr23") = 0 Then

                        VAR_67 = 0
                        VAR_65 = 0

                    ElseIf oDataRowDos("Expr23") < 0 Then

                        VAR_65 = oDataRowDos("Expr23")
                        VAR_67 = 0

                    End If
                    '2014_06_10
                    'If VAR_67 > 0 Then
                    '    VAR_67 = 0
                    'End If

                    Dim par9 As New ReportParameter()
                    par9.Name = "par9"
                    'par9.Values.Add(Format(objControl.fecha(oDataRowDos("Expr22")), "MM/dd/yyyy"))
                    par9.Values.Add(Format(objControl.fecha(oDataRowDos("Expr22")), "dd/MM/yyyy"))
                    'par9.Values.Add(Format(dt_Fecha_Inicio, "MM/dd/yyyy"))

                    Dim par10 As New ReportParameter()
                    par10.Name = "par10"
                    par10.Values.Add(Format(objControl.fecha(oDataRowDos("Expr22")), "HH:mm:ss"))

                    Dim par2 As New ReportParameter()
                    par2.Name = "par2"
                    par2.Values.Add(oDataRowDos("Expr1"))
                    '2013/10/01
                    ''2014/06/10
                    'Dim par63 As New ReportParameter()
                    'par63.Name = "par63"
                    'par63.Values.Add(Format(VAR_63, "###,###,##0.00"))

                    'Dim par65 As New ReportParameter()
                    'par65.Name = "par65"
                    'par65.Values.Add(Format(VAR_65, "###,###,##0.00"))

                    'Dim par67 As New ReportParameter()
                    'par67.Name = "par67"
                    'par67.Values.Add(Format(VAR_67, "###,###,##0.00"))

                    Dim par94 As New ReportParameter()
                    par94.Name = "par94"
                    par94.Values.Add(Format(CDec(VAR_11 + VAR_63), "###,###,##0.00"))



                    'COMENTARIO
                    Dim par96 As New ReportParameter()
                    par96.Name = "par96"

                    If Not IsDBNull(oDataRowDos("COMMENTAIRE")) Then
                        par96.Values.Add(Format(oDataRowDos("COMMENTAIRE")))
                    End If



                    'Dim parametersTitulos_4() As ReportParameter = {par9, par10, par2, par63, par94}
                    Dim parametersTitulos_4() As ReportParameter = {par9, par10, par2, par94, par96}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_4)

                    'Dim parametersTitulos_5() As ReportParameter = {par65, par67}
                    'ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)







                End If

                'turno carril
            ElseIf int_reporte = 2 Then
                ReportViewer1.LocalReport.DataSources.Clear()
                ReportViewer1.LocalReport.ReportEmbeddedResource = "rptPreliquidacion_Cajero_Receptor_Transito_Vehicular_2.rdlc"

                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "5 MATUTINO"
                    id_Turno = 2
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "6 VESPERTINO"
                    id_Turno = 3

                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "4 NOCTURNO"
                    id_Turno = 1
                End If


                'titulos

                Dim par3 As New ReportParameter()
                par3.Name = "par3"
                par3.Values.Add(str_delegacion)

                Dim par5 As New ReportParameter()
                'par5.Name = "par5"
                'par5.Values.Add(str_Plaza_Cobro)

                strQuerys = "SELECT ID_SITE, NOM_SITE, NOM_SITE_L2 FROM TYPE_SITE where ID_SITE = '" & Trim(id_plaza_cobro_local) & "'"

                If objQuerys.QueryDataSetTres(strQuerys, "TYPE_SITE") = 1 Then

                    par5.Name = "par5"

                    If id_plaza_cobro_local <> "08" Then

                        If id_plaza_cobro_local <> "09" Then
                            par5.Values.Add("1" & id_plaza_cobro_local & " " & oDataRowTres("NOM_SITE"))

                        Else
                            par5.Values.Add("001 BIS" & " " & oDataRowTres("NOM_SITE"))
                        End If

                    Else
                        par5.Values.Add("001" & " " & oDataRowTres("NOM_SITE"))
                    End If


                End If



                Dim par4 As New ReportParameter()
                par4.Name = "par4"
                'par4.Values.Add(str_Turno_block)
                'No_Turno
                par4.Values.Add(No_Turno)

                Dim par1 As New ReportParameter()
                par1.Name = "par1"
                If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    If Me.Tag <> 7 Then
                        '***********************Cambios Daniel(Prosis)************************************************
                        fechaOpeTemp = Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "yyyyMMdd")
                        '*********************************************************************************************
                    End If
                    par1.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "MM/dd/yyyy"))
                Else
                    par1.Values.Add(Format(dt_ini_poste, "MM/dd/yyyy"))
                End If

                Dim par7 As New ReportParameter()
                par7.Name = "par7"
                par7.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim par9 As New ReportParameter()
                par9.Name = "par9"
                par9.Values.Add(Format(Now, "HH:mm:ss"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("PRELIQUIDACIÓN DE TURNO/CARRILES")

                Dim parameters() As ReportParameter = {par3, par5, par4, par1, par7, par9, parTituloReporte}
                ReportViewer1.LocalReport.SetParameters(parameters)
                'fin titulos

                'SACO LOS TURNOS

                strQuerys = "SELECT GEADBA.FIN_POSTE.ID_RESEAU, GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE_L2, GEADBA.FIN_POSTE.VOIE, TO_CHAR(GEADBA.FIN_POSTE.NUMERO_POSTE, 'FM09') AS Expr1, " &
          "TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'MM/DD/YY') AS Expr2, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'HH24:MI') AS Expr3, " &
          "GEADBA.FIN_POSTE.MATRICULE, GEADBA.FIN_POSTE.SAC AS Expr4, GEADBA.FIN_POSTE.ID_VOIE, " &
          "TO_CHAR(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE, 'YYYYMMDDHH24MISS') AS Expr5, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'YYYYMMDDHH24MISS') AS Expr6, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE, 0 AS Expr7, " &
          "FOLIO_NUMBER_OPEN, FOLIO_NUMBER_CLOSE, INITIAL_EVENT_NUMBER, FINAL_EVENT_NUMBER, " &
          "FOLIO2_NUMBER_INITIAL, FOLIO2_NUMBER_FINAL, FOLIO3_NUMBER_INITIAL, FOLIO3_NUMBER_FINAL " &
          "FROM GEADBA.TYPE_VOIE, GEADBA.FIN_POSTE, GEADBA.SITE_GARE " &
          "WHERE GEADBA.TYPE_VOIE.ID_VOIE = GEADBA.FIN_POSTE.ID_VOIE AND GEADBA.FIN_POSTE.ID_RESEAU = GEADBA.SITE_GARE.ID_RESEAU AND " &
          "GEADBA.FIN_POSTE.ID_GARE = GEADBA.SITE_GARE.ID_GARE AND (GEADBA.SITE_GARE.ID_RESEAU = '01') AND (GEADBA.SITE_GARE.ID_SITE = '" & id_plaza_cobro_local & "') AND " &
          "(GEADBA.FIN_POSTE.ID_MODE_VOIE IN (1, 6, 7)) "


                'If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                '    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                '    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                'ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                '    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                '    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                'ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                '    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                '    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                '    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                '    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                'End If

                strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "



                '    strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_FIN_POSTE >= TO_DATE('" & Format(dt_Fecha_Inicio, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '"(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(dt_Fecha_Fin, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "
                strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.ID_VOIE = '1' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '2' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '3' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '4' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = 'X') " &
             "ORDER BY GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.ID_VOIE, GEADBA.FIN_POSTE.VOIE, GEADBA.FIN_POSTE.DATE_FIN_POSTE, " &
             "GEADBA.FIN_POSTE.NUMERO_POSTE, GEADBA.FIN_POSTE.MATRICULE, Expr4"
                'AND (GEADBA.FIN_POSTE.NUMERO_POSTE = " & id_Turno & ")

                If objQuerys.QueryDataSet(strQuerys, "TYPE_VOIE") = 1 Then


                    For cont = 0 To oDataSet.Tables("TYPE_VOIE").Rows.Count - 1

                        oDataRow = oDataSet.Tables("TYPE_VOIE").Rows.Item(cont)


                        'SACO LOS TOTALES
                        strQuerys = "SELECT MATRICULE,SAC AS Expr1, NVL(NB_POSTE, 0) + NVL(NB_POSTE_POS, 0) AS Expr2, NVL(RED_RCT_MONNAIE1, 0) AS Expr3, " &
                          "NVL(RED_RCT_CHQ, 0) AS Expr4, NVL(RED_NB_CHQ, 0) AS Expr5, NVL(RED_RCT_DEVISE, 0) AS Expr6, NVL(RED_RCT_MONNAIE3, 0) AS Expr7, " &
                          "NVL(RED_RCT_MONNAIE4, 0) AS Expr8, NVL(RED_CPT1, 0) AS Expr9, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) + NVL(RED_RCT_MONNAIE3, 0) " &
                          "+ NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_CHQ, 0) + NVL(RED_RCT_DEVISE, 0) AS Expr10, NVL(POSTE_RCT_MONNAIE1, 0) + NVL(POSTE_RCT_MONNAIE2, 0) " &
                          "+ NVL(POSTE_RCT_MONNAIE3, 0) + NVL(POSTE_RCT_MONNAIE4, 0) + NVL(POSTE_RCT_DEVISE, 0) + NVL(POSTE_RCT_CHQ, 0) + NVL(POSTE_POS_RCT_MONNAIE1, " &
                          "0) + NVL(POSTE_POS_RMB_MONNAIE1, 0) + NVL(POSTE_POS_RCT_MONNAIE2, 0) + NVL(POSTE_POS_RCT_MONNAIE3, 0) + NVL(POSTE_POS_RCT_MONNAIE4, 0) " &
                          "+ NVL(POSTE_POS_RCT_DEVISE, 0) + NVL(POSTE_POS_RCT_CHQ, 0) AS Expr11, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) " &
                          "+ NVL(RED_RCT_MONNAIE3, 0) + NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_DEVISE, 0) + NVL(RED_RCT_CHQ, 0) - NVL(POSTE_RCT_MONNAIE1, 0) " &
                          "- NVL(POSTE_RCT_MONNAIE2, 0) - NVL(POSTE_RCT_MONNAIE3, 0) - NVL(POSTE_RCT_MONNAIE4, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_RCT_CHQ, 0) " &
                          "- NVL(POSTE_POS_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE2, 0) - NVL(POSTE_POS_RCT_MONNAIE3, 0) " &
                          "- NVL(POSTE_POS_RCT_MONNAIE4, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr12, NVL(RED_RCT_MONNAIE1, 0) " &
                          "- NVL(POSTE_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE1, 0) AS Expr13, NVL(RED_RCT_CHQ, 0) " &
                          "- NVL(POSTE_RCT_CHQ, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr14, NVL(RED_RCT_DEVISE, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) " &
                          "AS Expr15, NVL(RED_CPT24, 0) AS Expr16, NVL(RED_CPT25, 0) AS Expr17, NVL(RED_JETON, 0) - NVL(POSTE_JETON, 0) AS Expr18, NVL(RED_RDD, 0) " &
                          "- NVL(POSTE_RDD, 0) AS Expr19, NVL(RED_GRATUIT, 0) + NVL(RED_CPT2, 0) - NVL(POSTE_GRATUIT, 0) AS Expr20, MATRICULE_COMMENTAIRE, COMMENTAIRE, " &
                          "0 AS Expr21, TO_CHAR(DATE_REDDITION, 'YYYYMMDDHH24MISS') AS Expr22, ID_SITE, RED_CPT21, " &
                          "NVL(Red_Rct_Monnaie1,0)	+ NVL(Red_Rct_Devise,0)	+ NVL(Red_Rct_Chq,0) + NVL(Red_cpt21,0)	- NVL(Poste_Rct_Monnaie1,0) - NVL(Poste_Rct_Devise,0) - NVL(Poste_Rct_Chq,0) AS Expr23, RED_CPT22 " &
                          "FROM REDDITION " &
                          "WHERE  (ID_SITE = '" & id_plaza_cobro_local & "') AND (MATRICULE = '" & oDataRow("MATRICULE") & "') AND (SAC = '" & oDataRow("Expr4") & "')"
                        '(DATE_REDDITION = TO_DATE('20130206071615', 'YYYYMMDDHH24MISS')) AND 'no se obtiene

                        If objQuerys.QueryDataSetDos(strQuerys, "REDDITION") = 1 Then

                            VAR_11 = VAR_11 + oDataRowDos("Expr3")
                            VAR_50 = VAR_50 + oDataRowDos("Expr6")

                            'Dim par63 As New ReportParameter()
                            'par63.Name = "par63"
                            'par63.Values.Add(Format(CDec(oDataRowDos("Expr10")), "###,###,##0.00"))
                            If Not IsDBNull(oDataRowDos("RED_CPT21")) Then
                                db_acom_63 = db_acom_63 + oDataRowDos("RED_CPT21")
                            End If

                            If Not IsDBNull(oDataRowDos("RED_CPT22")) Then
                                VAR_13 = VAR_13 + oDataRowDos("RED_CPT22")
                            End If


                            If oDataRowDos("Expr23") > 0 Then

                                db_acom_67 = db_acom_67 + oDataRowDos("Expr23")
                                db_acom_65 = db_acom_65 + 0

                            ElseIf oDataRowDos("Expr23") = 0 Then

                                db_acom_67 = db_acom_67 + 0
                                db_acom_65 = db_acom_65 + 0

                            ElseIf oDataRowDos("Expr23") < 0 Then

                                db_acom_65 = db_acom_65 + oDataRowDos("Expr23")
                                db_acom_67 = db_acom_67 + 0

                            End If

                            db_acom_94 = db_acom_94 + (VAR_11 + VAR_50) 'oDataRowDos("Expr10")

                            'folios
                            'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - (oDataRow("FOLIO_NUMBER_OPEN") + 1))
                            'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1)
                            '*************************
                            'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1)
                            Dim FOLIO_NUMBER_OPEN As Double
                            Dim FOLIO_NUMBER_CLOSE As Double

                            If Not Len(CStr(oDataRow("FOLIO_NUMBER_OPEN"))) = 10 Then
                                FOLIO_NUMBER_OPEN = oDataRow("FOLIO_NUMBER_OPEN")
                            Else
                                FOLIO_NUMBER_OPEN = Mid(CStr(oDataRow("FOLIO_NUMBER_OPEN")), 1, 9)
                            End If

                            If Not Len(CStr(oDataRow("FOLIO_NUMBER_CLOSE"))) = 10 Then
                                FOLIO_NUMBER_CLOSE = oDataRow("FOLIO_NUMBER_CLOSE")
                            Else
                                FOLIO_NUMBER_CLOSE = Mid(CStr(oDataRow("FOLIO_NUMBER_CLOSE")), 1, 9)
                            End If

                            If FOLIO_NUMBER_CLOSE = 0 Or FOLIO_NUMBER_OPEN = 0 Then
                                db_acom_folios = db_acom_folios
                            Else
                                If FOLIO_NUMBER_CLOSE <= FOLIO_NUMBER_OPEN Then
                                    db_acom_folios = db_acom_folios + 1
                                Else
                                    db_acom_folios = db_acom_folios + (FOLIO_NUMBER_CLOSE - FOLIO_NUMBER_OPEN + 1)
                                End If
                            End If

                            '*************************

                            If oDataRow("FOLIO2_NUMBER_FINAL") = 0 And oDataRow("FOLIO2_NUMBER_FINAL") = 0 Then
                            Else
                                db_acom_folios2 = db_acom_folios2 + oDataRow("FOLIO2_NUMBER_FINAL") - oDataRow("FOLIO2_NUMBER_INITIAL") + 1
                            End If
                            If oDataRow("FOLIO3_NUMBER_FINAL") = 0 And oDataRow("FOLIO3_NUMBER_FINAL") = 0 Then

                            Else
                                db_acom_folios3 = db_acom_folios3 + oDataRow("FOLIO3_NUMBER_FINAL") - oDataRow("FOLIO3_NUMBER_INITIAL") + 1
                            End If


                            'eventos
                            '*************
                            'db_acom_eventos = db_acom_eventos + (oDataRow("FINAL_EVENT_NUMBER") - oDataRow("INITIAL_EVENT_NUMBER") + 1)

                            strQuerys = "select  MIN(EVENT_NUMBER) AS INITIAL_EVENT_NUMBER_C, MAX(EVENT_NUMBER) AS FINAL_EVENT_NUMBER_C FROM TRANSACTION WHERE ID_GARE = '" & oDataRow("ID_GARE") & "' AND ID_VOIE  = '" & oDataRow("ID_VOIE") & "'  AND VOIE  = '" & oDataRow("VOIE") & "' " &
                            "AND  DATE_DEBUT_POSTE = TO_DATE('" & oDataRow("Expr5") & "', 'YYYYMMDDHH24MISS') AND EVENT_NUMBER <> 0 AND ID_OBS_PASSAGE <> '1' "

                            If objQuerys.QueryDataSetSeis(strQuerys, "TRANSACTION") = 1 Then
                                If Not IsDBNull(oDataRowSeis("INITIAL_EVENT_NUMBER_C")) Then
                                    db_acom_eventos = db_acom_eventos + (oDataRowSeis("FINAL_EVENT_NUMBER_C") - oDataRowSeis("INITIAL_EVENT_NUMBER_C") + 1)
                                End If
                            End If

                            '*************

                        End If

                        'FOLIO2_NUMBER_INITIAL, FOLIO2_NUMBER_FINAL, FOLIO3_NUMBER_INITIAL, FOLIO3_NUMBER_FINAL

                    Next

                    Dim par63 As New ReportParameter()
                    par63.Name = "par63"
                    par63.Values.Add(Format(CDec(db_acom_63), "###,###,##0.00"))

                    Dim par94 As New ReportParameter()
                    par94.Name = "par94"
                    'par94.Values.Add(Format(CDec(db_acom_94), "###,###,##0.00"))
                    par94.Values.Add(Format(CDec(VAR_11 + db_acom_63), "###,###,##0.00"))

                    Dim parametersTitulos_4() As ReportParameter = {par63, par94}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_4)


                    Dim par65 As New ReportParameter()
                    par65.Name = "par65"
                    par65.Values.Add(Format(CDec(db_acom_65), "###,###,##0.00"))

                    Dim par67 As New ReportParameter()
                    par67.Name = "par67"
                    par67.Values.Add(Format(CDec(db_acom_67), "###,###,##0.00"))

                    Dim par69 As New ReportParameter()
                    par69.Name = "par69"
                    par69.Values.Add(Format(db_acom_folios, "###,###,###,##0"))

                    Dim par74 As New ReportParameter()
                    par74.Name = "par74"
                    par74.Values.Add(Format(db_acom_folios2, "###,###,###,##0"))

                    Dim par79 As New ReportParameter()
                    par79.Name = "par79"
                    par79.Values.Add(Format(db_acom_folios3, "###,###,###,##0"))

                    Dim par89 As New ReportParameter()
                    par89.Name = "par89"
                    par89.Values.Add(Format(db_acom_eventos, "###,###,###,##0"))

                    Dim parametersTitulos_5() As ReportParameter = {par65, par67, par69, par89, par74, par79}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)

                End If


                'encargado de turno

                strQuerys = "SELECT	LANE_ASSIGN.Id_plaza,LANE_ASSIGN.Id_lane,TO_CHAR(LANE_ASSIGN.MSG_DHM,'MM/DD/YY HH24:MI:SS'),LANE_ASSIGN.SHIFT_NUMBER,LANE_ASSIGN.OPERATION_ID, " &
    "LANE_ASSIGN.DELEGATION, TO_CHAR(LANE_ASSIGN.ASSIGN_DHM,'MM/DD/YY'),LTRIM(TO_CHAR(LANE_ASSIGN.JOB_NUMBER,'09')),	LANE_ASSIGN.STAFF_NUMBER,LANE_ASSIGN.IN_CHARGE_SHIFT_NUMBER " &
    "FROM 	LANE_ASSIGN, SITE_GARE " &
    "WHERE	LANE_ASSIGN.id_NETWORK = SITE_GARE.id_Reseau " &
    "AND LANE_ASSIGN.id_plaza = SITE_GARE.id_Gare " &
    "AND SITE_GARE.id_reseau = '01' " &
    "AND	SITE_GARE.id_Site ='" & id_plaza_cobro_local & "' " &
    "AND LANE_ASSIGN.Id_lane = '" & Trim(oDataRow("Voie")) & "' "
                '"AND ((MSG_DHM >= TO_DATE('" & Format(oDataRow("DATE_DEBUT_POSTE"), "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) AND (MSG_DHM <= TO_DATE('" & Format(oDataRow("DATE_DEBUT_POSTE"), "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS'))) " & _

                If bl_varios_turnos = False Then
                    strQuerys = strQuerys & "AND (MSG_DHM >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(MSG_DHM <= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

                Else

                    strQuerys = strQuerys & "AND (MSG_DHM >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(MSG_DHM <= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

                End If

                strQuerys = strQuerys & "ORDER BY LANE_ASSIGN.Id_PLAZA, LANE_ASSIGN.Id_LANE, LANE_ASSIGN.MSG_DHM"

                If objQuerys.QueryDataSetTres(strQuerys, "Asig_Carril") = 1 Then

                    'str_detalle = str_detalle & oDataRowtres("OPERATION_ID") & ","

                    'str_encargado = oDataRowTres("IN_CHARGE_SHIFT_NUMBER")
                    strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
                    "FROM TABLE_PERSONNEL " &
                    "WHERE Matricule = '" & oDataRowTres("IN_CHARGE_SHIFT_NUMBER") & "'"


                    If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                        'Dim par98 As New ReportParameter()
                        'par98.Name = "par98"

                        'par98.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", oDataRowTres("Matricule"))) & "     " & Trim(oDataRowTres("nombre")))

                        'Dim parametersTitulos_encargado() As ReportParameter = {par98}
                        'ReportViewer1.LocalReport.SetParameters(parametersTitulos_encargado)

                    End If

                End If
                'fin encargado de turno

                Dim par98 As New ReportParameter()
                par98.Name = "par98"

                par98.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", int_Encargado_Reporte.ToString())) & "     " & srt_Encargado_Reporte)

                '***** JORGE - Comentario linea uno (1)
                Dim parLineaUno As New ReportParameter()
                parLineaUno.Name = "parLineaUno"
                parLineaUno.Values.Add(PrimeraLinea)

                Dim parLineaDos As New ReportParameter()
                parLineaDos.Name = "parLineaDos"
                parLineaDos.Values.Add(SegundaLinea)

                Dim parLineaTres As New ReportParameter()
                parLineaTres.Name = "parLineaTres"
                parLineaTres.Values.Add(TerceraLinea)

                Dim parametersTitulos_encargado() As ReportParameter = {par98, parLineaUno, parLineaDos, parLineaTres}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_encargado)


                'no empleado  admon general
                '   str_detalle = str_detalle & objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", "encargado_plaza") & ","

                strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
                "FROM TABLE_PERSONNEL " &
                "WHERE Matricule = '" & objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", "encargado_plaza") & "'"


                If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                    Dim par99 As New ReportParameter()
                    par99.Name = "par99"

                    par99.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", oDataRowTres("Matricule"))) & "     " & Trim(oDataRowTres("nombre")))

                    Dim parametersTitulos_admon() As ReportParameter = {par99}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_admon)

                End If

                'fin no empleado  admon general



                'dia
            ElseIf int_reporte = 3 Then
                ReportViewer1.LocalReport.DataSources.Clear()
                ReportViewer1.LocalReport.ReportEmbeddedResource = "rptPreliquidacion_Cajero_Receptor_Transito_Vehicular_2.rdlc"

                h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")

                h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")

                'titulos

                Dim par3 As New ReportParameter()
                par3.Name = "par3"
                par3.Values.Add(str_delegacion)

                Dim par5 As New ReportParameter()
                'par5.Name = "par5"
                'par5.Values.Add(str_Plaza_Cobro)
                strQuerys = "SELECT ID_SITE, NOM_SITE, NOM_SITE_L2 FROM TYPE_SITE where ID_SITE = '" & Trim(id_plaza_cobro_local) & "'"

                If objQuerys.QueryDataSetTres(strQuerys, "TYPE_SITE") = 1 Then

                    par5.Name = "par5"

                    If id_plaza_cobro_local <> "08" Then
                        If id_plaza_cobro_local <> "09" Then
                            par5.Values.Add("1" & id_plaza_cobro_local & " " & oDataRowTres("NOM_SITE"))
                        Else
                            par5.Values.Add("001 BIS" & " " & oDataRowTres("NOM_SITE"))
                        End If

                    Else
                        par5.Values.Add("001" & " " & oDataRowTres("NOM_SITE"))
                    End If


                End If



                'Dim par4 As New ReportParameter()
                'par4.Name = "par4"
                'par4.Values.Add(str_Turno_block)

                Dim par1 As New ReportParameter()
                par1.Name = "par1"
                If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    par1.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "MM/dd/yyyy"))
                    '***********************Cambios Daniel(Prosis)************************************************
                    fechaOpeTemp = Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "yyyyMMdd")
                    '*********************************************************************************************
                Else
                    par1.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "MM/dd/yyyy"))
                End If

                Dim par7 As New ReportParameter()
                par7.Name = "par7"
                par7.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim par9 As New ReportParameter()
                par9.Name = "par9"
                par9.Values.Add(Format(Now, "HH:mm:ss"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("PRELIQUIDACIÓN DE DÍA/CASETA")

                'Agrega la imagen  al Reporte
                'Dim parTituloReporte As ReportParameter = New ReportParameter()
                'parTituloReporte.Name = "inditex"
                'parTituloReporte.Values.Add("C:\\Imagenes_Pueba\\inditex.jpg")


                Dim parameters() As ReportParameter = {par3, par5, par1, par7, par9, parTituloReporte}
                ReportViewer1.LocalReport.SetParameters(parameters)

                'fin titulos

                'SACO LOS TURNOS

                strQuerys = "SELECT GEADBA.FIN_POSTE.ID_RESEAU, GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE_L2, GEADBA.FIN_POSTE.VOIE, TO_CHAR(GEADBA.FIN_POSTE.NUMERO_POSTE, 'FM09') AS Expr1, " &
          "TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'MM/DD/YY') AS Expr2, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'HH24:MI') AS Expr3, " &
          "GEADBA.FIN_POSTE.MATRICULE, GEADBA.FIN_POSTE.SAC AS Expr4, GEADBA.FIN_POSTE.ID_VOIE, " &
          "TO_CHAR(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE, 'YYYYMMDDHH24MISS') AS Expr5, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'YYYYMMDDHH24MISS') AS Expr6, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE, 0 AS Expr7, " &
          "FOLIO_NUMBER_OPEN, FOLIO_NUMBER_CLOSE, INITIAL_EVENT_NUMBER, FINAL_EVENT_NUMBER, " &
          "FOLIO2_NUMBER_INITIAL, FOLIO2_NUMBER_FINAL, FOLIO3_NUMBER_INITIAL, FOLIO3_NUMBER_FINAL " &
          "FROM GEADBA.TYPE_VOIE, GEADBA.FIN_POSTE, GEADBA.SITE_GARE " &
          "WHERE GEADBA.TYPE_VOIE.ID_VOIE = GEADBA.FIN_POSTE.ID_VOIE AND GEADBA.FIN_POSTE.ID_RESEAU = GEADBA.SITE_GARE.ID_RESEAU AND " &
          "GEADBA.FIN_POSTE.ID_GARE = GEADBA.SITE_GARE.ID_GARE AND (GEADBA.SITE_GARE.ID_RESEAU = '01') AND (GEADBA.SITE_GARE.ID_SITE = '" & id_plaza_cobro_local & "') AND " &
          "(GEADBA.FIN_POSTE.ID_MODE_VOIE IN (1, 6, 7)) "


                'If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                '    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                '    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                'ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                '    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                '    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                'ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                '    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                '    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                '    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                '    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                'End If

                strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "



                '    strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_FIN_POSTE >= TO_DATE('" & Format(dt_Fecha_Inicio, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '"(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(dt_Fecha_Fin, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "
                strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.ID_VOIE = '1' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '2' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '3' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = '4' OR " &
             "GEADBA.FIN_POSTE.ID_VOIE = 'X') " &
             "ORDER BY GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.ID_VOIE, GEADBA.FIN_POSTE.VOIE, GEADBA.FIN_POSTE.DATE_FIN_POSTE, " &
             "GEADBA.FIN_POSTE.NUMERO_POSTE, GEADBA.FIN_POSTE.MATRICULE, Expr4"
                'AND (GEADBA.FIN_POSTE.NUMERO_POSTE = " & id_Turno & ")

                If objQuerys.QueryDataSet(strQuerys, "TYPE_VOIE") = 1 Then


                    For cont = 0 To oDataSet.Tables("TYPE_VOIE").Rows.Count - 1

                        oDataRow = oDataSet.Tables("TYPE_VOIE").Rows.Item(cont)


                        'SACO LOS TOTALES
                        strQuerys = "SELECT MATRICULE,SAC AS Expr1, NVL(NB_POSTE, 0) + NVL(NB_POSTE_POS, 0) AS Expr2, NVL(RED_RCT_MONNAIE1, 0) AS Expr3, " &
                          "NVL(RED_RCT_CHQ, 0) AS Expr4, NVL(RED_NB_CHQ, 0) AS Expr5, NVL(RED_RCT_DEVISE, 0) AS Expr6, NVL(RED_RCT_MONNAIE3, 0) AS Expr7, " &
                          "NVL(RED_RCT_MONNAIE4, 0) AS Expr8, NVL(RED_CPT1, 0) AS Expr9, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) + NVL(RED_RCT_MONNAIE3, 0) " &
                          "+ NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_CHQ, 0) + NVL(RED_RCT_DEVISE, 0) AS Expr10, NVL(POSTE_RCT_MONNAIE1, 0) + NVL(POSTE_RCT_MONNAIE2, 0) " &
                          "+ NVL(POSTE_RCT_MONNAIE3, 0) + NVL(POSTE_RCT_MONNAIE4, 0) + NVL(POSTE_RCT_DEVISE, 0) + NVL(POSTE_RCT_CHQ, 0) + NVL(POSTE_POS_RCT_MONNAIE1, " &
                          "0) + NVL(POSTE_POS_RMB_MONNAIE1, 0) + NVL(POSTE_POS_RCT_MONNAIE2, 0) + NVL(POSTE_POS_RCT_MONNAIE3, 0) + NVL(POSTE_POS_RCT_MONNAIE4, 0) " &
                          "+ NVL(POSTE_POS_RCT_DEVISE, 0) + NVL(POSTE_POS_RCT_CHQ, 0) AS Expr11, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) " &
                          "+ NVL(RED_RCT_MONNAIE3, 0) + NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_DEVISE, 0) + NVL(RED_RCT_CHQ, 0) - NVL(POSTE_RCT_MONNAIE1, 0) " &
                          "- NVL(POSTE_RCT_MONNAIE2, 0) - NVL(POSTE_RCT_MONNAIE3, 0) - NVL(POSTE_RCT_MONNAIE4, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_RCT_CHQ, 0) " &
                          "- NVL(POSTE_POS_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE2, 0) - NVL(POSTE_POS_RCT_MONNAIE3, 0) " &
                          "- NVL(POSTE_POS_RCT_MONNAIE4, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr12, NVL(RED_RCT_MONNAIE1, 0) " &
                          "- NVL(POSTE_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE1, 0) AS Expr13, NVL(RED_RCT_CHQ, 0) " &
                          "- NVL(POSTE_RCT_CHQ, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr14, NVL(RED_RCT_DEVISE, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) " &
                          "AS Expr15, NVL(RED_CPT24, 0) AS Expr16, NVL(RED_CPT25, 0) AS Expr17, NVL(RED_JETON, 0) - NVL(POSTE_JETON, 0) AS Expr18, NVL(RED_RDD, 0) " &
                          "- NVL(POSTE_RDD, 0) AS Expr19, NVL(RED_GRATUIT, 0) + NVL(RED_CPT2, 0) - NVL(POSTE_GRATUIT, 0) AS Expr20, MATRICULE_COMMENTAIRE, COMMENTAIRE, " &
                          "0 AS Expr21, TO_CHAR(DATE_REDDITION, 'YYYYMMDDHH24MISS') AS Expr22, ID_SITE, RED_CPT21, " &
                          "NVL(Red_Rct_Monnaie1,0)	+ NVL(Red_Rct_Devise,0)	+ NVL(Red_Rct_Chq,0) + NVL(Red_cpt21,0)	- NVL(Poste_Rct_Monnaie1,0) - NVL(Poste_Rct_Devise,0) - NVL(Poste_Rct_Chq,0) AS Expr23, RED_CPT22 " &
                          "FROM REDDITION " &
                          "WHERE  (ID_SITE = '" & id_plaza_cobro_local & "') AND (MATRICULE = '" & oDataRow("MATRICULE") & "') AND (SAC = '" & oDataRow("Expr4") & "')"
                        '(DATE_REDDITION = TO_DATE('20130206071615', 'YYYYMMDDHH24MISS')) AND 'no se obtiene

                        If objQuerys.QueryDataSetDos(strQuerys, "REDDITION") = 1 Then


                            VAR_11 = VAR_11 + oDataRowDos("Expr3")
                            VAR_50 = VAR_50 + oDataRowDos("Expr6")

                            'Dim par63 As New ReportParameter()
                            'par63.Name = "par63"
                            'par63.Values.Add(Format(CDec(oDataRowDos("Expr10")), "###,###,##0.00"))
                            If Not IsDBNull(oDataRowDos("RED_CPT21")) Then
                                db_acom_63 = db_acom_63 + oDataRowDos("RED_CPT21")
                            End If

                            'cancelados
                            If Not IsDBNull(oDataRowDos("RED_CPT22")) Then
                                VAR_13 = VAR_13 + oDataRowDos("RED_CPT22")
                            End If

                            If oDataRowDos("Expr23") > 0 Then

                                db_acom_67 = db_acom_67 + oDataRowDos("Expr23")
                                db_acom_65 = db_acom_65 + 0

                            ElseIf oDataRowDos("Expr23") = 0 Then

                                db_acom_67 = db_acom_67 + 0
                                db_acom_65 = db_acom_65 + 0

                            ElseIf oDataRowDos("Expr23") < 0 Then

                                db_acom_65 = db_acom_65 + oDataRowDos("Expr23")
                                db_acom_67 = db_acom_67 + 0

                            End If

                            db_acom_94 = db_acom_94 + (VAR_11 + VAR_50) 'oDataRowDos("Expr10")

                            'folios
                            'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - (oDataRow("FOLIO_NUMBER_OPEN") + 1))
                            'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1)
                            '*************************
                            'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1)
                            Dim FOLIO_NUMBER_OPEN As Double
                            Dim FOLIO_NUMBER_CLOSE As Double

                            If Not Len(CStr(oDataRow("FOLIO_NUMBER_OPEN"))) = 10 Then
                                FOLIO_NUMBER_OPEN = oDataRow("FOLIO_NUMBER_OPEN")
                            Else
                                FOLIO_NUMBER_OPEN = Mid(CStr(oDataRow("FOLIO_NUMBER_OPEN")), 1, 9)
                            End If

                            If Not Len(CStr(oDataRow("FOLIO_NUMBER_CLOSE"))) = 10 Then
                                FOLIO_NUMBER_CLOSE = oDataRow("FOLIO_NUMBER_CLOSE")
                            Else
                                FOLIO_NUMBER_CLOSE = Mid(CStr(oDataRow("FOLIO_NUMBER_CLOSE")), 1, 9)
                            End If

                            If FOLIO_NUMBER_CLOSE = 0 Or FOLIO_NUMBER_OPEN = 0 Then
                                db_acom_folios = db_acom_folios
                            Else
                                If FOLIO_NUMBER_CLOSE <= FOLIO_NUMBER_OPEN Then
                                    db_acom_folios = db_acom_folios + 1
                                Else
                                    db_acom_folios = db_acom_folios + (FOLIO_NUMBER_CLOSE - FOLIO_NUMBER_OPEN + 1)
                                End If
                            End If
                            'db_acom_folios = db_acom_folios + (FOLIO_NUMBER_CLOSE - FOLIO_NUMBER_OPEN + 1)
                            '*************************

                            If oDataRow("FOLIO2_NUMBER_FINAL") = 0 And oDataRow("FOLIO2_NUMBER_FINAL") = 0 Then
                            Else
                                db_acom_folios2 = db_acom_folios2 + oDataRow("FOLIO2_NUMBER_FINAL") - oDataRow("FOLIO2_NUMBER_INITIAL") + 1
                            End If
                            If oDataRow("FOLIO3_NUMBER_FINAL") = 0 And oDataRow("FOLIO3_NUMBER_FINAL") = 0 Then

                            Else
                                db_acom_folios3 = db_acom_folios3 + oDataRow("FOLIO3_NUMBER_FINAL") - oDataRow("FOLIO3_NUMBER_INITIAL") + 1
                            End If

                            'db_acom_eventos = db_acom_eventos + (oDataRow("FINAL_EVENT_NUMBER") - oDataRow("INITIAL_EVENT_NUMBER") + 1)
                            'eventos
                            '*************
                            'db_acom_eventos = db_acom_eventos + (oDataRow("FINAL_EVENT_NUMBER") - oDataRow("INITIAL_EVENT_NUMBER") + 1)

                            strQuerys = "select  MIN(EVENT_NUMBER) AS INITIAL_EVENT_NUMBER_C, MAX(EVENT_NUMBER) AS FINAL_EVENT_NUMBER_C FROM TRANSACTION WHERE ID_GARE = '" & oDataRow("ID_GARE") & "' AND ID_VOIE  = '" & oDataRow("ID_VOIE") & "'  AND VOIE  = '" & oDataRow("VOIE") & "' " &
                            "AND  DATE_DEBUT_POSTE = TO_DATE('" & oDataRow("Expr5") & "', 'YYYYMMDDHH24MISS') AND EVENT_NUMBER <> 0  AND ID_OBS_PASSAGE <> '1' "

                            If objQuerys.QueryDataSetSeis(strQuerys, "TRANSACTION") = 1 Then
                                If Not IsDBNull(oDataRowSeis("INITIAL_EVENT_NUMBER_C")) Then
                                    db_acom_eventos = db_acom_eventos + (oDataRowSeis("FINAL_EVENT_NUMBER_C") - oDataRowSeis("INITIAL_EVENT_NUMBER_C") + 1)
                                End If
                            End If

                            '*************


                            ''Dim par63 As New ReportParameter()
                            ''par63.Name = "par63"
                            ''par63.Values.Add(Format(CDec(oDataRowDos("Expr10")), "###,###,##0.00"))

                            'db_acom_63 = db_acom_63 + oDataRowDos("Expr10")

                            ''Dim par94 As New ReportParameter()
                            ''par94.Name = "par94"
                            ''par94.Values.Add(Format(CDec(oDataRowDos("Expr10")), "###,###,##0.00"))

                            'db_acom_94 = db_acom_94 + oDataRowDos("Expr10")


                            ''Dim parametersTitulos_4() As ReportParameter = {par9, par10, par2, par63, par94}
                            ''ReportViewer1.LocalReport.SetParameters(parametersTitulos_4)


                            ''folios
                            'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - (oDataRow("FOLIO_NUMBER_OPEN") + 1))

                            'If oDataRowDos("Expr12") < 0 Then


                            '    'Dim par65 As New ReportParameter()
                            '    'par65.Name = "par65"
                            '    'par65.Values.Add(Format(CDec(oDataRowDos("Expr12")), "###,###,##0.00"))

                            '    db_acom_65 = db_acom_65 + oDataRowDos("Expr12")

                            '    'Dim par67 As New ReportParameter()
                            '    'par67.Name = "par67"
                            '    'par67.Values.Add(Format(0, "###,###,##0.00"))

                            '    'db_acom_67 = db_acom_67 + 0

                            '    'Dim parametersTitulos_5() As ReportParameter = {par65, par67}
                            '    'ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)

                            'Else

                            '    'Dim par65 As New ReportParameter()
                            '    'par65.Name = "par65"
                            '    'par65.Values.Add(Format(Format(0, "###,###,##0.00")))

                            '    'db_acom_65 = db_acom_65 + oDataRowDos("Expr12")

                            '    'Dim par67 As New ReportParameter()
                            '    'par67.Name = "par67"
                            '    'par67.Values.Add(Format(CDec(oDataRowDos("Expr12")), "###,###,##0.00"))

                            '    db_acom_67 = db_acom_67 + oDataRowDos("Expr12")

                            '    'Dim parametersTitulos_5() As ReportParameter = {par65, par67}
                            '    'ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)

                            'End If

                            ''objText = rpt_reporte.ReportDefinition.ReportObjects.Item("txtDiferenciaEntregada")
                            ''objText.Text = Format(CDec(oDataRowDos("Expr12")), "###,###,##0.00")

                        End If



                    Next

                    Dim par63 As New ReportParameter()
                    par63.Name = "par63"
                    par63.Values.Add(Format(CDec(db_acom_63), "###,###,##0.00"))

                    Dim par94 As New ReportParameter()
                    par94.Name = "par94"
                    'par94.Values.Add(Format(CDec(db_acom_94), "###,###,##0.00"))
                    par94.Values.Add(Format(CDec(VAR_11 + db_acom_63), "###,###,##0.00"))

                    Dim parametersTitulos_4() As ReportParameter = {par63, par94}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_4)


                    Dim par65 As New ReportParameter()
                    par65.Name = "par65"
                    par65.Values.Add(Format(CDec(db_acom_65), "###,###,##0.00"))

                    Dim par67 As New ReportParameter()
                    par67.Name = "par67"
                    par67.Values.Add(Format(CDec(db_acom_67), "###,###,##0.00"))

                    Dim par69 As New ReportParameter()
                    par69.Name = "par69"
                    par69.Values.Add(Format(db_acom_folios, "###,###,###,##0"))

                    Dim par74 As New ReportParameter()
                    par74.Name = "par74"
                    par74.Values.Add(Format(db_acom_folios2, "###,###,###,##0"))

                    Dim par79 As New ReportParameter()
                    par79.Name = "par79"
                    par79.Values.Add(Format(db_acom_folios3, "###,###,###,##0"))


                    Dim par89 As New ReportParameter()
                    par89.Name = "par89"
                    par89.Values.Add(Format(db_acom_eventos, "###,###,###,##0"))

                    Dim parametersTitulos_5() As ReportParameter = {par65, par67, par69, par89, par74, par79}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)



                    'Dim par63 As New ReportParameter()
                    'par63.Name = "par63"
                    'par63.Values.Add(Format(CDec(db_acom_63), "###,###,##0.00"))

                    'Dim par94 As New ReportParameter()
                    'par94.Name = "par94"
                    'par94.Values.Add(Format(CDec(db_acom_94), "###,###,##0.00"))

                    'Dim parametersTitulos_4() As ReportParameter = {par63, par94}
                    'ReportViewer1.LocalReport.SetParameters(parametersTitulos_4)


                    'Dim par65 As New ReportParameter()
                    'par65.Name = "par65"
                    'par65.Values.Add(Format(CDec(db_acom_65), "###,###,##0.00"))

                    'Dim par67 As New ReportParameter()
                    'par67.Name = "par67"
                    'par67.Values.Add(Format(CDec(db_acom_67), "###,###,##0.00"))

                    'Dim par69 As New ReportParameter()
                    'par69.Name = "par69"
                    'par69.Values.Add(Format(db_acom_folios, "###,###,###,##0"))

                    'Dim parametersTitulos_5() As ReportParameter = {par65, par67, par69}
                    'ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)




                End If

                'fin de SACAR TURNOS

                'JORGE - Número y Nombre de Encargado de Turno *********************** 

                Dim par98 As New ReportParameter()
                par98.Name = "par98"
                par98.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", int_Encargado_Reporte.ToString())) & "     " & srt_Encargado_Reporte)

                Dim par99 As New ReportParameter()
                par99.Name = "par99"
                par99.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", "120036")) & "     " & "ALBA DE SANTOS GERARDO")

                '***** JORGE - Comentario linea uno (1)
                Dim parLineaUno As New ReportParameter()
                parLineaUno.Name = "parLineaUno"
                parLineaUno.Values.Add(PrimeraLinea)

                Dim parLineaDos As New ReportParameter()
                parLineaDos.Name = "parLineaDos"
                parLineaDos.Values.Add(SegundaLinea)

                Dim parLineaTres As New ReportParameter()
                parLineaTres.Name = "parLineaTres"
                parLineaTres.Values.Add(TerceraLinea)

                Dim parametersTitulos_encargado() As ReportParameter = {par98, par99, parLineaUno, parLineaDos, parLineaTres}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_encargado)
                '***********************************************************************



            End If

            Dim par11 As New ReportParameter()
            Dim par12 As New ReportParameter()
            Dim par13 As New ReportParameter()
            Dim par14 As New ReportParameter()
            Dim par15 As New ReportParameter()
            Dim par16 As New ReportParameter()
            Dim par17 As New ReportParameter()
            Dim par18 As New ReportParameter()
            Dim par19 As New ReportParameter()
            Dim par20 As New ReportParameter()
            Dim par21 As New ReportParameter()
            Dim par22 As New ReportParameter()
            Dim par23 As New ReportParameter()
            Dim par24 As New ReportParameter()
            Dim par25 As New ReportParameter()
            Dim par26 As New ReportParameter()
            Dim par27 As New ReportParameter()
            Dim par28 As New ReportParameter()
            Dim par29 As New ReportParameter()
            Dim par30 As New ReportParameter()
            Dim par31 As New ReportParameter()
            Dim par32 As New ReportParameter()
            Dim par33 As New ReportParameter()
            Dim par34 As New ReportParameter()
            Dim par35 As New ReportParameter()
            Dim par36 As New ReportParameter()
            Dim par37 As New ReportParameter()
            Dim par38 As New ReportParameter()
            Dim par39 As New ReportParameter()

            Dim par40 As New ReportParameter()
            Dim par41 As New ReportParameter()
            Dim par42 As New ReportParameter()
            Dim par43 As New ReportParameter()

            Dim par140 As New ReportParameter()
            Dim par141 As New ReportParameter()
            Dim par142 As New ReportParameter()
            Dim par143 As New ReportParameter()


            Dim par44 As New ReportParameter()
            Dim par45 As New ReportParameter()
            Dim par46 As New ReportParameter()
            Dim par47 As New ReportParameter()
            Dim par48 As New ReportParameter()
            Dim par49 As New ReportParameter()
            Dim par50 As New ReportParameter()
            Dim par51 As New ReportParameter()
            Dim par52 As New ReportParameter()
            Dim par53 As New ReportParameter()
            Dim par54 As New ReportParameter()
            Dim par55 As New ReportParameter()
            Dim par56 As New ReportParameter()
            Dim par57 As New ReportParameter()
            Dim par58 As New ReportParameter()
            Dim par59 As New ReportParameter()
            Dim par60 As New ReportParameter()
            Dim par61 As New ReportParameter()
            Dim par62 As New ReportParameter()

            par11.Name = "par11"
            par11.Values.Add(Format(VAR_11, "###,###,##0.00"))

            'BOLETOS GENERADOS POR ERROR
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then


                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                'DATE_DEBUT_POSTE
                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_OBS_SEQUENCE = '5') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par12.Name = "par12"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par12.Values.Add(Format(0, "###,###,##0.00"))
                    VAR_12 = 0
                Else
                    ' par12.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    'VAR_12 = oDataRow("Monto_1")

                    par12.Values.Add(Format(0, "###,###,##0.00"))
                    VAR_12 = 0
                End If


                par13.Name = "par13"
                If IsDBNull(oDataRow("Cruces")) Then
                    'par13.Values.Add(Format(0, "###,###,##0.00"))
                    par13.Values.Add(Format(0 + VAR_13, "###,###,##0.00"))
                Else
                    par13.Values.Add(Format(oDataRow("Cruces") + VAR_13, "###,###,##0"))
                    VAR_13 = VAR_13 + oDataRow("Cruces")
                End If


            End If


            'complemento folios

            Dim par87 As New ReportParameter()
            par87.Name = "par87"

            Dim par88 As New ReportParameter()
            par88.Name = "par88"


            Dim par72 As New ReportParameter()
            par72.Name = "par72"

            Dim par73 As New ReportParameter()
            par73.Name = "par73"

            If int_reporte = 1 Then

                If VAR_13 > 0 Then
                    par72.Values.Add(Format(VAR_13, "###,###,###,##0"))
                    par87.Values.Add(Format(VAR_13, "###,###,###,##0"))
                End If

                'par88.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_FINAL") - oDataRow("FOLIO_ECT_NUMBER_INITIAL") + 1, "###,###,###,##0"))
                par73.Values.Add(Format(VAR_73 - VAR_13, "###,###,###,##0"))
                par88.Values.Add(Format(VAR_88 - VAR_13, "###,###,###,##0"))

            End If

            '---------------------------------------
            'par12.Name = "par12"
            'par12.Values.Add(Format(0, "###,###,##0.00"))

            'par13.Name = "par13"
            'par13.Values.Add(Format(0, "###,###,##0"))

            'VEHICULOS RESIDENTES PAGO INMEDIATO

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1, SUM(PRIX_TOTAL) AS Monto_2, COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
      "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 " &
    "OR ID_PAIEMENT = 72 " &
    "OR ID_PAIEMENT = 73 " &
    "OR ID_PAIEMENT = 74  or ID_PAIEMENT = 10) AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                par14.Name = "par14"
                If IsDBNull(oDataRow("Monto_2")) Then
                    par14.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par14.Values.Add(Format(oDataRow("Monto_2"), "###,###,##0.00"))
                End If

                par15.Name = "par15"
                If IsDBNull(oDataRow("Monto_2")) Then
                    par15.Values.Add(Format(0, "###,###,##0"))
                Else
                    par15.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                End If

                VAR_14 = IIf(IsDBNull(oDataRow("Monto_2")), 0, oDataRow("Monto_2"))
                VAR_15 = IIf(IsDBNull(oDataRow("Cruces")), 0, oDataRow("Cruces"))
            End If

            'SUBTOTAL MARCADO COMO PAGADO
            VAR_16 = VAR_11 + VAR_12
            par16.Name = "par16"
            par16.Values.Add(Format(VAR_16, "###,###,##0.00"))
            '-------------------
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
     "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 1 " &
    "OR ID_PAIEMENT = 2 " &
    "OR ID_PAIEMENT = 71 " &
                "OR ID_PAIEMENT = 72 " &
                "OR ID_PAIEMENT = 73 " &
                "OR ID_PAIEMENT = 74  or ID_PAIEMENT = 10) " &
                "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            '  strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                par17.Name = "par17"
                If IsDBNull(oDataRow("Cruces")) Then

                    'par17.Values.Add(Format(0 + VAR_13, "###,###,##0"))
                    par17.Values.Add(Format(0, "###,###,##0"))
                Else

                    'par17.Values.Add(Format(oDataRow("Cruces") + VAR_13, "###,###,##0"))
                    par17.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                End If



                'VAR_17 = IIf(IsDBNull(oDataRow("Cruces")), 0 + VAR_13, oDataRow("Cruces") + VAR_13)
                VAR_17 = IIf(IsDBNull(oDataRow("Cruces")), 0, oDataRow("Cruces"))
            End If

            '2013/10/09
            '-----------------------------
            '          strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            ' "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 1 " &
                 "OR ID_PAIEMENT = 2 " &
                 "OR ID_PAIEMENT = 71 " &
                 "OR ID_PAIEMENT = 72 " &
                 "OR ID_PAIEMENT = 73 " &
                 "OR ID_PAIEMENT = 74  or ID_PAIEMENT = 10) " &
                 "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                par18.Name = "par18"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par18.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par18.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                End If

                VAR_18 = IIf(IsDBNull(oDataRow("Monto_1")), 0, oDataRow("Monto_1"))


                par19.Name = "par19"
                If IsDBNull(oDataRow("Cruces")) Then
                    par19.Values.Add(Format(0, "###,###,##0"))
                Else
                    par19.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                End If

                VAR_18 = IIf(IsDBNull(oDataRow("Monto_1")), 0, oDataRow("Monto_1"))
                VAR_19 = IIf(IsDBNull(oDataRow("Cruces")), 0, oDataRow("Cruces"))
            End If

            VAR_20 = VAR_16 - VAR_18
            par20.Name = "par20"
            par20.Values.Add(Format(VAR_20, "###,###,##0.00"))


            If int_reporte = 1 Then

                If VAR_20 >= 0 Then
                    VAR_63 = 0
                    VAR_65 = 0
                    VAR_67 = 0
                    'Else

                    '    If VAR_20 < VAR_63 Then

                    '        VAR_67 = VAR_63 - VAR_20

                    '    End If

                End If

                '2014/06/10
                Dim par63 As New ReportParameter()
                par63.Name = "par63"
                par63.Values.Add(Format(VAR_63, "###,###,##0.00"))

                Dim par65 As New ReportParameter()
                par65.Name = "par65"
                par65.Values.Add(Format(VAR_65, "###,###,##0.00"))

                Dim par67 As New ReportParameter()
                par67.Name = "par67"
                par67.Values.Add(Format(VAR_67, "###,###,##0.00"))

                Dim parametersTitulos_5() As ReportParameter = {par63, par65, par67}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)

            End If

            VAR_21 = VAR_17 - VAR_19
            par21.Name = "par21"
            par21.Values.Add(Format(VAR_21, "###,###,##0"))



            'BOLETOS RESIDENTES P.A.
            par22.Name = "par22"
            par22.Values.Add(Format(VAR_22, "###,###,##0.00"))

            par23.Name = "par23"
            par23.Values.Add(Format(VAR_23, "###,###,##0"))

            par24.Name = "par24"
            par24.Values.Add(Format(VAR_24, "###,###,##0.00"))

            par25.Name = "par25"
            par25.Values.Add(Format(VAR_25, "###,###,##0"))

            par26.Name = "par26"
            par26.Values.Add(Format(VAR_26, "###,###,##0.00"))

            par27.Name = "par27"
            par27.Values.Add(Format(VAR_27, "###,###,##0"))

            'SISTEMAS ELECTRONICOS
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' " &
                 "and SHIFT_NUMBER = " & id_Turno & " "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " " &
                    "and SHIFT_NUMBER = " & id_Turno & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            'strQuerys = strQuerys & "AND ID_PAIEMENT = 15 and SHIFT_NUMBER = " & id_Turno & " " '& _
            strQuerys = strQuerys & "AND ID_PAIEMENT = 15" '& _
            'nota 2013/10/01
            '"AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par28.Name = "par28"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par28.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par28.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_28 = oDataRow("Monto_1")
                End If

                par29.Name = "par29"
                If IsDBNull(oDataRow("Cruces")) Then
                    par29.Values.Add(Format(0, "###,###,##0"))
                Else
                    par29.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_29 = oDataRow("Cruces")
                End If

            End If

            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "'  and SHIFT_NUMBER = " & id_Turno & "  "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & "  and SHIFT_NUMBER = " & id_Turno & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            'strQuerys = strQuerys & "AND ID_PAIEMENT = 15  and SHIFT_NUMBER = " & id_Turno & "  " '& _
            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " '& _
            '"AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par30.Name = "par30"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par30.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par30.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_30 = oDataRow("Monto_1")
                End If

                par31.Name = "par31"
                If IsDBNull(oDataRow("Cruces")) Then
                    par31.Values.Add(Format(0, "###,###,##0"))
                Else
                    par31.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_31 = oDataRow("Cruces")
                End If

            End If


            'VSC
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 27 and (ID_OBS_SEQUENCE = '0' or ID_OBS_SEQUENCE = 'F')) "


            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par32.Name = "par32"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par32.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par32.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_32 = oDataRow("Monto_1")
                End If

                par33.Name = "par33"
                If IsDBNull(oDataRow("Cruces")) Then
                    par33.Values.Add(Format(0, "###,###,##0"))
                Else
                    par33.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_33 = oDataRow("Cruces")
                End If

            End If

            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 27 and (ID_OBS_SEQUENCE = '0' or ID_OBS_SEQUENCE = 'F')) "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par34.Name = "par34"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par34.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par34.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_34 = oDataRow("Monto_1")
                End If

                par35.Name = "par35"
                If IsDBNull(oDataRow("Cruces")) Then
                    par35.Values.Add(Format(0, "###,###,##0"))
                Else
                    par35.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_35 = oDataRow("Cruces")
                End If

            End If

            '+++VEHICULOS RESIDENTES S.P.
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 75 and ID_OBS_SEQUENCE = '0') "


            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par36.Name = "par36"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par36.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par36.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_36 = oDataRow("Monto_1")
                End If

                par37.Name = "par37"
                If IsDBNull(oDataRow("Cruces")) Then
                    par37.Values.Add(Format(0, "###,###,##0"))
                Else
                    par37.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_37 = oDataRow("Cruces")
                End If

            End If

            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 75 and ID_OBS_SEQUENCE = '0') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par38.Name = "par38"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par38.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par38.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_38 = oDataRow("Monto_1")
                End If

                par39.Name = "par39"
                If IsDBNull(oDataRow("Cruces")) Then
                    par39.Values.Add(Format(0, "###,###,##0"))
                Else
                    par39.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_39 = oDataRow("Cruces")
                End If

            End If

            'par36.Name = "par36"
            'par36.Values.Add(Format(VAR_36, "###,###,##0.00"))

            'par37.Name = "par37"
            'par37.Values.Add(Format(VAR_37, "###,###,##0"))

            'par38.Name = "par38"
            'par38.Values.Add(Format(VAR_38, "###,###,##0.00"))

            'par39.Name = "par39"
            'par39.Values.Add(Format(VAR_39, "###,###,##0"))

            '++++fin VEHICULOS RESIDENTES S.P.


            'VEHICULOS ELUDIDOS / tdc
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 12 " '& _
            ' "AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par40.Name = "par40"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par40.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par40.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_40 = oDataRow("Monto_1")
                End If

                par41.Name = "par41"
                If IsDBNull(oDataRow("Cruces")) Then
                    par41.Values.Add(Format(0, "###,###,##0"))
                Else
                    par41.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_41 = oDataRow("Cruces")
                End If

            End If

            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 12 " '& _
            '"AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par42.Name = "par42"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par42.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par42.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_42 = oDataRow("Monto_1")
                End If

                par43.Name = "par43"
                If IsDBNull(oDataRow("Cruces")) Then
                    par43.Values.Add(Format(0, "###,###,##0"))
                Else
                    par43.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_43 = oDataRow("Cruces")
                End If

            End If


            'tdd
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 14 " '& _
            ' "AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par140.Name = "par140"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par140.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par140.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_140 = oDataRow("Monto_1")
                End If

                par141.Name = "par141"
                If IsDBNull(oDataRow("Cruces")) Then
                    par141.Values.Add(Format(0, "###,###,##0"))
                Else
                    par141.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_141 = oDataRow("Cruces")
                End If

            End If

            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 14 " '& _
            '"AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par142.Name = "par142"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par142.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par142.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_142 = oDataRow("Monto_1")
                End If

                par143.Name = "par143"
                If IsDBNull(oDataRow("Cruces")) Then
                    par143.Values.Add(Format(0, "###,###,##0"))
                Else
                    par143.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_143 = oDataRow("Cruces")
                End If

            End If



            'TOTALES
            VAR_44 = VAR_16 + VAR_22 + VAR_28 + VAR_32 + VAR_36 + VAR_40 + VAR_140
            par44.Name = "par44"
            par44.Values.Add(Format(VAR_44, "###,###,##0.00"))

            VAR_45 = VAR_17 + VAR_23 + VAR_29 + VAR_33 + VAR_37 + VAR_41 + VAR_141
            par45.Name = "par45"
            par45.Values.Add(Format(VAR_45, "###,###,##0"))

            VAR_46 = VAR_18 + VAR_24 + VAR_30 + VAR_34 + VAR_38 + VAR_42 + VAR_142
            par46.Name = "par46"
            par46.Values.Add(Format(VAR_46, "###,###,##0.00"))

            VAR_47 = VAR_19 + VAR_25 + VAR_31 + VAR_35 + VAR_39 + VAR_43 + VAR_143
            par47.Name = "par47"
            par47.Values.Add(Format(VAR_47, "###,###,##0"))

            VAR_48 = VAR_44 - VAR_46
            par48.Name = "par48"
            par48.Values.Add(Format(VAR_48, "###,###,##0.00"))

            VAR_49 = VAR_45 - VAR_47
            par49.Name = "par49"
            par49.Values.Add(Format(VAR_49, "###,###,##0"))


            'EFECTIVO DLLS.
            par50.Name = "par50"
            par50.Values.Add(Format(VAR_50, "###,###,##0.00"))

            'BOLETOS GENERADOS POR ERROR
            par51.Name = "par51"
            par51.Values.Add(Format(VAR_51, "###,###,##0.00"))

            par52.Name = "par52"
            par52.Values.Add(Format(VAR_52, "###,###,##0"))

            'SUBTOTAL MARCADO COMO PAGADO
            par53.Name = "par53"
            par53.Values.Add(Format(VAR_53, "###,###,##0.00"))

            par54.Name = "par54"
            par54.Values.Add(Format(VAR_54, "###,###,##0"))

            par55.Name = "par55"
            par55.Values.Add(Format(VAR_55, "###,###,##0.00"))

            par56.Name = "par56"
            par56.Values.Add(Format(VAR_56, "###,###,##0"))

            VAR_57 = VAR_53 - VAR_55
            par57.Name = "par57"
            par57.Values.Add(Format(VAR_57, "###,###,##0.00"))

            VAR_58 = VAR_54 - VAR_56
            par58.Name = "par58"
            par58.Values.Add(Format(VAR_58, "###,###,##0"))

            'RECLASIFICADOS
            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            'strQuerys = strQuerys & "AND ID_PAIEMENT = 13 " & _
            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'F'"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par59.Name = "par59"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par59.Values.Add(Format(0, "###,###,##0.00"))
                    Reclasificados = Format(0, "###,###,##0.00")
                Else
                    par59.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    Reclasificados = Format(oDataRow("Monto_1"), "###,###,##0.00")
                    VAR_59 = oDataRow("Monto_1")
                End If

                par60.Name = "par60"
                If IsDBNull(oDataRow("Cruces")) Then
                    par60.Values.Add(Format(0, "###,###,##0"))
                Else
                    par60.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_60 = oDataRow("Cruces")
                End If

            End If

            'DETECCIONES ERRONEAS
            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
          "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
              "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            'strQuerys = strQuerys & "AND ID_PAIEMENT = 13 " & _
            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par61.Name = "par61"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par61.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par61.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_61 = oDataRow("Monto_1")
                End If

                par62.Name = "par62"
                If IsDBNull(oDataRow("Cruces")) Then
                    par62.Values.Add(Format(0, "###,###,##0"))
                Else
                    par62.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_62 = oDataRow("Cruces")
                End If

            End If

            '------------------------------------
            'par61.Name = "par61"
            'par61.Values.Add(Format(VAR_61, "###,###,##0.00"))

            'par62.Name = "par62"
            'par62.Values.Add(Format(VAR_62, "###,###,##0"))

            '--------------------------------------------------------------------------------------------
            Dim parametersDetalle() As ReportParameter = {par11, par12, par13, par14, par15, par16, par17, par18, par19, par20, par21, par22, par23, par24, par25, par26, par27, par28, par29, par30, par31, par32, par33, par34, par35, par36, par37, par38, par39, par40, par41, par42, par43, par140, par141, par142, par143, par44, par45, par46, par47, par48, par49, par50, par51, par52, par53, par54, par55, par56, par57, par58, par59, par60, par61, par62, par72, par73, par87, par88}
            ReportViewer1.LocalReport.SetParameters(parametersDetalle)



            ReportViewer1.SetDisplayMode(DisplayMode.PrintLayout)
            Me.ReportViewer1.RefreshReport()

            '---------------------------------Codigo para generar PDF---------------------------------------------------------------------
            Dim lstMeses = New String() {"Enero", "Fecbrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"}
            Dim turno As String = ""
            Dim banFechaOp As Boolean = False
            Select Case RTrim(LTrim(str_Turno_block))
                Case "22:00 - 06:00"
                    turno = "Nocturno"
                    banFechaOp = True
                Case "06:00 - 14:00"
                    turno = "Matutino"
                Case "14:00 - 22:00"
                    turno = "Vespertino"
                Case Else
                    turno = "Dia"
            End Select

            If Not Directory.Exists("c:\reportes_pdf\" + lstMeses(Integer.Parse(dt_Fecha_Inicio.Month) - 1).ToString() + "\Dia" + dt_Fecha_Inicio.Day.ToString() + "\" + turno + "\") Then
                Directory.CreateDirectory("c:\reportes_pdf\" + lstMeses(Integer.Parse(dt_Fecha_Inicio.Month) - 1).ToString() + "\Dia" + dt_Fecha_Inicio.Day.ToString() + "\" + turno + "\")
            End If

            Dim Bytes() As Byte = ReportViewer1.LocalReport.Render("PDF", "", Nothing, Nothing, Nothing, Nothing, Nothing)
            Dim str_archivo As String

            If bl_varios_turnos = False Then
                str_archivo = Format(h_inicio_turno, "yyyyMMddHHmmss") & "_" & No_Turno & "_" & "_" & str_MATRICULE
            Else
                str_archivo = Format(hr_fecha_ini_varios_turnos, "yyyyMMddHHmmss") & "_" & No_Turno & "_" & "_" & str_MATRICULE
            End If

            If banFechaOp And fechaOpeTemp <> "" Then
                str_archivo = fechaOpeTemp + str_archivo.Substring(8, str_archivo.Length() - 9)
            End If


            Using Stream As New FileStream("C:\reportes_pdf\" + lstMeses(Integer.Parse(dt_Fecha_Inicio.Month) - 1).ToString() + "\Dia" + dt_Fecha_Inicio.Day.ToString() + "\" + turno + "\" & "Pre_" & str_archivo + " " + carrilTemp & ".pdf", FileMode.Create)
                Stream.Write(Bytes, 0, Bytes.Length)
                Stream.Close()
            End Using
            '------------------------------------Codigo para Generar EXCEL-------------------------------------------------------------------

            'Ruta  para generar el archivo excel
            If Not Directory.Exists("c:\reportes_xls\" + lstMeses(Integer.Parse(dt_Fecha_Inicio.Month) - 1).ToString() + "\Dia" + dt_Fecha_Inicio.Day.ToString() + "\" + turno + "\") Then
                Directory.CreateDirectory("c:\reportes_xls\" + lstMeses(Integer.Parse(dt_Fecha_Inicio.Month) - 1).ToString() + "\Dia" + dt_Fecha_Inicio.Day.ToString() + "\" + turno + "\")
            End If

            Dim Bytes1() As Byte = ReportViewer1.LocalReport.Render("Excel", "", Nothing, Nothing, Nothing, Nothing, Nothing)
            Dim str_archivo2 As String

            If bl_varios_turnos = False Then
                str_archivo2 = Format(h_inicio_turno, "yyyyMMddHHmmss") & "_" & No_Turno & "_" & "_" & str_MATRICULE
            Else
                str_archivo2 = Format(hr_fecha_ini_varios_turnos, "yyyyMMddHHmmss") & "_" & No_Turno & "_" & "_" & str_MATRICULE
            End If

            If banFechaOp And fechaOpeTemp <> "" Then
                str_archivo2 = fechaOpeTemp + str_archivo.Substring(8, str_archivo.Length() - 9)
            End If

            Using Stream As New FileStream("C:\reportes_xls\" + lstMeses(Integer.Parse(dt_Fecha_Inicio.Month) - 1).ToString() + "\Dia" + dt_Fecha_Inicio.Day.ToString() + "\" + turno + "\" & "Pre_" & str_archivo2 + " " + carrilTemp & ".xls", FileMode.Create)
                Stream.Write(Bytes1, 0, Bytes1.Length)
                Stream.Close()
            End Using
            '-------------------------------------------------------------------------------------------------------


        Catch ex As Exception
            MsgBox(ex.Message)
        End Try



    End Sub

    Private Sub BITACORA_DE_OPERACION()

        Dim strQuerys As String
        Dim odataSetReporte As New DataSet
        Dim oDataTableReporte As DataTable = New DataTable("tabla_reporte")
        Dim oDataColumnaReporte As DataColumn
        Dim oDatarowReporte As DataRow

        Dim cont As Integer



        ReportViewer1.LocalReport.DataSources.Clear()
        ReportViewer1.LocalReport.ReportEmbeddedResource = "rptBitacora_Operacion.rdlc"

        Dim conteo_minutos As Double

        Dim conteo_minutos_A As Double
        Dim conteo_minutos_B As Double
        Dim conteo_minutos_Cerrados As Double

        'conteo carriles
        Dim no_carriles As Double

        Dim no_carriles_A_abierto As Double
        Dim no_carriles_A_cerrado As Double

        Dim no_carriles_B_Abierto As Double
        Dim no_carriles_B_Cerrado As Double

        Dim no_carriles_old As Double
        Dim fecha_carriles As Integer
        Dim fecha_carriles_old As Integer
        Dim turno_carriles As Integer
        Dim turno_carriles_old As Integer
        Dim bl_conteo_carriles As Boolean = False

        ' Dim conteo_minutos_cerrados As Double
        Dim bl_conteo_carriles_cerrados As Boolean = False
        Dim no_carriles_cerrados As Double
        Dim turno_carriles_old_cerrados As Integer
        Dim turno_carriles_cerrados As Integer



        objControl.agregar_datacolum(oDataColumnaReporte, 3, "Fecha_Operacion")
        oDataTableReporte.Columns.Add(oDataColumnaReporte)

        objControl.agregar_datacolum(oDataColumnaReporte, 3, "Hora_Apertura")
        oDataTableReporte.Columns.Add(oDataColumnaReporte)

        objControl.agregar_datacolum(oDataColumnaReporte, 2, "No_Turno")
        oDataTableReporte.Columns.Add(oDataColumnaReporte)

        objControl.agregar_datacolum(oDataColumnaReporte, 3, "Fecha_Final")
        oDataTableReporte.Columns.Add(oDataColumnaReporte)

        objControl.agregar_datacolum(oDataColumnaReporte, 3, "Hora_Cierre")
        oDataTableReporte.Columns.Add(oDataColumnaReporte)

        objControl.agregar_datacolum(oDataColumnaReporte, 2, "No_De_Carril")
        oDataTableReporte.Columns.Add(oDataColumnaReporte)

        objControl.agregar_datacolum(oDataColumnaReporte, 2, "No_De_Empleado")
        oDataTableReporte.Columns.Add(oDataColumnaReporte)

        objControl.agregar_datacolum(oDataColumnaReporte, 2, "Operacion")
        oDataTableReporte.Columns.Add(oDataColumnaReporte)

        objControl.agregar_datacolum(oDataColumnaReporte, 2, "No_Control_Preliquidacion")
        oDataTableReporte.Columns.Add(oDataColumnaReporte)

        objControl.agregar_datacolum(oDataColumnaReporte, 2, "Observaciones")
        oDataTableReporte.Columns.Add(oDataColumnaReporte)

        odataSetReporte.Tables.Add(oDataTableReporte)

        strQuerys = strLinea


        strQuerys = "SELECT	FIN_POSTE.Id_Gare, " &
  "TYPE_VOIE.libelle_court_voie_L2, " &
   "Voie, " &
 "'zzz', " &
   "TO_CHAR(Numero_Poste,'FM09'), " &
   "TO_CHAR(Date_Fin_Poste,'MM/DD/YY'), " &
   "TO_CHAR(Date_Fin_Poste,'HH24:MI'), " &
   "Matricule, " &
   "Sac, " &
   "FIN_POSTE.Id_Voie, " &
   "DATE_DEBUT_POSTE,Date_Fin_Poste, " &
   "TO_CHAR(Date_Debut_Poste,'YYYYMMDDHH24MISS'), " &
   "TO_CHAR(Date_Fin_Poste,'YYYYMMDDHH24MISS') " &
  ",TYPE_VOIE.libelle_court_voie " &
  ",FIN_POSTE_CPT22, " &
  "ROUND((DATE_FIN_POSTE - DATE_DEBUT_POSTE) * (60 * 24), 2) AS time_in_minutes " &
 "FROM 	TYPE_VOIE, " &
   "FIN_POSTE, " &
   "SITE_GARE " &
 "WHERE	FIN_POSTE.Id_Voie	=	TYPE_VOIE.Id_Voie " &
  "AND FIN_POSTE.id_reseau	= 	SITE_GARE.id_Reseau " &
 "AND	FIN_POSTE.id_Gare	=	SITE_GARE.id_Gare " &
  "AND	SITE_GARE.id_reseau		= 	'01' " &
 "AND	SITE_GARE.id_Site		=	'" & id_plaza_cobro & "' " &
 "AND (Id_Mode_Voie IN (1,7,9)) " &
 "AND ((Date_Fin_Poste >= TO_DATE('" & Format(dt_Fecha_Inicio, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) " &
 "AND (Date_Fin_Poste <= TO_DATE('" & Format(dt_Fecha_Fin, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS'))) " &
 "AND (FIN_POSTE.Id_Voie = '1' " &
  "OR FIN_POSTE.Id_Voie = '2' " &
  "OR FIN_POSTE.Id_Voie = '3' " &
  "OR FIN_POSTE.Id_Voie = '4' " &
  "OR FIN_POSTE.Id_Voie = 'X' " &
") " &
 "ORDER BY Id_Gare, " &
    "Id_Voie, " &
    "Voie, " &
    "Date_Debut_Poste," &
    "Date_Fin_Poste, " &
    "Numero_Poste, " &
    "Matricule " &
   ",Sac"

        If objQuerys.QueryDataSet(strQuerys, "FIN_POSTE") = 1 Then

            'no_carriles = oDataSet.Tables("FIN_POSTE").Rows.Count

            For cont = 0 To oDataSet.Tables("FIN_POSTE").Rows.Count - 1

                oDataRow = oDataSet.Tables("FIN_POSTE").Rows.Item(cont)

                oDatarowReporte = oDataTableReporte.NewRow
                '----------------------
                oDatarowReporte("Fecha_Operacion") = Format(oDataRow("DATE_DEBUT_POSTE"), "MM/dd/yyyy")
                oDatarowReporte("Hora_Apertura") = Format(oDataRow("DATE_DEBUT_POSTE"), "HH:mm:ss")

                If CInt(Format(oDataRow("DATE_DEBUT_POSTE"), "HH")) >= 6 And CInt(Format(oDataRow("DATE_DEBUT_POSTE"), "HH")) < 14 Then
                    'oDatarowReporte("No_Turno") = gl_turno_2
                    oDatarowReporte("No_Turno") = "2 MATUTINO"
                    turno_carriles = 2
                ElseIf CInt(Format(oDataRow("DATE_DEBUT_POSTE"), "HH")) >= 14 And CInt(Format(oDataRow("DATE_DEBUT_POSTE"), "HH")) < 22 Then
                    'oDatarowReporte("No_Turno") = gl_turno_3
                    oDatarowReporte("No_Turno") = "3 VESPERTINO"
                    turno_carriles = 3
                ElseIf CInt(Format(oDataRow("DATE_DEBUT_POSTE"), "HH")) >= 22 Then
                    'oDatarowReporte("No_Turno") = gl_turno_1
                    oDatarowReporte("No_Turno") = "1 NOCTURNO"
                    turno_carriles = 1
                ElseIf CInt(Format(oDataRow("DATE_DEBUT_POSTE"), "HH")) < 6 Then
                    'oDatarowReporte("No_Turno") = gl_turno_1

                End If



                oDatarowReporte("Fecha_Final") = Format(oDataRow("Date_Fin_Poste"), "MM/dd/yyyy")
                oDatarowReporte("Hora_Cierre") = Format(oDataRow("Date_Fin_Poste"), "HH:mm:ss")
                oDatarowReporte("No_De_Carril") = oDataRow("Voie")
                oDatarowReporte("No_De_Empleado") = oDataRow("MATRICULE")

                oDatarowReporte("No_Control_Preliquidacion") = IIf(IsDBNull(oDataRow("Sac")), "", oDataRow("Sac"))

                conteo_minutos = conteo_minutos + DateDiff(DateInterval.Minute, oDataRow("DATE_DEBUT_POSTE"), oDataRow("Date_Fin_Poste"))

                oDatarowReporte("Operacion") = "" 'DateDiff(DateInterval.Minute, oDataRow("DATE_DEBUT_POSTE"), oDataRow("Date_Fin_Poste"))
                oDatarowReporte("No_Control_Preliquidacion") = oDataRow("Sac")
                oDatarowReporte("Observaciones") = "Abierto" 'oDataRow("time_in_minutes")
                'oDatarowReporte("") = ""

                oDataTableReporte.Rows.Add(oDatarowReporte)

                If bl_conteo_carriles = False Then

                    If Mid(oDataRow("Voie"), 1, 1) = "A" Then
                        no_carriles_A_abierto = no_carriles_A_abierto + 1
                    ElseIf Mid(oDataRow("Voie"), 1, 1) = "B" Then
                        no_carriles_B_Abierto = no_carriles_B_Abierto + 1
                    End If

                    no_carriles = no_carriles + 1
                    bl_conteo_carriles = True
                    turno_carriles_old = turno_carriles
                Else

                    If Mid(oDataRow("Voie"), 1, 1) = "A" Then
                        no_carriles_A_abierto = no_carriles_A_abierto + 1
                        conteo_minutos_A = conteo_minutos_A + DateDiff(DateInterval.Minute, oDataRow("DATE_DEBUT_POSTE"), oDataRow("Date_Fin_Poste"))
                    ElseIf Mid(oDataRow("Voie"), 1, 1) = "B" Then
                        no_carriles_B_Abierto = no_carriles_B_Abierto + 1
                        conteo_minutos_B = conteo_minutos_B + DateDiff(DateInterval.Minute, oDataRow("DATE_DEBUT_POSTE"), oDataRow("Date_Fin_Poste"))
                    End If

                    If turno_carriles <> turno_carriles_old Then
                        no_carriles = no_carriles + 1
                    End If
                    turno_carriles_old = turno_carriles
                End If
            Next

        End If


        'CERRADOS
        strQuerys = "SELECT ID_NETWORK, ID_PLAZA,ID_LANE, LANE, BEGIN_DHM, END_DHM, BAG_NUMBER, REPORT_FLAG, GENERATION_DHM " &
         "FROM CLOSED_LANE_REPORT, SITE_GARE " &
         "where " &
         "CLOSED_LANE_REPORT.ID_PLAZA	=	SITE_GARE.id_Gare " &
          "AND	SITE_GARE.id_Site		=	'" & id_plaza_cobro & "' " &
          "AND ((BEGIN_DHM >= TO_DATE('" & Format(dt_Fecha_Inicio, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) " &
        "AND (END_DHM <= TO_DATE('" & Format(dt_Fecha_Fin, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS'))) " &
        "order by BEGIN_DHM"

        If objQuerys.QueryDataSet(strQuerys, "CLOSED_LANE_REPORT") = 1 Then

            For cont = 0 To oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Count - 1

                oDataRow = oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Item(cont)

                If DateDiff(DateInterval.Minute, oDataRow("BEGIN_DHM"), oDataRow("END_DHM")) >= 1 Then

                    'End If

                    oDatarowReporte = oDataTableReporte.NewRow
                    '----------------------
                    oDatarowReporte("Fecha_Operacion") = Format(oDataRow("BEGIN_DHM"), "MM/dd/yyyy")
                    oDatarowReporte("Hora_Apertura") = Format(oDataRow("BEGIN_DHM"), "HH:mm:ss")

                    If CInt(Format(oDataRow("BEGIN_DHM"), "HH")) >= 6 And CInt(Format(oDataRow("BEGIN_DHM"), "HH")) < 14 Then
                        'oDatarowReporte("No_Turno") = gl_turno_2
                        oDatarowReporte("No_Turno") = "2 MATUTINO"
                        turno_carriles_cerrados = 2
                    ElseIf CInt(Format(oDataRow("BEGIN_DHM"), "HH")) >= 14 And CInt(Format(oDataRow("BEGIN_DHM"), "HH")) < 22 Then
                        'oDatarowReporte("No_Turno") = gl_turno_3
                        oDatarowReporte("No_Turno") = "3 VESPERTINO"
                        turno_carriles_cerrados = 3
                    ElseIf CInt(Format(oDataRow("BEGIN_DHM"), "HH")) >= 22 Then
                        'oDatarowReporte("No_Turno") = gl_turno_1
                        oDatarowReporte("No_Turno") = "1 NOCTURNO"
                        turno_carriles_cerrados = 1
                    ElseIf CInt(Format(oDataRow("BEGIN_DHM"), "HH")) < 6 Then
                        'oDatarowReporte("No_Turno") = gl_turno_1

                    End If



                    oDatarowReporte("Fecha_Final") = Format(oDataRow("END_DHM"), "MM/dd/yyyy")
                    oDatarowReporte("Hora_Cierre") = Format(oDataRow("END_DHM"), "HH:mm:ss")
                    oDatarowReporte("No_De_Carril") = oDataRow("LANE")
                    oDatarowReporte("No_De_Empleado") = "" 'oDataRow("MATRICULE")

                    oDatarowReporte("No_Control_Preliquidacion") = "" 'IIf(IsDBNull(oDataRow("Sac")), "", oDataRow("Sac"))

                    'conteo_minutos_cerrados = conteo_minutos_cerrados + DateDiff(DateInterval.Minute, oDataRow("BEGIN_DHM"), oDataRow("END_DHM"))

                    oDatarowReporte("Operacion") = "" 'DateDiff(DateInterval.Minute, oDataRow("BEGIN_DHM"), oDataRow("END_DHM"))
                    'oDatarowReporte("No_Control_Preliquidacion") = ""
                    oDatarowReporte("Observaciones") = "Cerrado"
                    'oDatarowReporte("") = ""

                    oDataTableReporte.Rows.Add(oDatarowReporte)

                    If bl_conteo_carriles_cerrados = False Then

                        If Mid(oDataRow("LANE"), 1, 1) = "A" Then
                            no_carriles_A_cerrado = no_carriles_A_cerrado + 1
                        ElseIf Mid(oDataRow("LANE"), 1, 1) = "B" Then
                            no_carriles_B_Cerrado = no_carriles_B_Cerrado + 1
                        End If

                        conteo_minutos_Cerrados = conteo_minutos_Cerrados + DateDiff(DateInterval.Minute, oDataRow("BEGIN_DHM"), oDataRow("END_DHM"))

                        no_carriles_cerrados = no_carriles_cerrados + 1
                        bl_conteo_carriles_cerrados = True
                        turno_carriles_old_cerrados = turno_carriles_cerrados
                    Else

                        If Mid(oDataRow("LANE"), 1, 1) = "A" Then
                            no_carriles_A_cerrado = no_carriles_A_cerrado + 1
                        ElseIf Mid(oDataRow("LANE"), 1, 1) = "B" Then
                            no_carriles_B_Cerrado = no_carriles_B_Cerrado + 1
                        End If

                        conteo_minutos_Cerrados = conteo_minutos_Cerrados + DateDiff(DateInterval.Minute, oDataRow("BEGIN_DHM"), oDataRow("END_DHM"))

                        If turno_carriles_cerrados <> turno_carriles_old_cerrados Then
                            no_carriles_cerrados = no_carriles_cerrados + 1
                        End If
                        turno_carriles_old_cerrados = turno_carriles_cerrados
                    End If

                End If

            Next

        End If

        '1:      .myDataTable.DefaultView.Sort = "PublishDate ASC"
        'DataView dv = sDataSet.Tables("Table1").DefaultView;
        'odataSetReporte.Tables("tabla_reporte").DefaultView.Sort = "Hora_Apertura"

        Dim rds As New ReportDataSource
        rds.Name = "DataSet1"
        rds.Value = odataSetReporte.Tables("tabla_reporte")

        ReportViewer1.LocalReport.DataSources.Add(rds)



        Dim par_no_carriles_op_cuerpo_a As New ReportParameter()
        Dim par_no_carriles_op_cuerpo_a_horas As New ReportParameter()
        Dim par_no_carriles_op_cuerpo_b As New ReportParameter()
        Dim par_no_carriles_op_cuerpo_b_horas As New ReportParameter()
        Dim no_carriles_op_ambos_cuerpos As New ReportParameter()
        Dim no_carriles_op_ambos_cuerpos_horas As New ReportParameter()


        Dim par_no_carriles_cerrados As New ReportParameter()
        Dim par_no_carriles_cerrados_horas As New ReportParameter()

        Dim par_txtPlazaDeCobro As New ReportParameter()
        Dim par_txtFecInicial As New ReportParameter()
        Dim par_txtFecFinal As New ReportParameter()
        Dim par_txtDelegacion As New ReportParameter()




        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("txtPlazaDeCobro")
        'objText.Text = str_Plaza_Cobro

        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("txtFecInicial")
        'objText.Text = Format(CDate(dt_Fecha_Inicio), "MM/dd/yyyy HH:mm:ss")

        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("txtFecFinal")
        'objText.Text = Format(CDate(dt_Fecha_Fin), "MM/dd/yyyy HH:mm:ss")

        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("txtDelegacion")
        'objText.Text = str_delegacion

        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("no_carriles_op_cuerpo_b")
        'objText.Text = "1"

        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("no_carriles_op_cuerpo_b_horas")
        'objText.Text = Format(conteo_minutos / 60, "###,##0.00")


        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("no_carriles_op_cuerpo_a")
        'objText.Text = ""

        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("no_carriles_op_cuerpo_a_horas")
        'objText.Text = ""

        ''
        ''no_carriles_op_ambos_cuerpos
        ''no_carriles_op_ambos_cuerpos_horas
        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("no_carriles_op_ambos_cuerpos")
        'objText.Text = "1"

        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("no_carriles_op_ambos_cuerpos_horas")
        'objText.Text = Format(conteo_minutos / 60, "###,##0.00")





        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("txtPlazaDeCobro")
        'objText.Text = str_Plaza_Cobro
        par_txtPlazaDeCobro.Name = "par_txtPlazaDeCobro"
        par_txtPlazaDeCobro.Values.Add(str_Plaza_Cobro)

        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("txtFecInicial")
        'objText.Text = Format(CDate(dt_Fecha_Inicio), "MM/dd/yyyy HH:mm:ss")
        par_txtFecInicial.Name = "par_txtFecInicial"
        par_txtFecInicial.Values.Add(Format(CDate(dt_Fecha_Inicio), "MM/dd/yyyy HH:mm:ss"))

        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("txtFecFinal")
        'objText.Text = Format(CDate(dt_Fecha_Fin), "MM/dd/yyyy HH:mm:ss")
        par_txtFecFinal.Name = "par_txtFecFinal"
        par_txtFecFinal.Values.Add(Format(CDate(dt_Fecha_Fin), "MM/dd/yyyy HH:mm:ss"))

        'objText = rpt_reporte.ReportDefinition.ReportObjects.Item("txtDelegacion")
        'objText.Text = str_delegacion
        par_txtDelegacion.Name = "par_txtDelegacion"
        par_txtDelegacion.Values.Add(str_delegacion)


        par_no_carriles_op_cuerpo_a.Name = "par_no_carriles_op_cuerpo_a"
        par_no_carriles_op_cuerpo_a.Values.Add(no_carriles_A_abierto)

        par_no_carriles_op_cuerpo_a_horas.Name = "par_no_carriles_op_cuerpo_a_horas"
        par_no_carriles_op_cuerpo_a_horas.Values.Add(Format(conteo_minutos_A / 60, "###,##0.00"))

        par_no_carriles_op_cuerpo_b.Name = "par_no_carriles_op_cuerpo_b"
        par_no_carriles_op_cuerpo_b.Values.Add(no_carriles_B_Abierto)

        par_no_carriles_op_cuerpo_b_horas.Name = "par_no_carriles_op_cuerpo_b_horas"
        par_no_carriles_op_cuerpo_b_horas.Values.Add(Format(conteo_minutos_B / 60, "###,##0.00"))

        no_carriles_op_ambos_cuerpos.Name = "no_carriles_op_ambos_cuerpos"
        'no_carriles_op_ambos_cuerpos.Values.Add(no_carriles)
        no_carriles_op_ambos_cuerpos.Values.Add("")

        no_carriles_op_ambos_cuerpos_horas.Name = "no_carriles_op_ambos_cuerpos_horas"
        'no_carriles_op_ambos_cuerpos_horas.Values.Add(Format(conteo_minutos / 60, "###,##0.00"))
        no_carriles_op_ambos_cuerpos_horas.Values.Add("")

        'no_carriles_cerrados()
        'no_carriles_cerrados_horas()
        par_no_carriles_cerrados.Name = "no_carriles_cerrados"
        par_no_carriles_cerrados.Values.Add(no_carriles_A_cerrado + no_carriles_B_Cerrado)

        par_no_carriles_cerrados_horas.Name = "no_carriles_cerrados_horas"
        par_no_carriles_cerrados_horas.Values.Add(Format(conteo_minutos_Cerrados / 60, "###,##0.00"))

        Dim parameters() As ReportParameter = {par_no_carriles_op_cuerpo_a, par_no_carriles_op_cuerpo_a_horas, par_no_carriles_op_cuerpo_b, par_no_carriles_op_cuerpo_b_horas, no_carriles_op_ambos_cuerpos, no_carriles_op_ambos_cuerpos_horas, par_txtPlazaDeCobro, par_txtFecInicial, par_txtFecFinal, par_txtDelegacion, par_no_carriles_cerrados, par_no_carriles_cerrados_horas}
        ReportViewer1.LocalReport.SetParameters(parameters)


        ReportViewer1.SetDisplayMode(DisplayMode.PrintLayout)
        Me.ReportViewer1.RefreshReport()


        'Dim Bytes() As Byte = ReportViewer1.LocalReport.Render("PDF", "", Nothing, Nothing, Nothing, Nothing, Nothing)

        'Using Stream As New FileStream("C:\sydeco\dlo.pdf", FileMode.Create)
        '    Stream.Write(Bytes, 0, Bytes.Length)
        '    Stream.Close()
        'End Using




    End Sub

    'cerrados

    Private Sub Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular_cerrados(ByVal int_reporte As Integer)

        'tabla 1
        Dim strQuerys As String
        Dim odataSetReporte As New DataSet
        Dim oDataTableReporte As DataTable = New DataTable("tabla_reporte")
        Dim oDataColumnaReporte As DataColumn
        Dim oDatarowReporte As DataRow

        Dim odataSetReporte_total As New DataSet
        Dim oDataTableReporte_total As DataTable = New DataTable("tabla_reporte_total")
        Dim oDataColumnaReporte_total As DataColumn
        Dim oDatarowReporte_total As DataRow

        'tabla 2
        '------------------
        Dim odataSetReporte_2 As New DataSet
        Dim oDataTableReporte_2 As DataTable = New DataTable("tabla_reporte_2")
        Dim oDataColumnaReporte_2 As DataColumn
        Dim oDatarowReporte_2 As DataRow

        Dim odataSetReporte_total_2 As New DataSet
        Dim oDataTableReporte_total_2 As DataTable = New DataTable("tabla_reporte_total_2")
        Dim oDataColumnaReporte_total_2 As DataColumn
        Dim oDatarowReporte_total_2 As DataRow
        '------------------
        'tabla 3
        '------------------
        Dim odataSetReporte_3 As New DataSet
        Dim oDataTableReporte_3 As DataTable = New DataTable("tabla_reporte_3")
        Dim oDataColumnaReporte_3 As DataColumn
        Dim oDatarowReporte_3 As DataRow

        Dim odataSetReporte_total_3 As New DataSet
        Dim oDataTableReporte_total_3 As DataTable = New DataTable("tabla_reporte_total_3")
        Dim oDataColumnaReporte_total_3 As DataColumn
        Dim oDatarowReporte_total_3 As DataRow

        'tabla 4
        '------------------
        Dim odataSetReporte_4 As New DataSet
        Dim oDataTableReporte_4 As DataTable = New DataTable("tabla_reporte_4")
        Dim oDataColumnaReporte_4 As DataColumn
        Dim oDatarowReporte_4 As DataRow

        Dim odataSetReporte_total_4 As New DataSet
        Dim oDataTableReporte_total_4 As DataTable = New DataTable("tabla_reporte_total_4")
        Dim oDataColumnaReporte_total_4 As DataColumn
        Dim oDatarowReporte_total_4 As DataRow
        '------------------

        'tabla 5
        '------------------
        Dim odataSetReporte_5 As New DataSet
        Dim oDataTableReporte_5 As DataTable = New DataTable("tabla_reporte_5")
        Dim oDataColumnaReporte_5 As DataColumn
        Dim oDatarowReporte_5 As DataRow

        Dim odataSetReporte_total_5 As New DataSet
        Dim oDataTableReporte_total_5 As DataTable = New DataTable("tabla_reporte_total_5")
        Dim oDataColumnaReporte_total_5 As DataColumn
        Dim oDatarowReporte_total_5 As DataRow
        '------------------

        'tabla 6
        '------------------
        Dim odataSetReporte_6 As New DataSet
        Dim oDataTableReporte_6 As DataTable = New DataTable("tabla_reporte_6")
        Dim oDataColumnaReporte_6 As DataColumn
        Dim oDatarowReporte_6 As DataRow

        Dim odataSetReporte_total_6 As New DataSet
        Dim oDataTableReporte_total_6 As DataTable = New DataTable("tabla_reporte_total_6")
        Dim oDataColumnaReporte_total_6 As DataColumn
        Dim oDatarowReporte_total_6 As DataRow


        'tabla 7
        '------------------
        Dim odataSetReporte_7 As New DataSet
        Dim oDataTableReporte_7 As DataTable = New DataTable("tabla_reporte_7")
        Dim oDataColumnaReporte_7 As DataColumn
        Dim oDatarowReporte_7 As DataRow

        Dim odataSetReporte_total_7 As New DataSet
        Dim oDataTableReporte_total_7 As DataTable = New DataTable("tabla_reporte_total_7")
        Dim oDataColumnaReporte_total_7 As DataColumn
        Dim oDatarowReporte_total_7 As DataRow

        'tabla 8
        '------------------
        Dim odataSetReporte_8 As New DataSet
        Dim oDataTableReporte_8 As DataTable = New DataTable("tabla_reporte_8")
        Dim oDataColumnaReporte_8 As DataColumn
        Dim oDatarowReporte_8 As DataRow

        Dim odataSetReporte_total_8 As New DataSet
        Dim oDataTableReporte_total_8 As DataTable = New DataTable("tabla_reporte_total_8")
        Dim oDataColumnaReporte_total_8 As DataColumn
        Dim oDatarowReporte_total_8 As DataRow

        'tabla 9
        '------------------
        Dim odataSetReporte_9 As New DataSet
        Dim oDataTableReporte_9 As DataTable = New DataTable("tabla_reporte_9")
        Dim oDataColumnaReporte_9 As DataColumn
        Dim oDatarowReporte_9 As DataRow

        Dim odataSetReporte_total_9 As New DataSet
        Dim oDataTableReporte_total_9 As DataTable = New DataTable("tabla_reporte_total_9")
        Dim oDataColumnaReporte_total_9 As DataColumn
        Dim oDatarowReporte_total_9 As DataRow

        'tabla 10 tarjetas bancarias
        '------------------
        Dim odataSetReporte_10 As New DataSet
        Dim oDataTableReporte_10 As DataTable = New DataTable("tabla_reporte_10")
        Dim oDataColumnaReporte_10 As DataColumn
        Dim oDatarowReporte_10 As DataRow

        Dim odataSetReporte_total_10 As New DataSet
        Dim oDataTableReporte_total_10 As DataTable = New DataTable("tabla_reporte_total_10")
        Dim oDataColumnaReporte_total_10 As DataColumn
        Dim oDatarowReporte_total_10 As DataRow


        Dim strGrupo As String
        Dim strConcepto As String



        '---------------------------------------------------
        '--------------------------------------------------
        Dim strQuerys_varios_cortes As String

        'Dim hr_fecha_ini_varios_turnos As Date
        'Dim hr_fecha_fin_varios_turnos As Date
        'Dim bl_varios_turnos As Boolean = False

        Dim str_id_RESEAU As String
        Dim int_id_gare As Integer
        Dim str_id_voie As String
        Dim int_id_voie As Integer
        Dim int_numero_poste As Integer
        Dim dt_ini_poste As Date
        Dim dt_fin_poste As Date
        Dim str_MATRICULE As String

        Dim str_cajero As String = str_Cajero_Receptor
        Dim id_plaza_cobro_local As String = id_plaza_cobro

        Dim h_inicio_turno As Date
        Dim h_fin_turno As Date

        Dim dvEvento As DataView
        Dim dvEventoDos As DataView
        Dim dvTarifa As DataView

        'Dim strCarril As String
        Dim IdCarril As Integer

        Dim cont As Integer

        Dim db_tot_14 As Double
        Dim db_tot_15 As Double
        Dim db_tot_16 As Double
        Dim db_tot_18 As Double
        Dim db_tot_20 As Double
        Dim db_tot_22 As Double
        Dim db_tot_24 As Double
        Dim db_tot_26 As Double
        Dim db_tot_28 As Double
        Dim db_tot_30 As Double
        Dim db_tot_32 As Double

        Dim db_tot_35 As Double
        Dim db_tot_36 As Double

        Dim db_tot_38 As Double

        Dim db_tot_45 As Double
        Dim db_tot_451 As Double
        Dim db_tot_452 As Double
        Dim db_tot_453 As Double

        Dim db_tot_46 As Double
        Dim db_tot_461 As Double
        Dim db_tot_462 As Double
        Dim db_tot_463 As Double

        Dim db_tot_47 As Double
        Dim db_tot_471 As Double
        Dim db_tot_472 As Double
        Dim db_tot_473 As Double

        Dim db_tot_48 As Double
        Dim db_tot_49 As Double
        Dim db_tot_50 As Double

        Dim db_tot_53 As Double
        Dim db_tot_531 As Double
        Dim db_tot_532 As Double

        Dim db_tot_54 As Double
        Dim db_tot_541 As Double
        Dim db_tot_542 As Double

        Dim db_tot_55 As Double
        Dim db_tot_56 As Double
        Dim db_tot_57 As Double
        Dim db_tot_58 As Double


        Dim db_tot_77 As Double
        Dim db_tot_78 As Double
        Dim db_tot_80 As Double
        Dim db_tot_81 As Double


        Dim db_tot_61 As Double
        Dim db_tot_63 As Double


        Dim db_tot_67 As Double
        Dim db_tot_69 As Double

        Dim db_tot_73 As Double
        Dim db_tot_75 As Double

        'tarjetas bancarias
        Dim db_tot_146 As Double
        Dim db_tot_1461 As Double


        Dim db_tot_147 As Double
        Dim db_tot_1471 As Double


        Dim db_tot_148 As Double
        Dim db_tot_149 As Double
        Dim db_tot_150 As Double


        Dim int_version_tarifa As Double
        Dim dbl_tarifa_excedentes_asignada As Double
        'int_reporte
        'cajero-receptor = 1
        'turno = 2
        'caseta = 3

        Dim No_Turno As String

        Dim loc_operador As String
        Dim loc_id_site As Integer
        'Dim loc_id_gare As Integer

        '---------------------------------------------------
        '--------------------------------------------------
        Try

            ReportViewer2.LocalReport.DataSources.Clear()
            ReportViewer2.LocalReport.ReportEmbeddedResource = "rpt_Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular.rdlc"


            'reporte cajero receptor
            If int_reporte = 1 Then

                loc_operador = str_Cajero_Receptor
                loc_id_site = id_plaza_cobro
                '--------------------------------------------------------
                '--------------------------------------------------------
                'verifico cuantos cortes tiene en ese turno CERRADOS
                strQuerys = "SELECT ID_NETWORK, ID_PLAZA,ID_LANE, LANE, BEGIN_DHM, END_DHM, BAG_NUMBER, REPORT_FLAG, GENERATION_DHM " &
 "FROM CLOSED_LANE_REPORT, SITE_GARE " &
 "where " &
 "CLOSED_LANE_REPORT.ID_PLAZA	=	SITE_GARE.id_Gare " &
  "AND	SITE_GARE.id_Site		=	'" & loc_id_site & "' "


                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "5 MATUTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "6 VESPERTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "4 NOCTURNO"
                End If

                strQuerys = strQuerys & "AND (BEGIN_DHM >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(BEGIN_DHM <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
           "order by BEGIN_DHM"

                If objQuerys.QueryDataSet(strQuerys, "CLOSED_LANE_REPORT") = 1 Then

                    'If oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Count = 1 Then
                    'ElseIf oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Count > 1 Then

                    'Dim frmListas As New frmLineas
                    'objControl.limpia_Catalogos()
                    'frmListas.Tag = 5

                    strLinea = strQuerys
                    If strCarril = Nothing Then
                        Exit Sub
                    End If

                    'frmListas.ShowDialog()
                    'If Trim(strLinea1) <> "" Then

                    'bl_varios_turnos = True

                    'hr_fecha_ini_varios_turnos = CDate(strLinea1)
                    'hr_fecha_fin_varios_turnos = CDate(strLinea2)
                    'strCarril = strLinea3
                    'loc_id_gare = strLinea4



                    'Else
                    '    Me.Close()
                    '    Exit Sub
                    'End If

                    'End If

                End If

                'fin de verifico cuantos cortes tiene en ese turno




                '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Inicio
                'DATOS GENERALES



                Dim par1 As New ReportParameter()
                Dim par2 As New ReportParameter()
                Dim par3 As New ReportParameter()
                Dim par4 As New ReportParameter()
                Dim par5 As New ReportParameter()
                Dim par6 As New ReportParameter()
                Dim par7 As New ReportParameter()
                Dim par8 As New ReportParameter()
                Dim par9 As New ReportParameter()
                Dim par10 As New ReportParameter()
                Dim par11 As New ReportParameter()
                Dim parTituloCajeroReceptor As New ReportParameter()
                Dim parTituloNoCarril As New ReportParameter()
                Dim parTituloHoraInicial As New ReportParameter()
                Dim parTituloHoraFinal As New ReportParameter()
                Dim parTituloFolioInicial As New ReportParameter()
                Dim parTituloFolioFinal As New ReportParameter()
                Dim parTituloTurno As New ReportParameter()

                Dim parTituloNoNombreDelegacion As New ReportParameter()
                Dim parNoNombreCaseta As New ReportParameter()
                Dim parFechaOperacion As New ReportParameter()
                Dim parFechaEdicion As New ReportParameter()
                Dim parTituloReporte As New ReportParameter()





                par1.Name = "par1"
                par1.Values.Add(str_delegacion)

                par3.Name = "par3"
                par3.Values.Add(strCarril)

                str_id_voie = strCarril
                int_id_voie = IdCarril
                'int_numero_poste = CInt(oDataRow("Expr1"))

                par4.Name = "par4"
                par4.Values.Add(No_Turno)



                par6.Name = "par6"
                par6.Values.Add(Format((hr_fecha_fin_varios_turnos), "dd/MM/yyyy"))

                par8.Name = "par8"
                'par8.Values.Add(Format((hr_fecha_ini_varios_turnos), "MM/dd/yyyy HH:mm:ss"))
                par8.Values.Add(Format((hr_fecha_ini_varios_turnos), "HH:mm:ss"))
                dt_ini_poste = Format((hr_fecha_ini_varios_turnos), "MM/dd/yyyy HH:mm:ss")

                par9.Name = "par9"
                par9.Values.Add(Format((hr_fecha_fin_varios_turnos), "HH:mm:ss"))
                'dt_fin_poste = Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy HH:mm:ss")
                dt_fin_poste = Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy HH:mm:ss")

                par10.Name = "par10"
                'par10.Values.Add(oDataRow("FOLIO_NUMBER_OPEN"))
                par10.Values.Add(0)

                par11.Name = "par11"
                ''par11.Values.Add(oDataRow("FOLIO_NUMBER_CLOSE"))
                par11.Values.Add(0)

                '                strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces, MIN(EVENT_NUMBER) AS minimo, MAX(EVENT_NUMBER) as maximo " & _
                '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
                '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
                '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
                '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                '                strQuerys = strQuerys & " " & _
                '                 "AND TRANSACTION.ID_GARE = " & loc_id_gare & " " & _
                '                 "AND VOIE = '" & strCarril & "' "

                '                If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                '                    'Dim par10 As New ReportParameter()
                '                    par10.Name = "par10"

                '                    If oDataRow("Cruces") > 0 Then
                '                        par10.Values.Add(oDataRow("minimo"))
                '                    Else
                '                        par10.Values.Add(0)
                '                    End If


                '                    'Dim par11 As New ReportParameter()
                '                    par11.Name = "par11"

                '                    If oDataRow("Cruces") > 0 Then
                '                        par11.Values.Add(oDataRow("maximo"))
                '                    Else
                '                        par11.Values.Add(0)
                '                    End If

                '                End If
                '---------------------------------




                'OPERADOR
                strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
             "FROM TABLE_PERSONNEL " &
             "WHERE Matricule = '" & loc_operador & "'"
                If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                    par7.Name = "par7"
                    par7.Values.Add(Trim(oDataRowTres("MATRICULE")) & "     " & Trim(oDataRowTres("nombre")))
                    str_MATRICULE = Trim(oDataRowTres("MATRICULE"))
                End If

                strQuerys = "SELECT  ID_RESEAU, ID_GARE, NOM_GARE, NOM_GARE_L2 " &
             "FROM GEADBA.TYPE_GARE " &
             "WHERE ID_GARE = " & loc_id_gare & ""

                If objQuerys.QueryDataSetTres(strQuerys, "TYPE_GARE") = 1 Then

                    par2.Name = "par2"


                    'par2.Values.Add(oDataRowTres("NOM_GARE"))
                    If id_plaza_cobro_local <> "08" Then
                        If id_plaza_cobro_local <> "09" Then
                            par2.Values.Add("1" & id_plaza_cobro_local & " " & oDataRowTres("NOM_GARE"))
                        Else
                            par2.Values.Add("001 BIS" & " " & oDataRowTres("NOM_GARE"))
                        End If

                    Else
                        par2.Values.Add("001" & " " & oDataRowTres("NOM_GARE"))
                    End If



                    int_id_gare = oDataRowTres("ID_GARE")

                    str_id_RESEAU = oDataRowTres("ID_RESEAU")

                End If

                'pantalla:RESUMEN DE INGRESO CAJERO




                par5.Name = "par5"
                'par5.Values.Add(Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy HH:mm:ss"))
                'par5.Values.Add(Format((hr_fecha_fin_varios_turnos), "dd/MM/yyyy"))
                par5.Values.Add(Format((dt_Fecha_Inicio), "dd/MM/yyyy"))



                parTituloCajeroReceptor.Name = "parTituloCajeroReceptor"
                parTituloCajeroReceptor.Values.Add("No. y Nombre del C-Receptor:")

                parTituloNoCarril.Name = "parTituloNoCarril"
                parTituloNoCarril.Values.Add("No.Carril:")

                parTituloHoraInicial.Name = "parTituloHoraInicial"
                parTituloHoraInicial.Values.Add("Hora Inicial:")

                parTituloHoraFinal.Name = "parTituloHoraFinal"
                parTituloHoraFinal.Values.Add("Hora Final:")

                parTituloFolioInicial.Name = "parTituloFolioInicial"
                parTituloFolioInicial.Values.Add("Folio Inicial:")

                parTituloFolioFinal.Name = "parTituloFolioFinal"
                parTituloFolioFinal.Values.Add("Folio Final:")

                parTituloTurno.Name = "porTituloTurno"
                parTituloTurno.Values.Add("No.Turno:")

                parTituloNoNombreDelegacion.Name = "parTituloNoNombreDelegacion"
                parTituloNoNombreDelegacion.Values.Add("No. y Nombre de Delegación:")

                parNoNombreCaseta.Name = "parNoNombreCaseta"
                parNoNombreCaseta.Values.Add("No. y Nombre de Caseta:")

                parFechaOperacion.Name = "parFechaOperacion"
                parFechaOperacion.Values.Add("Fecha de Operación:")

                parFechaEdicion.Name = "parFechaEdicion"
                parFechaEdicion.Values.Add("Fecha de emisión:")

                'parTituloReporte
                'REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR CAJERO-RECEPTOR
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR CAJERO-RECEPTOR DE CARRILES CERRADOS")

                Dim parameters() As ReportParameter = {par1, par2, par3, par4, par5, par6, par7, par8, par9, par10, par11, parTituloCajeroReceptor, parTituloNoCarril, parTituloHoraInicial, parTituloHoraFinal, parTituloFolioInicial, parTituloFolioFinal, parTituloTurno, parTituloNoNombreDelegacion, parNoNombreCaseta, parFechaOperacion, parFechaEdicion, parTituloReporte}
                ReportViewer2.LocalReport.SetParameters(parameters)

                'reporte turno
            ElseIf int_reporte = 2 Then


                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "5 MATUTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "6 VESPERTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "4 NOCTURNO"
                End If




                Dim parNoNombreCaseta As New ReportParameter()
                Dim par2 As New ReportParameter()

                parNoNombreCaseta.Name = "parNoNombreCaseta"
                parNoNombreCaseta.Values.Add("No. y Nombre de Delegación:")

                par2.Name = "par2"
                par2.Values.Add(str_delegacion)

                Dim parTituloCajeroReceptor As New ReportParameter()
                Dim par7 As New ReportParameter()

                parTituloCajeroReceptor.Name = "parTituloCajeroReceptor"
                parTituloCajeroReceptor.Values.Add("No. y Nombre de Caseta:")

                par7.Name = "par7"
                par7.Values.Add(str_Plaza_Cobro)

                Dim parTituloNoCarril As New ReportParameter()
                Dim par3 As New ReportParameter()

                parTituloNoCarril.Name = "parTituloNoCarril"
                parTituloNoCarril.Values.Add("No.Turno:")

                par3.Name = "par3"
                par3.Values.Add(No_Turno)

                Dim parTituloHoraInicial As New ReportParameter()

                parTituloHoraInicial.Name = "parTituloHoraInicial"
                parTituloHoraInicial.Values.Add("Tipo de Cambio Aplicado")

                Dim porTituloTurno As New ReportParameter()
                Dim par4 As New ReportParameter()

                porTituloTurno.Name = "porTituloTurno"
                porTituloTurno.Values.Add("Fecha de Operación:")

                par4.Name = "par4"

                If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    par4.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "MM/dd/yyyy"))
                Else
                    par4.Values.Add(Format(dt_ini_poste, "MM/dd/yyyy"))
                End If

                Dim parTituloHoraFinal As New ReportParameter()
                Dim par9 As New ReportParameter()

                parTituloHoraFinal.Name = "parTituloHoraFinal"
                parTituloHoraFinal.Values.Add("Fecha de emisión:")

                par9.Name = "par9"
                par9.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR TURNO  DE CARRILES CERRADOS")

                Dim parameters() As ReportParameter = {parNoNombreCaseta, par2, parTituloCajeroReceptor, par7, parTituloNoCarril, par3, parTituloHoraInicial, porTituloTurno, par4, parTituloHoraFinal, par9, parTituloReporte, parTituloReporte}
                ReportViewer2.LocalReport.SetParameters(parameters)

                'dt_ini_poste()
                'dt_fin_poste()


            ElseIf int_reporte = 3 Then

                'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")


                Dim parNoNombreCaseta As New ReportParameter()
                Dim par2 As New ReportParameter()

                parNoNombreCaseta.Name = "parNoNombreCaseta"
                parNoNombreCaseta.Values.Add("No. y Nombre de Delegación:")

                par2.Name = "par2"
                par2.Values.Add(str_delegacion)

                Dim parTituloCajeroReceptor As New ReportParameter()
                Dim par7 As New ReportParameter()

                parTituloCajeroReceptor.Name = "parTituloCajeroReceptor"
                parTituloCajeroReceptor.Values.Add("No. y Nombre de Caseta:")

                par7.Name = "par7"
                par7.Values.Add(str_Plaza_Cobro)

                'Dim parTituloNoCarril As New ReportParameter()
                'Dim par3 As New ReportParameter()

                'parTituloNoCarril.Name = "parTituloNoCarril"
                'parTituloNoCarril.Values.Add("No.Turno:")

                'par3.Name = "par3"
                'par3.Values.Add(str_Turno_block)

                Dim parTituloHoraInicial As New ReportParameter()

                parTituloHoraInicial.Name = "parTituloHoraInicial"
                parTituloHoraInicial.Values.Add("Tipo de Cambio Aplicado")

                Dim porTituloTurno As New ReportParameter()
                Dim par4 As New ReportParameter()

                porTituloTurno.Name = "porTituloTurno"
                porTituloTurno.Values.Add("Fecha de Operación:")

                par4.Name = "par4"

                'If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                '    par4.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "ddm/MM/yyyy"))
                'Else
                par4.Values.Add(Format(dt_fin_poste, "MM/dd/yyyy"))
                'End If

                Dim parTituloHoraFinal As New ReportParameter()
                Dim par9 As New ReportParameter()

                parTituloHoraFinal.Name = "parTituloHoraFinal"
                parTituloHoraFinal.Values.Add("Fecha de emisión:")

                par9.Name = "par9"
                par9.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR DIA  DE CARRILES CERRADOS")

                Dim parameters() As ReportParameter = {parNoNombreCaseta, par2, parTituloCajeroReceptor, par7, parTituloHoraInicial, porTituloTurno, par4, parTituloHoraFinal, par9, parTituloReporte, parTituloReporte}
                ReportViewer2.LocalReport.SetParameters(parameters)


            End If

            'temino titulos

            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Grupo")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Concepto")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Descricion_clase")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Numero_clase")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 1, "Numero")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "strNumero")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            odataSetReporte.Tables.Add(oDataTableReporte)
            '--------------------------------------------------------
            '--------------------------------------------------------
            'ARMO MI TIPO TARIFA
            '            strQuerys = "SELECT MAX(Version_Tarif) as version " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '            If int_reporte = 1 Then

            '                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '                "AND ID_VOIE = " & int_id_voie & " " & _
            '                "AND VOIE = '" & str_id_voie & "' "

            '            ElseIf int_reporte = 2 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            '            ElseIf int_reporte = 3 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            '            End If


            '            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

            '                If Not IsDBNull(oDataRow("version")) Then
            '                    int_version_tarifa = oDataRow("version")
            '                Else
            '                    MsgBox("No existen datos", MsgBoxStyle.Information, "Verificar")
            '                    Me.Close()
            '                    Exit Sub
            '                End If



            '            End If

            int_version_tarifa = 8

            'armo mis encabezados con las clases
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
            "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
            "FROM TYPE_CLASSE WHERE ID_CLASSE >= 1 AND ID_CLASSE <= 18"

            If objQuerys.QueryDataSetSiete(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'clases sin excedentes
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE ((ID_CLASSE >= 1 AND ID_CLASSE <= 9) or (ID_CLASSE >= 12 AND ID_CLASSE <= 15)) "

            If objQuerys.QueryDataSetCuatro(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'clases con excedentes
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE ((ID_CLASSE >= 10 AND ID_CLASSE <= 11) or (ID_CLASSE >= 16 AND ID_CLASSE <= 18)) "

            If objQuerys.QueryDataSetSeis(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'clases con excedentes asignados
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE ID_CLASSE >= 16 AND ID_CLASSE <= 17 "

            If objQuerys.QueryDataSetOcho(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'solo excedentes directos aclase
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE (ID_CLASSE >= 10 AND ID_CLASSE <= 11) or (ID_CLASSE = 18)"

            If objQuerys.QueryDataSetNueve(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'Totales Tabla 1
            'Tarifa referenciada normal C12A
            'INICIO TARIFAS
            int_version_tarifa = 5

            'TRES MARIAS 
            'int_version_tarifa = 4


            strQuerys = "SELECT " &
                "TYPE_PAIEMENT.libelle_paiement_L2 " &
                ",Prix_Cl01 ,Prix_Cl02 ,Prix_Cl03 ,Prix_Cl04 ,Prix_Cl05 ,Prix_Cl06 ,Prix_Cl07 ,Prix_Cl08 ,Prix_Cl09 " &
                ",Prix_Cl10 ,Prix_Cl11 ,Prix_Cl12 ,Prix_Cl13 ,Prix_Cl14 ,Prix_Cl15 ,Prix_Cl16 ,Prix_Cl17 ,Prix_Cl18 " &
                ",Prix_Cl19, Prix_Cl20 " &
                ",TYPE_PAIEMENT.libelle_paiement " &
                ",TABLE_TARIF.CODE " &
                "FROM TABLE_TARIF, " &
                "TYPE_PAIEMENT " &
                "WHERE   TABLE_TARIF.CODE =	TYPE_PAIEMENT.Id_Paiement(+) "

            If int_reporte = 1 Then
                'strQuerys = strQuerys & "AND TABLE_TARIF.Id_Gare = '" & int_id_gare & "' "
            End If

            strQuerys = strQuerys & "AND TABLE_TARIF.Version_Tarif = " & int_version_tarifa & " " &
           "ORDER BY TABLE_TARIF.CODE "

            If objQuerys.QueryDataSetTarifa(strQuerys, "TABLE_TARIF") = 1 Then
            End If

            dvTarifa = oDataSetTarifa.Tables("TABLE_TARIF").DefaultView
            dvTarifa.RowFilter = "CODE = 1 "

            For cont = 0 To oDataSetSiete.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSiete = oDataSetSiete.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " TARIFA REF. Normal"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowSiete("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                'oDatarowReporte("strNumero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                'oDatarowReporte("Numero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                oDatarowReporte("Numero") = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSiete("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSiete("ID_CLASSE")), oDataRowSiete("ID_CLASSE"))), "###,###,##0.00")

                oDataTableReporte.Rows.Add(oDatarowReporte)
            Next

            '-------------------------------------------------------------------------
            dvTarifa = oDataSetTarifa.Tables("TABLE_TARIF").DefaultView
            dvTarifa.RowFilter = "CODE = 2 "

            For cont = 0 To oDataSetSiete.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSiete = oDataSetSiete.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " TARIFA REF. Reducida"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowSiete("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                'oDatarowReporte("strNumero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                'oDatarowReporte("Numero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                oDatarowReporte("Numero") = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSiete("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSiete("ID_CLASSE")), oDataRowSiete("ID_CLASSE"))), "###,###,##0.00")

                oDataTableReporte.Rows.Add(oDatarowReporte)
            Next

            '-------------------------------------------------------------------------
            dvTarifa = oDataSetTarifa.Tables("TABLE_TARIF").DefaultView
            dvTarifa.RowFilter = "CODE = 72 "

            For cont = 0 To oDataSetSiete.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSiete = oDataSetSiete.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "TARIFA REF. Pago Inmediato "

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowSiete("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                'oDatarowReporte("strNumero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                'oDatarowReporte("Numero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                oDatarowReporte("Numero") = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSiete("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSiete("ID_CLASSE")), oDataRowSiete("ID_CLASSE"))), "###,###,##0.00")

                oDataTableReporte.Rows.Add(oDatarowReporte)
            Next
            ' ''''''''''''''''''FIN TARIFAS





            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea



                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea




                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'reducida aforo C17 C19 new


            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea




                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea




                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next




            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'res pago inmediato aforo C21  C23 new fin




            '''''''''''''''''''''''''''''''
            'normal
            '''''''''''''''''''''''''''''''



            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


            Next

            'aforo total new fin


            'ingreso sin iva new
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''ingreso sin iva new fin


            ''IVA NEW
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next
            'IVA NEW FIN

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''



            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


            Next

            'aforo total new fin


            'ingreso sin iva new
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''ingreso sin iva new fin


            ''IVA NEW
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea


            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea


            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next
            ''IVA NEW FIN

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''


            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


            Next

            'aforo total new fin


            'ingreso sin iva new
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''ingreso sin iva new fin


            ''IVA NEW
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next
            'IVA NEW FIN

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next
            'Ingreso Total new fin



            Dim rds As New ReportDataSource
            rds.Name = "DataSet1"
            rds.Value = odataSetReporte.Tables("tabla_reporte")

            ReportViewer2.LocalReport.DataSources.Add(rds)



            'Totales Tabla 1
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "Cantidad")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "Total")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "Tipo_Total")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "strNumero")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            odataSetReporte_total.Tables.Add(oDataTableReporte_total)
            '--------------------------------------------------------


            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "001"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Nothing

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)

            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "002"
            oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = " Ingreso s/IVA"
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Nothing

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)



            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "003"
            oDatarowReporte_total("Total") = "             Total           "
            ' oDatarowReporte_total("Tipo_Total") = "I.V.A"
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Nothing

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '----------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "14"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_14, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "15"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Format(db_tot_15, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "15"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_15 - (db_tot_15 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "18"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_18, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "20"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Format(db_tot_20 / 1.16, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "20"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_20 - (db_tot_20 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '22
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "22"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_22, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "24"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Format(db_tot_24, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "24"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_24 - (db_tot_24 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "26"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_26, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '------------------------------------------------------------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "28"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total("strNumero") = Format(db_tot_28, "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "30"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_30, "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            'Total
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "32"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total("strNumero") = "Total:"

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)

            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "32"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Format(db_tot_32, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)

            '--------------------------------------------------------------------



            Dim rds_Total As New ReportDataSource
            rds_Total.Name = "DataSet2"
            rds_Total.Value = odataSetReporte_total.Tables("tabla_reporte_total")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total)




            'Tabla Dos
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Grupo")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Concepto")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Descricion_clase")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Numero_clase")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 1, "Numero")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "strNumero")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            odataSetReporte_2.Tables.Add(oDataTableReporte_2)
            '--------------------------------------------------------
            'pago en efectivo dollares new
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 1000 " &
    "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("Total")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 'dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_2("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("excedentes")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_2("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_2("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next










            Dim rds_2 As New ReportDataSource
            rds_2.Name = "DataSet3"
            rds_2.Value = odataSetReporte_2.Tables("tabla_reporte_2")

            ReportViewer2.LocalReport.DataSources.Add(rds_2)


            'Totales Tabla 2
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "Cantidad")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "Total")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "Tipo_Total")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "strNumero")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            odataSetReporte_total_2.Tables.Add(oDataTableReporte_total_2)
            '--------------------------------------------------------
            oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            oDatarowReporte_total_2("Cantidad") = "36"
            oDatarowReporte_total_2("Total") = "             Total           "
            oDatarowReporte_total_2("Tipo_Total") = " Aforo"
            oDatarowReporte_total_2("strNumero") = Format(db_tot_36, "###,###,##0")

            oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            'oDatarowReporte_total_2("Cantidad") = "36"
            'oDatarowReporte_total_2("Total") = "             Total           "
            'oDatarowReporte_total_2("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_2("strNumero") = Format(db_tot_35 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '-------------------------------------------------------
            'oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            'oDatarowReporte_total_2("Cantidad") = "36"
            'oDatarowReporte_total_2("Total") = "             Total           "
            'oDatarowReporte_total_2("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_2("strNumero") = Format(db_tot_35 - (db_tot_35 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '-------------------------------------------------------
            'oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            'oDatarowReporte_total_2("Cantidad") = "38"
            'oDatarowReporte_total_2("Total") = "             Total           "
            'oDatarowReporte_total_2("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_2("strNumero") = "Total:"

            'oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '---------------------------------------------------
            oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            oDatarowReporte_total_2("Cantidad") = "38"
            oDatarowReporte_total_2("Total") = "             Total           "
            oDatarowReporte_total_2("Tipo_Total") = " Ingreso "
            oDatarowReporte_total_2("strNumero") = Format(db_tot_35, "###,###,##0.00")

            oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '-------------------------------------------------------


            Dim rds_Total_2 As New ReportDataSource
            rds_Total_2.Name = "DataSet4"
            rds_Total_2.Value = odataSetReporte_total_2.Tables("tabla_reporte_total_2")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_2)



            'Tabla 3
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Grupo")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Concepto")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Descricion_clase")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Numero_clase")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 1, "Numero")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "strNumero")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            odataSetReporte_3.Tables.Add(oDataTableReporte_3)
            '--------------------------------------------------------
            'PAGO ANTICIPADO RESIDENTES NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 1000 " &
    "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("Total")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 'dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_3("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("excedentes")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_3("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_3("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next

            'PAGO ANTICIPADO RESIDENTES NEW FIN



            '        'Pago en efectivo dlls por cajero-receptor C33 C34 (pend)
            '        strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '        If int_reporte = 1 Then

            '            strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '            "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '            "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '            "AND ID_VOIE = " & int_id_voie & " " & _
            '            "AND VOIE = '" & str_id_voie & "' "

            '        ElseIf int_reporte = 2 Then
            '            strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            '        ElseIf int_reporte = 3 Then
            '            strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            '        End If


            '        strQuerys = strQuerys & "AND ID_PAIEMENT = 1000 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '        If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '        End If

            '        dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '        For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '            oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '            strGrupo = "a"
            '            strConcepto = " Tarifa Ref."

            '            oDatarowReporte_3 = oDataTableReporte_3.NewRow

            '            oDatarowReporte_3("Grupo") = strGrupo
            '            oDatarowReporte_3("Concepto") = strConcepto
            '            oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '            oDatarowReporte_3("Numero_clase") = strLinea

            '            dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '            If dvEvento.Count >= 1 Then
            '                'oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
            '                oDatarowReporte_3("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '                db_tot_35 = db_tot_35 + dvEvento(0).Item("Total")

            '            Else
            '                'oDatarowReporte("Numero") = 0
            '                oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
            '            End If
            '            oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


            '            strGrupo = "b"
            '            strConcepto = "Aforo"

            '            oDatarowReporte_3 = oDataTableReporte_3.NewRow

            '            oDatarowReporte_3("Grupo") = strGrupo
            '            oDatarowReporte_3("Concepto") = strConcepto
            '            oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '            oDatarowReporte_3("Numero_clase") = strLinea

            '            dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '            If dvEvento.Count >= 1 Then
            '                'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '                oDatarowReporte_3("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                db_tot_36 = db_tot_36 + dvEvento(0).Item("cruces")
            '            Else
            '                'oDatarowReporte("Numero") = 0
            '                oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
            '            End If

            '            oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            '        Next

            Dim rds_3 As New ReportDataSource
            rds_3.Name = "DataSet5"
            rds_3.Value = odataSetReporte_3.Tables("tabla_reporte_3")

            ReportViewer2.LocalReport.DataSources.Add(rds_3)


            'Totales Tabla 3
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "Cantidad")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "Total")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "Tipo_Total")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "strNumero")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            odataSetReporte_total_3.Tables.Add(oDataTableReporte_total_3)
            '--------------------------------------------------------
            oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            oDatarowReporte_total_3("Cantidad") = "36"
            oDatarowReporte_total_3("Total") = "             Total           "
            oDatarowReporte_total_3("Tipo_Total") = " Aforo"
            oDatarowReporte_total_3("strNumero") = Format(db_tot_36, "###,###,##0")

            oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            'oDatarowReporte_total_3("Cantidad") = "36"
            'oDatarowReporte_total_3("Total") = "             Total           "
            'oDatarowReporte_total_3("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_3("strNumero") = Format(db_tot_35 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '-------------------------------------------------------
            'oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            'oDatarowReporte_total_3("Cantidad") = "36"
            'oDatarowReporte_total_3("Total") = "             Total           "
            'oDatarowReporte_total_3("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_3("strNumero") = Format(db_tot_35 - (db_tot_35 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '-------------------------------------------------------
            'oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            'oDatarowReporte_total_3("Cantidad") = "38"
            'oDatarowReporte_total_3("Total") = "             Total           "
            'oDatarowReporte_total_3("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_3("strNumero") = "Total:"

            'oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '---------------------------------------------------
            oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            oDatarowReporte_total_3("Cantidad") = "38"
            oDatarowReporte_total_3("Total") = "             Total           "
            oDatarowReporte_total_3("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_3("strNumero") = Format(db_tot_35, "###,###,##0.00")

            oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '-------------------------------------------------------


            Dim rds_Total_3 As New ReportDataSource
            rds_Total_3.Name = "DataSet6"
            rds_Total_3.Value = odataSetReporte_total_3.Tables("tabla_reporte_total_3")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_3)
            'fin tabla 3


            'tabla 4
            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Grupo")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Concepto")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Descricion_clase")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Numero_clase")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 1, "Numero")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "strNumero")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            odataSetReporte_4.Tables.Add(oDataTableReporte_4)

            'c45
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                    db_tot_47 = db_tot_47 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            Next


            '++++++++++++++++++++++++++
            'excedentes asignados
            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    'db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                    db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_4("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_46 = db_tot_46 + dvEvento(0).Item("excedentes")
                    db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")


                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES
            '++++++++++++++++++++++++++





            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)



            'c48 (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                    db_tot_50 = db_tot_50 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            Next


            '++++++++++++++++++++++++++++++++++++
            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                    'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                    db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                    db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    'oDatarowReporte_4("Numero") = dvEvento(0).Item("excedentes")
                    'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")

                    'db_tot_49 = db_tot_49 + dvEvento(0).Item("excedentes")
                    db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11
                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces") * 2
                        'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")

                        ' db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        'db_tot_49 = db_tot_49 + (dvEvento(0).Item("cruces") * 2)
                        db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES

            '+++++++++++++++++++++++++++++++++++++



            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)


            Dim rds_4 As New ReportDataSource
            rds_4.Name = "DataSet7"
            rds_4.Value = odataSetReporte_4.Tables("tabla_reporte_4")

            ReportViewer2.LocalReport.DataSources.Add(rds_4)


            'Fin Tabla 4----------------------------
            'inicio tabla 4 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "Cantidad")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "Total")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "Tipo_Total")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "strNumero")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            odataSetReporte_total_4.Tables.Add(oDataTableReporte_total_4)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            oDatarowReporte_total_4("Cantidad") = "46"
            oDatarowReporte_total_4("Total") = "             Total           "
            oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            oDatarowReporte_total_4("strNumero") = Format(db_tot_46, "###,###,##0")

            oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "46"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_47 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            '--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "461"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_461, "###,###,##0")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "461"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_471 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            '--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "462"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_462, "###,###,##0")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "462"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_472 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            '--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "463"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_463, "###,###,##0")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "463"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_473 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "463"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_463, "###,###,##0")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "463"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_473 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------

            '--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "49"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_49, "###,###,##0")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "49"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_50 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            oDatarowReporte_total_4("Cantidad") = "49"
            oDatarowReporte_total_4("Total") = "             Total           "
            oDatarowReporte_total_4("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_4("strNumero") = Format(db_tot_50 - (db_tot_50 / 1.16), "###,###,##0.00")

            oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            '-------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "52"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = "Total:"

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''---------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "52"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_50, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '-------------------------------------------------------

            Dim rds_Total_4 As New ReportDataSource
            rds_Total_4.Name = "DataSet8"
            rds_Total_4.Value = odataSetReporte_total_4.Tables("tabla_reporte_total_4")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_4)
            'fin tabla 4 totoales

            '+++++++++++++++
            '***************
            'tarjetas bancarias inicia


            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Grupo")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Concepto")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Descricion_clase")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Numero_clase")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 1, "Numero")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "strNumero")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            odataSetReporte_10.Tables.Add(oDataTableReporte_10)

            'c45
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " ' & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 12 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_146 = db_tot_146 + dvEvento(0).Item("cruces")
                    db_tot_147 = db_tot_147 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    'db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_146 = db_tot_146 + dvEvento(0).Item("cruces")
                    db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_46 = db_tot_46 + dvEvento(0).Item("excedentes")
                    db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")


                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES

            'excedentes fin

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            'inicio tarjeta de debito

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " ' & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 14 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_1461 = db_tot_1461 + dvEvento(0).Item("cruces")
                    db_tot_1471 = db_tot_1471 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    'db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_1461 = db_tot_1461 + dvEvento(0).Item("cruces")
                    db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_46 = db_tot_46 + dvEvento(0).Item("excedentes")
                    db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")


                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES

            'excedentes fin

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            'fin tarjeta de debito



            'c48 (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = '" & int_id_voie & "' " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            ' or ID_PAIEMENT = 12 or ID_PAIEMENT = 14
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 12 or ID_PAIEMENT = 14) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    db_tot_150 = db_tot_150 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'éxcedentes iave
            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_49 = db_tot_49 + dvEvento(0).Item("excedentes")
                    db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        ' db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        'db_tot_49 = db_tot_49 + (dvEvento(0).Item("cruces") * 2)
                        db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES



            'fin excedentes iave


            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            '***ingreso tarjetas bancarias
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    'db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    'db_tot_150 = db_tot_150 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'éxcedentes iave
            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    'db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    'oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    'db_tot_49 = db_tot_49 + dvEvento(0).Item("excedentes")
                    'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11
                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")

                        ' db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        'db_tot_49 = db_tot_49 + (dvEvento(0).Item("cruces") * 2)
                        'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES



            'fin excedentes iave


            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            '***ingreso tarjetas bancarias fin



            Dim rds_10 As New ReportDataSource
            rds_10.Name = "DataSet19"
            rds_10.Value = odataSetReporte_10.Tables("tabla_reporte_10")

            ReportViewer2.LocalReport.DataSources.Add(rds_10)


            'Fin Tabla 4----------------------------
            'inicio tabla 4 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "Cantidad")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "Total")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "Tipo_Total")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "strNumero")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            odataSetReporte_total_10.Tables.Add(oDataTableReporte_total_10)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "146"
            oDatarowReporte_total_10("Total") = "             Total           "
            oDatarowReporte_total_10("Tipo_Total") = " Aforo"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_146, "###,###,##0")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '--------------------------------------------------------
            'oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            'oDatarowReporte_total_10("Cantidad") = "146"
            'oDatarowReporte_total_10("Total") = "             Total           "
            'oDatarowReporte_total_10("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_10("strNumero") = Format(db_tot_147 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '----------------------------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "1461"
            oDatarowReporte_total_10("Total") = "             Total           "
            oDatarowReporte_total_10("Tipo_Total") = " Aforo"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_1461, "###,###,##0")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '--------------------------------------------------------
            'oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow



            ' ''tarjeta bancaria
            ' ''fin tarjeta bancaria
            ''--------------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "149"
            oDatarowReporte_total_10("Total") = "             Total           "
            oDatarowReporte_total_10("Tipo_Total") = " Aforo"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_149, "###,###,##0")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '--------------------------------------------------------

            '---------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "152"
            oDatarowReporte_total_10("Total") = "             Total           "
            'oDatarowReporte_total_10("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_10("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_150, "###,###,##0.00")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '-------------------------------------------------------

            Dim rds_Total_10 As New ReportDataSource
            rds_Total_10.Name = "DataSet20"
            rds_Total_10.Value = odataSetReporte_total_10.Tables("tabla_reporte_total_10")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_10)


            'tarjetas bancarias fin
            '***************
            '+++++++++++++++







            'inicio_tabla_5


            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Grupo")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Concepto")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Descricion_clase")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Numero_clase")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 1, "Numero")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "strNumero")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            odataSetReporte_5.Tables.Add(oDataTableReporte_5)

            'c53
            '---------------------------------------------------------------------------------
            '            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '            If int_reporte = 1 Then

            '                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '                "AND ID_VOIE = " & int_id_voie & " " & _
            '                "AND VOIE = '" & str_id_voie & "' "

            '            ElseIf int_reporte = 2 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            '            ElseIf int_reporte = 3 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            '            End If

            '            'ID_PAIEMENT
            '            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '            '"AND ID_OBS_SEQUENCE = '5' " & _
            '            '"AND ID_OBS_PASSAGE = '3' " & _
            '            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 13333 " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"


            '            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '            End If

            '            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            '            'ELUDIDO NEW
            '            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Eludido"

            '                oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '                oDatarowReporte_5("Grupo") = strGrupo
            '                oDatarowReporte_5("Concepto") = strConcepto
            '                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '                oDatarowReporte_5("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then
            '                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
            '                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    db_tot_53 = db_tot_53 + dvEvento(0).Item("cruces")

            '                Else
            '                    oDatarowReporte_5("Numero") = 0
            '                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '                End If
            '                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    db_tot_54 = db_tot_54 + dvEvento(0).Item("Total")
            '                Else

            '                End If

            '            Next

            '            'excedentes asignados
            '            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Eludido"

            '                oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '                oDatarowReporte_5("Grupo") = strGrupo
            '                oDatarowReporte_5("Concepto") = strConcepto

            '                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(1)
            '                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(9)
            '                End If

            '                oDatarowReporte_5("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then
            '                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
            '                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    db_tot_53 = db_tot_53 + dvEvento(0).Item("cruces")

            '                Else
            '                    oDatarowReporte_5("Numero") = 0
            '                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '                End If
            '                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    dvTarifa.RowFilter = "CODE = 1 "

            '                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
            '                    db_tot_54 = db_tot_54 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
            '                Else

            '                End If

            '            Next

            '            'solo exedentes
            '            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Eludido"

            '                oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '                oDatarowReporte_5("Grupo") = strGrupo
            '                oDatarowReporte_5("Concepto") = strConcepto
            '                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '                oDatarowReporte_5("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    '10,12

            '                    oDatarowReporte_5("Numero") = dvEvento(0).Item("excedentes")
            '                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
            '                    'db_tot_53 = db_tot_53 + dvEvento(0).Item("excedentes")

            '                Else
            '                    oDatarowReporte_5("Numero") = 0
            '                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '                End If
            '                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    dvTarifa.RowFilter = "CODE = 1 "
            '                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
            '                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


            '                    db_tot_54 = db_tot_54 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
            '                Else

            '                End If

            '            Next


            '            'solo excedentes directos aclase
            '            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Eludido"

            '                oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '                oDatarowReporte_5("Grupo") = strGrupo
            '                oDatarowReporte_5("Concepto") = strConcepto
            '                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '                oDatarowReporte_5("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    '10,11

            '                    If oDataRowNueve("ID_CLASSE") = 10 Then
            '                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
            '                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
            '                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces") * 2
            '                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
            '                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
            '                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
            '                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    End If

            '                    'db_tot_53 = db_tot_53 + dvEvento(0).Item("excedentes")

            '                Else
            '                    oDatarowReporte_5("Numero") = 0
            '                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '                End If
            '                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)


            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then

            '                    dvTarifa.RowFilter = "CODE = 1 "

            '                    If oDataRowNueve("ID_CLASSE") = 10 Then
            '                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

            '                        db_tot_54 = db_tot_54 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

            '                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
            '                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

            '                        db_tot_54 = db_tot_54 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


            '                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

            '                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

            '                        db_tot_54 = db_tot_54 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

            '                    End If

            '                Else

            '                End If



            '            Next

            'ELUDIDO NEW FIN



            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "a"
            '    strConcepto = "Eludido"

            '    oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '    oDatarowReporte_5("Grupo") = strGrupo
            '    oDatarowReporte_5("Concepto") = strConcepto
            '    oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_5("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_53 = db_tot_53 + dvEvento(0).Item("cruces")
            '        db_tot_54 = db_tot_54 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            'Next

            'c45b (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 1000 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView


            'residente new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_531 = db_tot_531 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_541 = db_tot_541 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_531 = db_tot_531 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_5("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_531 = db_tot_531 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_531 = db_tot_531 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next
            'residente new fin

            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "a"
            '    strConcepto = "Residente"

            '    oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '    oDatarowReporte_5("Grupo") = strGrupo
            '    oDatarowReporte_5("Concepto") = strConcepto
            '    oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_5("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_531 = db_tot_531 + dvEvento(0).Item("cruces")
            '        db_tot_541 = db_tot_541 + dvEvento(0).Item("cruces")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            'Next

            'c45c (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If


            strQuerys = strQuerys & "AND (ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            'gruas
            '            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or " & _
            '"  (ID_PAIEMENT = 0 AND ID_OBS_SEQUENCE = 'E')) " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'VSC NEW
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_532 = db_tot_532 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_542 = db_tot_542 + dvEvento(0).Item("Total")
                Else

                End If



            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_532 = db_tot_532 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If



            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_5("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_532 = db_tot_532 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If



            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_532 = db_tot_532 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else

                End If



            Next
            'VSC NEW FIN




            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "a"
            '    strConcepto = "V.S.C."

            '    oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '    oDatarowReporte_5("Grupo") = strGrupo
            '    oDatarowReporte_5("Concepto") = strConcepto
            '    oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_5("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_532 = db_tot_532 + dvEvento(0).Item("cruces")
            '        db_tot_542 = db_tot_542 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            'Next




            'c48 (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133)) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            'gruas
            '            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or " & _
            '"  (ID_PAIEMENT = 0 AND ID_OBS_SEQUENCE = 'E')) " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"



            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'aforo total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_56 = db_tot_56 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_57 = db_tot_57 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_56 = db_tot_56 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_5("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_56 = db_tot_56 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_56 = db_tot_56 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next

            'aforo total new fin


            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "b"
            '    strConcepto = "Aforo Total"

            '    oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '    oDatarowReporte_5("Grupo") = strGrupo
            '    oDatarowReporte_5("Concepto") = strConcepto
            '    oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_5("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_56 = db_tot_56 + dvEvento(0).Item("cruces")
            '        db_tot_57 = db_tot_57 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            'Next


            Dim rds_5 As New ReportDataSource
            rds_5.Name = "DataSet9"
            rds_5.Value = odataSetReporte_5.Tables("tabla_reporte_5")

            ReportViewer2.LocalReport.DataSources.Add(rds_5)


            'Fin Tabla 4----------------------------
            'inicio tabla 4 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "Cantidad")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "Total")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "Tipo_Total")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "strNumero")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            odataSetReporte_total_5.Tables.Add(oDataTableReporte_total_5)
            '--------------------------------------------------------
            '--------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "53"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_5("strNumero") = Format(db_tot_53, "###,###,##0")

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '--------------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "531"
            oDatarowReporte_total_5("Total") = "             Total           "
            oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_531, "###,###,##0")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)

            '--------------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "532"
            oDatarowReporte_total_5("Total") = "             Total           "
            oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_532, "###,###,##0")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '--------------------------------------------------------

            '--------------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "56"
            oDatarowReporte_total_5("Total") = "             Total           "
            oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_56, "###,###,##0")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '--------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "56"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_5("strNumero") = Format(db_tot_57 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            ''----------------------------------------------------------------------------
            ''--------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "56"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_5("strNumero") = Format(db_tot_57 - (db_tot_57 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            ''----------------------------------------------------------------------------
            ''-------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "59"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_5("strNumero") = "Total:"

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '---------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "59"
            oDatarowReporte_total_5("Total") = "             Total           "
            oDatarowReporte_total_5("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_57, "###,###,##0.00")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '-------------------------------------------------------

            Dim rds_Total_5 As New ReportDataSource
            rds_Total_5.Name = "DataSet10"
            rds_Total_5.Value = odataSetReporte_total_5.Tables("tabla_reporte_total_5")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_5)
            'fin tabla 5

            'tabla 6
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Grupo")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Concepto")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Descricion_clase")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Numero_clase")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 1, "Numero")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "strNumero")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            odataSetReporte_6.Tables.Add(oDataTableReporte_6)
            '--------------------------------------------------------

            'Pago en efectivo dlls por cajero-receptor C77 C78 (pend)
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
    "FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
    "WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
    "AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
    "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
    "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If


            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'F' " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            'AND ID_PAIEMENT = 0

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'reclasificaciones new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_77 = db_tot_77 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_78 = db_tot_78 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_77 = db_tot_77 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_6("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_77 = db_tot_77 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_77 = db_tot_77 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next

            'reclasificaciones new fin


            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "a"
            '    strConcepto = " Reclasificaciones"

            '    oDatarowReporte_6 = oDataTableReporte_6.NewRow

            '    oDatarowReporte_6("Grupo") = strGrupo
            '    oDatarowReporte_6("Concepto") = strConcepto
            '    oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_6("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_77 = db_tot_77 + dvEvento(0).Item("cruces")
            '        db_tot_78 = db_tot_78 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_6.Rows.Add(oDatarowReporte_6)


            'Next


            'Pago en efectivo dlls por cajero-receptor C77 C78 (pend)
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
    "FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
    "WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
    "AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
    "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
    "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            'ID_CLASSE TAB_ID_CLASSE
            '        strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'F' " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6' " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView


            '"De" new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_80 = db_tot_80 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_81 = db_tot_81 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_80 = db_tot_80 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_6("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_80 = db_tot_80 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_80 = db_tot_80 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next
            '"De" new fin


            'If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            'End If

            'dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "b"
            '    strConcepto = "De"

            '    oDatarowReporte_6 = oDataTableReporte_6.NewRow

            '    oDatarowReporte_6("Grupo") = strGrupo
            '    oDatarowReporte_6("Concepto") = strConcepto
            '    oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_6("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_80 = db_tot_80 + dvEvento(0).Item("cruces")
            '        db_tot_81 = db_tot_81 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

            'Next



            Dim rds_6 As New ReportDataSource
            rds_6.Name = "DataSet11"
            rds_6.Value = odataSetReporte_6.Tables("tabla_reporte_6")

            ReportViewer2.LocalReport.DataSources.Add(rds_6)


            'Totales Tabla 6
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "Cantidad")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "Total")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "Tipo_Total")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "strNumero")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            odataSetReporte_total_6.Tables.Add(oDataTableReporte_total_6)
            '--------------------------------------------------------
            oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            oDatarowReporte_total_6("Cantidad") = "77"
            oDatarowReporte_total_6("Total") = "             Total           "
            oDatarowReporte_total_6("Tipo_Total") = " Aforo"
            oDatarowReporte_total_6("strNumero") = Format(db_tot_77, "###,###,##0")

            oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "77"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_6("strNumero") = "Total:"

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "77"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_6("strNumero") = Format(db_tot_78, "###,###,##0.00")

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------
            '-------------------------------------------------------
            oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            oDatarowReporte_total_6("Cantidad") = "80"
            oDatarowReporte_total_6("Total") = "             Total           "
            oDatarowReporte_total_6("Tipo_Total") = " Aforo"
            oDatarowReporte_total_6("strNumero") = Format(db_tot_80, "###,###,##0")

            oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "80"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_6("strNumero") = "Total:"

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "80"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_6("strNumero") = Format(db_tot_81, "###,###,##0.00")

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------

            Dim rds_Total_6 As New ReportDataSource
            rds_Total_6.Name = "DataSet12"
            rds_Total_6.Value = odataSetReporte_total_6.Tables("tabla_reporte_total_6")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_6)


            'fin tabla 6


            'inicio tabla 7

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Grupo")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Concepto")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Descricion_clase")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Numero_clase")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 1, "Numero")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "strNumero")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            odataSetReporte_7.Tables.Add(oDataTableReporte_7)

            'TOTAL MARCADO POR CAJERO RECEPTOR NEW
            'TABLA1 TABLA 7 NEW
            'aforo total new
            '''''''''''''''''''''''''''''''
            'normal
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next
            'Ingreso Total new fin

            'TABLA1 TABLA 7 NEW FIN

            'TABLA 4 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'TABLA 4 TABLA 7 FIN

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133)) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'TABLA 5 TABLA 7 NEW FIN

            'TABLA 6 TABLA 7 NEW FIN

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'FFFF' " &
  "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'TABLA 6 TABLA 7 NEW FIN


            'TABLA 6_2 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6666' " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next
            'TABLA 6_2 TABLA 7 NEW FIN
            '---------------------------------------------------------------------------------
            '            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            '            If int_reporte = 1 Then

            '                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '                "AND ID_VOIE = " & int_id_voie & " " & _
            '                "AND VOIE = '" & str_id_voie & "' "

            '            ElseIf int_reporte = 2 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            '            ElseIf int_reporte = 3 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            '            End If

            '            '            strQuerys = strQuerys & "AND RECEIPT_NUMBER IS NOT NULL " & _
            '            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"


            '            'strQuerys = strQuerys & "AND ((ID_PAIEMENT = 1 Or ID_PAIEMENT = 2 Or ID_PAIEMENT = 27 Or ID_PAIEMENT = 9 Or ID_PAIEMENT = 10 Or ID_PAIEMENT = 12 Or ID_PAIEMENT = 15 Or ID_PAIEMENT = 133 Or ID_PAIEMENT = 71 Or ID_PAIEMENT = 72 Or ID_PAIEMENT = 73 Or ID_PAIEMENT = 74)) " & _
            '            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '            'ID_PAIEMENT = 0 Or

            '            'ID_PAIEMENT = 0 Or ID_PAIEMENT = 1 Or ID_PAIEMENT = 2 Or ID_PAIEMENT = 27 Or ID_PAIEMENT = 9 Or ID_PAIEMENT = 10 Or ID_PAIEMENT = 12 Or ID_PAIEMENT = 15 Or ID_PAIEMENT = 133 Or ID_PAIEMENT = 71 Or ID_PAIEMENT = 72 Or ID_PAIEMENT = 73 Or ID_PAIEMENT = 74

            '            '"AND ID_PAIEMENT = 1 " & _
            '            '"AND ID_OBS_SEQUENCE <> '5' " & _
            '            '''''''''''''''
            '            'Tabla 1
            '            strQuerys = strQuerys & "AND (((ID_PAIEMENT = 1 or  ID_PAIEMENT = 2 or ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '            "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F')))"
            '            'Tabla 4

            '            'strQuerys = strQuerys & "or (ID_PAIEMENT = 15 " & _
            '            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F')) "

            '            ''tabla 5
            '            ''strQuerys = strQuerys & "or (ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0')) "
            '            ''strQuerys = strQuerys & "or ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133))) "
            '            'strQuerys = strQuerys & "or ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133))) "

            '            ''tabla 6
            '            ''strQuerys = strQuerys & "or ((ID_OBS_SEQUENCE = 'F' or ID_OBS_PASSAGE = '6'))) "

            '            'gruas
            '            '     strQuerys = strQuerys & "or ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or " & _
            '            '"  (ID_PAIEMENT = 0 AND ID_OBS_SEQUENCE = 'E'))) "

            '            strQuerys = strQuerys & "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"


            '            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            '            End If

            '            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView


            '            'TOTAL MARCADO POR CAJERO RECEPTOR NEW FIN

            '            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Aforo"

            '                oDatarowReporte_7 = oDataTableReporte_7.NewRow

            '                oDatarowReporte_7("Grupo") = strGrupo
            '                oDatarowReporte_7("Concepto") = strConcepto
            '                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '                oDatarowReporte_7("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then
            '                    'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")
            '                Else
            '                    'oDatarowReporte("Numero") = 0
            '                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
            '                End If

            '                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


            '                ''''''''''''''''''''''''''
            '                strGrupo = "b"
            '                strConcepto = " Ingreso"

            '                oDatarowReporte_7 = oDataTableReporte_7.NewRow

            '                oDatarowReporte_7("Grupo") = strGrupo
            '                oDatarowReporte_7("Concepto") = strConcepto
            '                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '                oDatarowReporte_7("Numero_clase") = strLinea

            '                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEvento.Count >= 1 Then
            '                    'oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
            '                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")

            '                Else
            '                    'oDatarowReporte("Numero") = 0
            '                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
            '                End If
            '                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


            '            Next

            Dim rds_7 As New ReportDataSource
            rds_7.Name = "DataSet13"
            rds_7.Value = odataSetReporte_7.Tables("tabla_reporte_7")

            ReportViewer2.LocalReport.DataSources.Add(rds_7)



            'inicio tabla 7 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "Cantidad")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "Total")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "Tipo_Total")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "strNumero")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            odataSetReporte_total_7.Tables.Add(oDataTableReporte_total_7)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            oDatarowReporte_total_7("Cantidad") = "61"
            oDatarowReporte_total_7("Total") = "             Total           "
            oDatarowReporte_total_7("Tipo_Total") = " Aforo"
            oDatarowReporte_total_7("strNumero") = Format(db_tot_61, "###,###,##0")

            oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            '--------------------------------------------------------

            oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            oDatarowReporte_total_7("Cantidad") = "63"
            oDatarowReporte_total_7("Total") = "             Total           "
            oDatarowReporte_total_7("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_7("strNumero") = Format(db_tot_63, "###,###,##0.00")

            oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            '----------------------------------------------------------------------------

            '--------------------------------------------------------
            'oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            'oDatarowReporte_total_7("Cantidad") = "63"
            'oDatarowReporte_total_7("Total") = "             Total           "
            'oDatarowReporte_total_7("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_7("strNumero") = Format(db_tot_63 - (db_tot_63 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            ''----------------------------------------------------------------------------
            ''-------------------------------------------------------
            'oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            'oDatarowReporte_total_7("Cantidad") = "65"
            'oDatarowReporte_total_7("Total") = "             Total           "
            'oDatarowReporte_total_7("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_7("strNumero") = "Total:"

            'oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            ''---------------------------------------------------
            'oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            'oDatarowReporte_total_7("Cantidad") = "65"
            'oDatarowReporte_total_7("Total") = "             Total           "
            'oDatarowReporte_total_7("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_7("strNumero") = Format(db_tot_63, "###,###,##0.00")

            'oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            '-------------------------------------------------------

            Dim rds_Total_7 As New ReportDataSource
            rds_Total_7.Name = "DataSet14"
            rds_Total_7.Value = odataSetReporte_total_7.Tables("tabla_reporte_total_7")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_7)

            'fin tabla 7



            'TABLA 8
            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Grupo")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Concepto")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Descricion_clase")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Numero_clase")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 1, "Numero")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "strNumero")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            odataSetReporte_8.Tables.Add(oDataTableReporte_8)


            'TOTAL DETECTADO POR EL EQUIPO DE CONTROL
            'TABLA1 TABLA 8 NEW
            'aforo total new
            '''''''''''''''''''''''''''''''
            'normal
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            strQuerys = strQuerys & "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next
            'Ingreso Total new fin

            'TABLA1 TABLA 7 NEW FIN

            'TABLA 4 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'TABLA 4 TABLA 7 FIN

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133)) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'TABLA 5 TABLA 7 NEW FIN

            'TABLA 6 TABLA 7 NEW FIN

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'FFFF' " &
  "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'TABLA 6 TABLA 7 NEW FIN


            'TABLA 6_2 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6666' " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next




            'TOTAL DETECTADO POR EL EQUIPO DE CONTROL FIN
            'c45
            '---------------------------------------------------------------------------------
            '            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(TRANSACTION_CPT1/100) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " & _
            '"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_CLASSE = TYPE_CLASSE.ID_CLASSE " & _
            '"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "
            '            'POS ACD_CLASS
            '            If int_reporte = 1 Then

            '                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " & _
            '                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " & _
            '                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " & _
            '                "AND ID_VOIE = " & int_id_voie & " " & _
            '                "AND VOIE = '" & str_id_voie & "' "

            '            ElseIf int_reporte = 2 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            '            ElseIf int_reporte = 3 Then
            '                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            '            End If

            '            '           strQuerys = strQuerys & "AND ((ID_PAIEMENT = 1 Or ID_PAIEMENT = 2 Or ID_PAIEMENT = 27 Or ID_PAIEMENT = 9 Or ID_PAIEMENT = 10 Or ID_PAIEMENT = 12 Or ID_PAIEMENT = 15 Or ID_PAIEMENT = 133 Or ID_PAIEMENT = 71 Or ID_PAIEMENT = 72 Or ID_PAIEMENT = 73 Or ID_PAIEMENT = 74)) " & _
            '            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '            '''''''''''''''
            '            'Tabla 1
            '            strQuerys = strQuerys & "AND (((ID_PAIEMENT = 1 or  ID_PAIEMENT = 2 or ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '            "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F'))"
            '            'Tabla 4

            '            strQuerys = strQuerys & "or (ID_PAIEMENT = 15 " & _
            '            "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F')) "

            '            'tabla 5
            '            strQuerys = strQuerys & "or (ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0')) "


            '            'GRUAS
            '            '       strQuerys = strQuerys & "or ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or " & _
            '            '"  (ID_PAIEMENT = 0 AND ID_OBS_SEQUENCE = 'E'))) "

            '            strQuerys = strQuerys & "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"


            '            '''''''''''''''''''''''''''''''''''''''''''''''''''


            '            If objQuerys.QueryDataSetDos(strQuerys, "TRANSACTION") = 1 Then
            '            End If

            '            dvEventoDos = oDataSetDos.Tables("TRANSACTION").DefaultView

            '            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '                strGrupo = "a"
            '                strConcepto = "Aforo"

            '                oDatarowReporte_8 = oDataTableReporte_8.NewRow

            '                oDatarowReporte_8("Grupo") = strGrupo
            '                oDatarowReporte_8("Concepto") = strConcepto
            '                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '                oDatarowReporte_8("Numero_clase") = strLinea

            '                dvEventoDos.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEventoDos.Count >= 1 Then
            '                    'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '                    oDatarowReporte_8("strNumero") = Format(dvEventoDos(0).Item("cruces"), "###,###,##0")
            '                    db_tot_67 = db_tot_67 + dvEventoDos(0).Item("cruces")
            '                Else
            '                    'oDatarowReporte("Numero") = 0
            '                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
            '                End If

            '                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


            '                ''''''''''''''''''''''''''
            '                strGrupo = "b"
            '                strConcepto = " Ingreso"

            '                oDatarowReporte_8 = oDataTableReporte_8.NewRow

            '                oDatarowReporte_8("Grupo") = strGrupo
            '                oDatarowReporte_8("Concepto") = strConcepto
            '                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '                oDatarowReporte_8("Numero_clase") = strLinea

            '                dvEventoDos.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '                If dvEventoDos.Count >= 1 Then
            '                    'oDatarowReporte("Numero") = dvEvento(0).Item("cruces")
            '                    oDatarowReporte_8("strNumero") = Format(dvEventoDos(0).Item("Total"), "###,###,##0.00")
            '                    db_tot_69 = db_tot_69 + dvEventoDos(0).Item("Total")

            '                Else
            '                    'oDatarowReporte("Numero") = 0
            '                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
            '                End If
            '                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


            '            Next

            Dim rds_8 As New ReportDataSource
            rds_8.Name = "DataSet15"
            rds_8.Value = odataSetReporte_8.Tables("tabla_reporte_8")

            ReportViewer2.LocalReport.DataSources.Add(rds_8)




            'inicio tabla 8 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "Cantidad")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "Total")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "Tipo_Total")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "strNumero")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            odataSetReporte_total_8.Tables.Add(oDataTableReporte_total_8)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            oDatarowReporte_total_8("Cantidad") = "61"
            oDatarowReporte_total_8("Total") = "             Total           "
            oDatarowReporte_total_8("Tipo_Total") = " Aforo"
            oDatarowReporte_total_8("strNumero") = Format(db_tot_67, "###,###,##0")

            oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            '--------------------------------------------------------

            oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            oDatarowReporte_total_8("Cantidad") = "63"
            oDatarowReporte_total_8("Total") = "             Total           "
            oDatarowReporte_total_8("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_8("strNumero") = Format(db_tot_69, "###,###,##0.00")

            oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            '----------------------------------------------------------------------------

            '--------------------------------------------------------
            'oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            'oDatarowReporte_total_8("Cantidad") = "63"
            'oDatarowReporte_total_8("Total") = "             Total           "
            'oDatarowReporte_total_8("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_8("strNumero") = Format(db_tot_69 - (db_tot_69 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            ''----------------------------------------------------------------------------
            ''-------------------------------------------------------
            'oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            'oDatarowReporte_total_8("Cantidad") = "65"
            'oDatarowReporte_total_8("Total") = "             Total           "
            'oDatarowReporte_total_8("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_8("strNumero") = "Total:"

            'oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            ''---------------------------------------------------
            'oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            'oDatarowReporte_total_8("Cantidad") = "65"
            'oDatarowReporte_total_8("Total") = "             Total           "
            'oDatarowReporte_total_8("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_8("strNumero") = Format(db_tot_69, "###,###,##0.00")

            'oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            '-------------------------------------------------------

            Dim rds_Total_8 As New ReportDataSource
            rds_Total_8.Name = "DataSet16"
            rds_Total_8.Value = odataSetReporte_total_8.Tables("tabla_reporte_total_8")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_8)


            'FIN TABLA 8

            'inicio tabla 9
            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Grupo")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Concepto")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Descricion_clase")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Numero_clase")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 1, "Numero")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "strNumero")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            odataSetReporte_9.Tables.Add(oDataTableReporte_9)

            'DIFERENCIA ENTRE TOTAL MARCADO POR EL CAJERO Y EL EQUIPO DE CONTROL DE TRANSITO NEW

            'DIF TABLA 7
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin

            'TABLA1 TABLA 7 NEW FIN

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133)) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'TABLA 5 TABLA 7 NEW FIN

            'TABLA 6 TABLA 7 NEW FIN

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'FFFF' " &
  "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'TABLA 6 TABLA 7 NEW FIN


            'TABLA 6_2 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6666' " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'DIF TABLA 7 FIN

            'DIF TABLA 8
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            strQuerys = strQuerys & "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"



            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces") * 2

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If

                Else
                    oDatarowReporte_9("Numero") = 0
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces") * 2

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces") * 2

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin

            'TABLA1 TABLA 7 NEW FIN

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133)) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -(dvEvento(0).Item("cruces") * 2)

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'TABLA 5 TABLA 7 NEW FIN

            'TABLA 6 TABLA 7 NEW FIN

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'FFFF' " &
  "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -(dvEvento(0).Item("cruces") * 2)

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'TABLA 6 TABLA 7 NEW FIN


            'TABLA 6_2 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6666' " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -(dvEvento(0).Item("cruces") * 2)

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'DIF TABLA 8 FIN


            'DIFERENCIA ENTRE TOTAL MARCADO POR EL CAJERO Y EL EQUIPO DE CONTROL DE TRANSITO NEW FIN






            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "a"
            '    strConcepto = "Aforo"

            '    oDatarowReporte_9 = oDataTableReporte_9.NewRow

            '    oDatarowReporte_9("Grupo") = strGrupo
            '    oDatarowReporte_9("Concepto") = strConcepto
            '    oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_9("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "
            '    dvEventoDos.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count = 0 And dvEventoDos.Count = 0 Then
            '        oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
            '    ElseIf dvEvento.Count >= 1 And dvEventoDos.Count >= 1 Then

            '        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") - dvEventoDos(0).Item("cruces"), "###,###,##0")
            '        db_tot_73 = db_tot_73 + (dvEvento(0).Item("cruces") - dvEventoDos(0).Item("cruces"))
            '    ElseIf dvEvento.Count >= 1 And dvEventoDos.Count = 0 Then

            '        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_73 = db_tot_73 + (dvEvento(0).Item("cruces"))

            '    ElseIf dvEvento.Count = 0 And dvEventoDos.Count >= 1 Then

            '        oDatarowReporte_9("strNumero") = Format(0 - dvEventoDos(0).Item("cruces"), "###,###,##0")
            '        db_tot_73 = db_tot_73 + (0 - dvEventoDos(0).Item("cruces"))
            '    Else

            '        oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_9.Rows.Add(oDatarowReporte_9)
            '    ''''''''''''''''''''''''''
            '    strGrupo = "b"
            '    strConcepto = " Ingreso"

            '    oDatarowReporte_9 = oDataTableReporte_9.NewRow

            '    oDatarowReporte_9("Grupo") = strGrupo
            '    oDatarowReporte_9("Concepto") = strConcepto
            '    oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_9("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "
            '    dvEventoDos.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count = 0 And dvEventoDos.Count = 0 Then
            '        oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
            '    ElseIf dvEvento.Count >= 1 And dvEventoDos.Count >= 1 Then

            '        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total") - dvEventoDos(0).Item("Total"), "###,###,##0.00")
            '        db_tot_75 = db_tot_75 + (dvEvento(0).Item("Total") - dvEventoDos(0).Item("Total"))
            '    ElseIf dvEvento.Count >= 1 And dvEventoDos.Count = 0 Then

            '        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
            '        db_tot_75 = db_tot_75 + (dvEvento(0).Item("Total"))

            '    ElseIf dvEvento.Count = 0 And dvEventoDos.Count >= 1 Then

            '        oDatarowReporte_9("strNumero") = Format(0 - dvEventoDos(0).Item("Total"), "###,###,##0.00")
            '        db_tot_75 = db_tot_75 + (0 - dvEventoDos(0).Item("Total"))
            '    Else

            '        oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
            '    End If

            '    oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            'Next

            Dim rds_9 As New ReportDataSource
            rds_9.Name = "DataSet17"
            rds_9.Value = odataSetReporte_9.Tables("tabla_reporte_9")

            ReportViewer2.LocalReport.DataSources.Add(rds_9)


            'tabla 9 totales
            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "Cantidad")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "Total")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "Tipo_Total")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "strNumero")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            odataSetReporte_total_9.Tables.Add(oDataTableReporte_total_9)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_9 = oDataTableReporte_total_9.NewRow

            oDatarowReporte_total_9("Cantidad") = "73"
            oDatarowReporte_total_9("Total") = "             Total           "
            oDatarowReporte_total_9("Tipo_Total") = " Aforo"
            oDatarowReporte_total_9("strNumero") = Format(db_tot_73, "###,###,##0")

            oDataTableReporte_total_9.Rows.Add(oDatarowReporte_total_9)
            '--------------------------------------------------------

            'oDatarowReporte_total_9 = oDataTableReporte_total_9.NewRow

            'oDatarowReporte_total_9("Cantidad") = "75"
            'oDatarowReporte_total_9("Total") = "             Total           "
            'oDatarowReporte_total_9("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_9("strNumero") = "Total:"

            'oDataTableReporte_total_9.Rows.Add(oDatarowReporte_total_9)
            '----------------------------------------------------------------------------

            '--------------------------------------------------------
            oDatarowReporte_total_9 = oDataTableReporte_total_9.NewRow

            oDatarowReporte_total_9("Cantidad") = "75"
            oDatarowReporte_total_9("Total") = "             Total           "
            oDatarowReporte_total_9("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_9("strNumero") = Format(db_tot_75, "###,###,##0.00")

            oDataTableReporte_total_9.Rows.Add(oDatarowReporte_total_9)
            '----------------------------------------------------------------------------
            '-------------------------------------------------------

            Dim rds_Total_9 As New ReportDataSource
            rds_Total_9.Name = "DataSet18"
            rds_Total_9.Value = odataSetReporte_total_9.Tables("tabla_reporte_total_9")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_9)

            'fin tabla 9




            ReportViewer2.SetDisplayMode(DisplayMode.PrintLayout)
            Me.ReportViewer2.RefreshReport()




        Catch ex As Exception
            'MsgBox(ex.ToString)
        End Try



    End Sub



    Private Sub Preliquidacion_Cajero_Receptor_Transito_Vehicular_cerrados(ByVal int_reporte As Integer)


        Try

            Dim strQuerys As String
            Dim strQuerys_varios_cortes As String

            'Dim hr_fecha_ini_varios_turnos As Date
            'Dim hr_fecha_fin_varios_turnos As Date
            'Dim bl_varios_turnos As Boolean = False

            Dim odataSetReporte As New DataSet
            Dim oDataTableReporte As DataTable = New DataTable("tabla_reporte")
            Dim oDataColumnaReporte As DataColumn
            Dim oDatarowReporte As DataRow

            Dim strGrupo As String
            Dim strConcepto As String
            Dim strTipoConcepto_A As String
            Dim strTipoConcepto_B As String
            Dim strTipoConcepto_C As String
            Dim strTipoConceptoGenero_A As String
            Dim strTipoConceptoGenero_B As String

            strQuerys = strLinea

            'Dim rpt_reporte As New rptPreliquidacion_Cajero_Receptor_Transito_Vehicular
            'Dim objText As TextObject

            Dim str_id_RESEAU As String
            Dim int_id_gare As Integer
            Dim str_id_voie As String
            Dim int_id_voie As Integer
            Dim int_numero_poste As Integer
            Dim dt_ini_poste As Date
            Dim dt_fin_poste As Date
            Dim str_MATRICULE As String

            Dim str_cajero As String = str_Cajero_Receptor
            Dim id_plaza_cobro_local As String = id_plaza_cobro

            Dim h_inicio_turno As Date
            Dim h_fin_turno As Date

            '        'VARIABLES DE CAMPO
            Dim VAR_11 As Double = 0
            Dim VAR_12 As Double = 0
            Dim VAR_13 As Double = 0
            Dim VAR_14 As Double = 0
            Dim VAR_15 As Double = 0
            Dim VAR_16 As Double = 0
            Dim VAR_17 As Double = 0
            Dim VAR_18 As Double = 0
            Dim VAR_19 As Double = 0
            Dim VAR_20 As Double = 0
            Dim VAR_21 As Double = 0
            Dim VAR_22 As Double = 0
            Dim VAR_23 As Double = 0

            Dim VAR_24 As Double = 0
            Dim VAR_25 As Double = 0
            Dim VAR_26 As Double = 0
            Dim VAR_27 As Double = 0

            Dim VAR_28 As Double = 0
            Dim VAR_29 As Double = 0
            Dim VAR_30 As Double = 0
            Dim VAR_31 As Double = 0
            Dim VAR_32 As Double = 0
            Dim VAR_33 As Double = 0
            Dim VAR_34 As Double = 0
            Dim VAR_35 As Double = 0
            Dim VAR_36 As Double = 0
            Dim VAR_37 As Double = 0
            Dim VAR_38 As Double = 0
            Dim VAR_39 As Double = 0

            Dim VAR_40 As Double = 0
            Dim VAR_41 As Double = 0
            Dim VAR_42 As Double = 0
            Dim VAR_43 As Double = 0
            Dim VAR_44 As Double = 0
            Dim VAR_45 As Double = 0
            Dim VAR_46 As Double = 0
            Dim VAR_47 As Double = 0
            Dim VAR_48 As Double = 0
            Dim VAR_49 As Double = 0

            Dim VAR_50 As Double = 0
            Dim VAR_51 As Double = 0
            Dim VAR_52 As Double = 0
            Dim VAR_53 As Double = 0
            Dim VAR_54 As Double = 0
            Dim VAR_55 As Double = 0
            Dim VAR_56 As Double = 0
            Dim VAR_57 As Double = 0
            Dim VAR_58 As Double = 0
            Dim VAR_59 As Double = 0

            Dim VAR_60 As Double = 0
            Dim VAR_61 As Double = 0
            Dim VAR_62 As Double = 0
            Dim VAR_63 As Double = 0
            Dim VAR_64 As Double = 0
            Dim VAR_65 As Double = 0
            Dim VAR_66 As Double = 0
            Dim VAR_67 As Double = 0
            Dim VAR_68 As Double = 0
            Dim VAR_69 As Double = 0

            Dim VAR_70 As Double = 0
            Dim VAR_71 As Double = 0
            Dim VAR_72 As Double = 0
            Dim VAR_73 As Double = 0
            Dim VAR_74 As Double = 0
            Dim VAR_75 As Double = 0
            Dim VAR_76 As Double = 0
            Dim VAR_77 As Double = 0
            Dim VAR_78 As Double = 0
            Dim VAR_79 As Double = 0

            Dim VAR_80 As Double = 0
            Dim VAR_81 As Double = 0
            Dim VAR_82 As Double = 0
            Dim VAR_83 As Double = 0
            Dim VAR_84 As Double = 0
            Dim VAR_85 As Double = 0
            Dim VAR_86 As Double = 0
            Dim VAR_87 As Double = 0
            Dim VAR_88 As Double = 0
            Dim VAR_89 As Double = 0

            Dim VAR_90 As Double = 0
            Dim VAR_91 As Double = 0
            Dim VAR_92 As Double = 0
            Dim VAR_93 As Double = 0
            Dim VAR_94 As Double = 0
            Dim VAR_95 As Double = 0
            Dim VAR_96 As Double = 0
            Dim VAR_97 As Double = 0
            Dim VAR_98 As Double = 0
            Dim VAR_99 As Double = 0


            Dim cont As Double

            Dim db_acom_63 As Double = 0
            Dim db_acom_94 As Double = 0
            Dim db_acom_65 As Double = 0
            Dim db_acom_67 As Double = 0
            Dim db_acom_folios As Double = 0
            Dim db_acom_folios2 As Double = 0
            Dim db_acom_folios3 As Double = 0
            Dim db_acom_eventos As Double = 0

            Dim No_Turno As String

            Dim saco As String

            Dim loc_operador As String
            'Dim loc_id_site As Integer
            Dim loc_id_site As String
            'Dim loc_id_gare As Integer

            'Dim strCarril As String
            Dim IdCarril As Integer

            'reporte cajero receptor
            If int_reporte = 1 Then

                loc_operador = str_Cajero_Receptor
                loc_id_site = id_plaza_cobro

                str_id_voie = strCarril
                int_id_voie = IdCarril

                ReportViewer1.LocalReport.DataSources.Clear()
                ReportViewer1.LocalReport.ReportEmbeddedResource = "rptPreliquidacion_Cajero_Receptor_Transito_Vehicular.rdlc"

                'verifico cuantos cortes tiene en ese turno CERRADOS
                strQuerys = "SELECT ID_NETWORK, ID_PLAZA,ID_LANE, LANE, BEGIN_DHM, END_DHM, BAG_NUMBER, REPORT_FLAG, GENERATION_DHM " &
 "FROM CLOSED_LANE_REPORT, SITE_GARE " &
 "where " &
 "CLOSED_LANE_REPORT.ID_PLAZA	=	SITE_GARE.id_Gare " &
  "AND	SITE_GARE.id_Site		=	'" & loc_id_site & "' "


                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "5 MATUTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "6 VESPERTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "4 NOCTURNO"
                End If

                strQuerys = strQuerys & "AND (BEGIN_DHM >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(BEGIN_DHM <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
           "order by BEGIN_DHM"

                If objQuerys.QueryDataSet(strQuerys, "CLOSED_LANE_REPORT") = 1 Then

                    'If oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Count = 1 Then
                    'ElseIf oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Count > 1 Then

                    Dim frmListas As New frmLineas
                    objControl.limpia_Catalogos()
                    frmListas.Tag = 5

                    strLinea = strQuerys

                    frmListas.ShowDialog()
                    If Trim(strLinea1) <> "" Then

                        bl_varios_turnos = True

                        hr_fecha_ini_varios_turnos = CDate(strLinea1)
                        If CDate(strLinea2) > h_fin_turno Then
                            hr_fecha_fin_varios_turnos = h_fin_turno
                        Else
                            hr_fecha_fin_varios_turnos = CDate(strLinea2)
                        End If

                        strCarril = strLinea3
                        loc_id_gare = strLinea4



                    Else
                        Me.Close()
                        Exit Sub
                    End If

                    'End If

                End If

                'fin de verifico cuantos cortes tiene en ese turno


                '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Inicio
                'DATOS GENERALES

                '     strQuerys = "SELECT GEADBA.FIN_POSTE.ID_RESEAU, GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE_L2, GEADBA.FIN_POSTE.VOIE, TO_CHAR(GEADBA.FIN_POSTE.NUMERO_POSTE, 'FM09') AS Expr1, " & _
                ' "TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'MM/DD/YY') AS Expr2, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'HH24:MI') AS Expr3, " & _
                ' "GEADBA.FIN_POSTE.MATRICULE, GEADBA.FIN_POSTE.SAC AS Expr4, GEADBA.FIN_POSTE.ID_VOIE, " & _
                ' "TO_CHAR(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE, 'YYYYMMDDHH24MISS') AS Expr5, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'YYYYMMDDHH24MISS') AS Expr6, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE, 0 AS Expr7, " & _
                ' "FOLIO_NUMBER_OPEN, FOLIO_NUMBER_CLOSE, INITIAL_EVENT_NUMBER, FINAL_EVENT_NUMBER, FOLIO_ECT_NUMBER_INITIAL, FOLIO_ECT_NUMBER_FINAL, " & _
                ' "FOLIO2_NUMBER_INITIAL,FOLIO2_NUMBER_FINAL,FOLIO3_NUMBER_INITIAL,FOLIO3_NUMBER_FINAL " & _
                ' "FROM GEADBA.TYPE_VOIE, GEADBA.FIN_POSTE, GEADBA.SITE_GARE " & _
                ' "WHERE GEADBA.TYPE_VOIE.ID_VOIE = GEADBA.FIN_POSTE.ID_VOIE AND GEADBA.FIN_POSTE.ID_RESEAU = GEADBA.SITE_GARE.ID_RESEAU AND " & _
                ' "GEADBA.FIN_POSTE.ID_GARE = GEADBA.SITE_GARE.ID_GARE AND (GEADBA.SITE_GARE.ID_RESEAU = '01') AND (GEADBA.SITE_GARE.ID_SITE = '" & id_plaza_cobro_local & "') AND " & _
                ' "(GEADBA.FIN_POSTE.ID_MODE_VOIE IN (1, 6, 7)) "


                '     If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                '         h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                '         h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                '     ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                '         h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                '         h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                '     ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                '         'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                '         h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                '         'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                '         h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                '     End If

                '     If bl_varios_turnos = False Then

                '         strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '"(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

                '     Else


                '         strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(hr_fecha_ini_varios_turnos, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '"(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(hr_fecha_fin_varios_turnos, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "


                '     End If

                '     '    strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_FIN_POSTE >= TO_DATE('" & Format(dt_Fecha_Inicio, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '     '"(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(dt_Fecha_Fin, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "
                '     strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.ID_VOIE = '1' OR " & _
                '  "GEADBA.FIN_POSTE.ID_VOIE = '2' OR " & _
                '  "GEADBA.FIN_POSTE.ID_VOIE = '3' OR " & _
                '  "GEADBA.FIN_POSTE.ID_VOIE = '4') " & _
                '  "AND (GEADBA.FIN_POSTE.MATRICULE = '" & str_cajero & "') " & _
                '  "ORDER BY GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.ID_VOIE, GEADBA.FIN_POSTE.VOIE, GEADBA.FIN_POSTE.DATE_FIN_POSTE, " & _
                '  "GEADBA.FIN_POSTE.NUMERO_POSTE, GEADBA.FIN_POSTE.MATRICULE, Expr4"
                '     'AND (GEADBA.FIN_POSTE.NUMERO_POSTE = " & id_Turno & ")


                ' If objQuerys.QueryDataSet(strQuerys, "TYPE_VOIE") = 1 Then

                'For PosicionFilaActual = 0 To oDataSet.Tables("TYPE_VOIE").Rows.Count - 1



                'oDataRow = oDataSet.Tables("TYPE_VOIE").Rows(PosicionFilaActual)



                Dim par3 As New ReportParameter()
                par3.Name = "par3"
                par3.Values.Add(str_delegacion)

                Dim par8 As New ReportParameter()
                par8.Name = "par8"
                par8.Values.Add(strCarril)


                'int_numero_poste = CInt(oDataRow("Expr1"))


                Dim par7 As New ReportParameter()
                par7.Name = "par7"


                If bl_varios_turnos = False Then
                    'par7.Values.Add(str_Turno_block)
                    par7.Values.Add(No_Turno)
                Else

                    If CInt(Format((hr_fecha_ini_varios_turnos), "HH")) >= 6 And CInt(Format((hr_fecha_ini_varios_turnos), "HH")) < 14 Then
                        'par7.Values.Add(gl_turno_2)
                        par7.Values.Add(No_Turno)
                    ElseIf CInt(Format((hr_fecha_ini_varios_turnos), "HH")) >= 14 And CInt(Format((hr_fecha_ini_varios_turnos), "HH")) < 22 Then
                        par7.Values.Add(No_Turno)
                        'par7.Values.Add(gl_turno_3)
                    Else
                        par7.Values.Add(No_Turno)
                        'par7.Values.Add(gl_turno_1)
                    End If

                End If

                Dim par4 As New ReportParameter()
                par4.Name = "par4"
                'par4.Values.Add(Format((hr_fecha_ini_varios_turnos), "MM/dd/yyyy HH:mm:ss"))
                par4.Values.Add(Format((hr_fecha_ini_varios_turnos), "HH:mm:ss"))
                dt_ini_poste = Format((hr_fecha_ini_varios_turnos), "MM/dd/yyyy HH:mm:ss")

                Dim par1 As New ReportParameter()
                par1.Name = "par1"
                'par1.Values.Add(Format((hr_fecha_ini_varios_turnos), "MM/dd/yyyy"))
                'par1.Values.Add(Format((hr_fecha_ini_varios_turnos), "dd/MM/yyyy"))
                par1.Values.Add(Format((dt_Fecha_Inicio), "dd/MM/yyyy"))

                Dim par6 As New ReportParameter()
                par6.Name = "par6"
                'par6.Values.Add(Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy HH:mm:ss"))
                par6.Values.Add(Format((hr_fecha_fin_varios_turnos), "HH:mm:ss"))
                dt_fin_poste = Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy HH:mm:ss")

                'folios
                Dim par69 As New ReportParameter()
                par69.Name = "par69"
                par69.Values.Add(0)


                Dim par70 As New ReportParameter()
                par70.Name = "par70"
                par70.Values.Add(0)

                Dim par71 As New ReportParameter()
                par71.Name = "par71"
                par71.Values.Add(0)

                Dim par73 As New ReportParameter()
                par73.Name = "par73"
                par73.Values.Add(0)

                'FOLIOS 2
                Dim par74 As New ReportParameter()
                par74.Name = "par74"
                par74.Values.Add(0)

                Dim par75 As New ReportParameter()
                par75.Name = "par75"
                par75.Values.Add(0)

                Dim par76 As New ReportParameter()
                par76.Name = "par76"

                par76.Values.Add(0)



                Dim par78 As New ReportParameter()
                par78.Name = "par78"
                par78.Values.Add(0)





                'FOLIOS 3
                Dim par79 As New ReportParameter()
                par79.Name = "par79"
                par79.Values.Add(0)

                Dim par80 As New ReportParameter()
                par80.Name = "par80"
                par80.Values.Add(0)

                Dim par81 As New ReportParameter()
                par81.Name = "par81"

                par81.Values.Add(0)



                Dim par83 As New ReportParameter()
                par83.Name = "par83"

                par83.Values.Add(0)


                'par74, par75, par76, par78, par79, par80,par81, par83
                '---------------------------------
                Dim par84 As New ReportParameter()
                par84.Name = "par84"
                'par84.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_INITIAL"), "###,###,###,##0"))
                par84.Values.Add(0)

                Dim par85 As New ReportParameter()
                par85.Name = "par85"
                par85.Values.Add(0)

                Dim par86 As New ReportParameter()
                par86.Name = "par86"
                'par86.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_FINAL") - oDataRow("FOLIO_ECT_NUMBER_INITIAL") + 1, "###,###,###,##0"))
                par86.Values.Add(0)

                Dim par88 As New ReportParameter()
                par88.Name = "par88"
                'par88.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_FINAL") - oDataRow("FOLIO_ECT_NUMBER_INITIAL") + 1, "###,###,###,##0"))
                par88.Values.Add(0)

                '-----------------------------------------------------------------------------





                Dim parametersTitulos() As ReportParameter = {par3, par8, par7, par8, par4, par1, par6, par69, par70, par71, par73, par74, par75, par76, par78, par79, par80, par81, par83, par84, par85, par86, par88}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos)

                'Next


                'Else
                '    ' rpt_reporte = Nothing
                '    ReportViewer1 = Nothing
                '    MsgBox("No existen datos", MsgBoxStyle.Exclamation, "PRELIQUIDACION DE CAJERO RECEPTOR")
                '    Me.Close()
                'End If

                'OPERADOR
                strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
             "FROM TABLE_PERSONNEL " &
             "WHERE Matricule = '" & loc_operador & "'"
                If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                    'Dim par97 As New ReportParameter()
                    'par97.Name = "par97"
                    'par97.Values.Add(Trim(oDataRowTres("MATRICULE")) & "     " & Trim(oDataRowTres("nombre")))

                    'Dim par98 As New ReportParameter()
                    'par98.Name = "par98"
                    'par98.Values.Add(Trim(oDataRowTres("MATRICULE")) & "     " & Trim(oDataRowTres("nombre")))

                    str_MATRICULE = Trim(oDataRowTres("MATRICULE"))

                    'Dim parametersTitulos_2() As ReportParameter = {par97, par98}
                    'ReportViewer1.LocalReport.SetParameters(parametersTitulos_2)

                End If

                'Jorge
                Dim par97 As New ReportParameter()
                par97.Name = "par97"
                par97.Values.Add(Trim(oDataRowTres("MATRICULE")) & "     " & Trim(oDataRowTres("nombre")))

                Dim par98 As New ReportParameter()
                par98.Name = "par98"
                'par98.Values.Add(srt_Encargado_Reporte) 'Jorge
                par98.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", int_Encargado_Reporte.ToString())) & "     " & srt_Encargado_Reporte)

                '***** JORGE - Comentario linea uno (1)
                Dim parLineaUno As New ReportParameter()
                parLineaUno.Name = "parLineaUno"
                parLineaUno.Values.Add(PrimeraLinea)

                Dim parLineaDos As New ReportParameter()
                parLineaDos.Name = "parLineaDos"
                parLineaDos.Values.Add(SegundaLinea)

                Dim parLineaTres As New ReportParameter()
                parLineaTres.Name = "parLineaTres"
                parLineaTres.Values.Add(TerceraLinea)

                Dim parametersTitulos_2() As ReportParameter = {par97, par98, parLineaUno, parLineaDos, parLineaTres}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_2)

                '*****

                'encargado de plaza
                strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
             "FROM TABLE_PERSONNEL " &
             "WHERE Matricule = '" & objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", "encargado_plaza") & "'"


                If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                    Dim par99 As New ReportParameter()
                    par99.Name = "par99"

                    par99.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", oDataRowTres("Matricule"))) & "     " & Trim(oDataRowTres("nombre")))

                    Dim parametersTitulos_admon() As ReportParameter = {par99}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_admon)

                End If






                strQuerys = "SELECT  ID_RESEAU, ID_GARE, NOM_GARE, NOM_GARE_L2 " &
             "FROM GEADBA.TYPE_GARE " &
             "WHERE ID_GARE = " & loc_id_gare & ""

                If objQuerys.QueryDataSetTres(strQuerys, "TYPE_GARE") = 1 Then

                    Dim par5 As New ReportParameter()
                    par5.Name = "par5"
                    'par5.Values.Add(oDataRowTres("NOM_GARE"))

                    If id_plaza_cobro_local <> "08" Then
                        If id_plaza_cobro_local <> "09" Then
                            par5.Values.Add("1" & id_plaza_cobro_local & " " & oDataRowTres("NOM_GARE"))
                        Else
                            par5.Values.Add("001 BIS" & " " & oDataRowTres("NOM_GARE"))
                        End If

                    Else
                        par5.Values.Add("001" & " " & oDataRowTres("NOM_GARE"))
                    End If

                    int_id_gare = oDataRowTres("ID_GARE")

                    str_id_RESEAU = oDataRowTres("ID_RESEAU")

                    Dim parametersTitulos_3() As ReportParameter = {par5}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_3)

                End If


                'pantalla:RESUMEN DE INGRESO CAJERO
                'strQuerys = "SELECT MATRICULE,SAC AS Expr1, NVL(NB_POSTE, 0) + NVL(NB_POSTE_POS, 0) AS Expr2, NVL(RED_RCT_MONNAIE1, 0) AS Expr3, " & _
                '            "NVL(RED_RCT_CHQ, 0) AS Expr4, NVL(RED_NB_CHQ, 0) AS Expr5, NVL(RED_RCT_DEVISE, 0) AS Expr6, NVL(RED_RCT_MONNAIE3, 0) AS Expr7, " & _
                '            "NVL(RED_RCT_MONNAIE4, 0) AS Expr8, NVL(RED_CPT1, 0) AS Expr9, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) + NVL(RED_RCT_MONNAIE3, 0) " & _
                '            "+ NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_CHQ, 0) + NVL(RED_RCT_DEVISE, 0) AS Expr10, NVL(POSTE_RCT_MONNAIE1, 0) + NVL(POSTE_RCT_MONNAIE2, 0) " & _
                '            "+ NVL(POSTE_RCT_MONNAIE3, 0) + NVL(POSTE_RCT_MONNAIE4, 0) + NVL(POSTE_RCT_DEVISE, 0) + NVL(POSTE_RCT_CHQ, 0) + NVL(POSTE_POS_RCT_MONNAIE1, " & _
                '            "0) + NVL(POSTE_POS_RMB_MONNAIE1, 0) + NVL(POSTE_POS_RCT_MONNAIE2, 0) + NVL(POSTE_POS_RCT_MONNAIE3, 0) + NVL(POSTE_POS_RCT_MONNAIE4, 0) " & _
                '            "+ NVL(POSTE_POS_RCT_DEVISE, 0) + NVL(POSTE_POS_RCT_CHQ, 0) AS Expr11, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) " & _
                '            "+ NVL(RED_RCT_MONNAIE3, 0) + NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_DEVISE, 0) + NVL(RED_RCT_CHQ, 0) - NVL(POSTE_RCT_MONNAIE1, 0) " & _
                '            "- NVL(POSTE_RCT_MONNAIE2, 0) - NVL(POSTE_RCT_MONNAIE3, 0) - NVL(POSTE_RCT_MONNAIE4, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_RCT_CHQ, 0) " & _
                '            "- NVL(POSTE_POS_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE2, 0) - NVL(POSTE_POS_RCT_MONNAIE3, 0) " & _
                '            "- NVL(POSTE_POS_RCT_MONNAIE4, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr12, NVL(RED_RCT_MONNAIE1, 0) " & _
                '            "- NVL(POSTE_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE1, 0) AS Expr13, NVL(RED_RCT_CHQ, 0) " & _
                '            "- NVL(POSTE_RCT_CHQ, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr14, NVL(RED_RCT_DEVISE, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) " & _
                '            "AS Expr15, NVL(RED_CPT24, 0) AS Expr16, NVL(RED_CPT25, 0) AS Expr17, NVL(RED_JETON, 0) - NVL(POSTE_JETON, 0) AS Expr18, NVL(RED_RDD, 0) " & _
                '            "- NVL(POSTE_RDD, 0) AS Expr19, NVL(RED_GRATUIT, 0) + NVL(RED_CPT2, 0) - NVL(POSTE_GRATUIT, 0) AS Expr20, MATRICULE_COMMENTAIRE, COMMENTAIRE, " & _
                '            "0 AS Expr21, TO_CHAR(DATE_REDDITION, 'YYYYMMDDHH24MISS') AS Expr22, ID_SITE, RED_CPT21, NB_POSTE, ETAT_REDDITION, " & _
                '            "NVL(Red_Rct_Monnaie1,0)	+ NVL(Red_Rct_Devise,0)	+ NVL(Red_Rct_Chq,0) + NVL(Red_cpt21,0)	- NVL(Poste_Rct_Monnaie1,0) - NVL(Poste_Rct_Devise,0) - NVL(Poste_Rct_Chq,0) AS Expr23 " & _
                '            "FROM REDDITION " & _
                '            "WHERE  (ID_SITE = '" & id_plaza_cobro_local & "') AND (MATRICULE = '" & oDataRow("MATRICULE") & "') AND (SAC = '" & oDataRow("Expr4") & "')"
                ''(DATE_REDDITION = TO_DATE('20130206071615', 'YYYYMMDDHH24MISS')) AND 'no se obtiene

                'If objQuerys.QueryDataSetDos(strQuerys, "REDDITION") = 1 Then

                VAR_11 = 0
                VAR_50 = 0
                VAR_63 = 0

                VAR_67 = 0
                VAR_65 = 0

                Dim par9 As New ReportParameter()
                par9.Name = "par9"
                'par9.Values.Add(Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy"))
                par9.Values.Add(Format((hr_fecha_fin_varios_turnos), "dd/MM/yyyy"))

                Dim par10 As New ReportParameter()
                par10.Name = "par10"
                par10.Values.Add(Format((hr_fecha_fin_varios_turnos), "HH:mm:ss"))

                Dim par2 As New ReportParameter()
                par2.Name = "par2"
                par2.Values.Add(Format((hr_fecha_fin_varios_turnos), "yyyy") & Format((hr_fecha_fin_varios_turnos), "MM") & Format((hr_fecha_fin_varios_turnos), "dd") & Format((hr_fecha_fin_varios_turnos), "HH") & Format((hr_fecha_fin_varios_turnos), "mm") & Format((hr_fecha_fin_varios_turnos), "ss"))
                '2013/10/01
                Dim par63 As New ReportParameter()
                par63.Name = "par63"
                par63.Values.Add(Format(VAR_63, "###,###,##0.00"))

                Dim par65 As New ReportParameter()
                par65.Name = "par65"
                par65.Values.Add(Format(VAR_65, "###,###,##0.00"))

                Dim par67 As New ReportParameter()
                par67.Name = "par67"
                par67.Values.Add(Format(VAR_67, "###,###,##0.00"))

                Dim par94 As New ReportParameter()
                par94.Name = "par94"
                par94.Values.Add(Format(CDec(VAR_11 + VAR_63), "###,###,##0.00"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("PRELIQUIDACIÓN DE CAJERO-RECEPTOR DE CARRILES CERRADOS")

                Dim parametersTitulos_4() As ReportParameter = {par2, par9, par10, par63, par94, parTituloReporte}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_4)

                Dim parametersTitulos_5() As ReportParameter = {par65, par67}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)

                'End If

                'turno carril
            ElseIf int_reporte = 2 Then
                ReportViewer1.LocalReport.DataSources.Clear()
                ReportViewer1.LocalReport.ReportEmbeddedResource = "rptPreliquidacion_Cajero_Receptor_Transito_Vehicular_2.rdlc"

                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "2 MATUTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "3 VESPERTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "1 NOCTURNO"
                End If


                'titulos

                Dim par3 As New ReportParameter()
                par3.Name = "par3"
                par3.Values.Add(str_delegacion)

                Dim par5 As New ReportParameter()
                par5.Name = "par5"
                par5.Values.Add(str_Plaza_Cobro)


                Dim par4 As New ReportParameter()
                par4.Name = "par4"
                'par4.Values.Add(str_Turno_block)
                'No_Turno
                par4.Values.Add(No_Turno)

                Dim par1 As New ReportParameter()
                par1.Name = "par1"
                If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    par1.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "MM/dd/yyyy"))
                Else
                    par1.Values.Add(Format(dt_ini_poste, "MM/dd/yyyy"))
                End If

                Dim par7 As New ReportParameter()
                par7.Name = "par7"
                par7.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim par9 As New ReportParameter()
                par9.Name = "par9"
                par9.Values.Add(Format(Now, "HH:mm:ss"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("PRELIQUIDACIÓN DE TURNO/CARRILES DE CARRILES CERRADOS")

                Dim parameters() As ReportParameter = {par3, par5, par4, par1, par7, par9, parTituloReporte}
                ReportViewer1.LocalReport.SetParameters(parameters)
                'fin titulos




                VAR_11 = VAR_11
                VAR_50 = VAR_50

                'Dim par63 As New ReportParameter()
                'par63.Name = "par63"
                'par63.Values.Add(Format(CDec(oDataRowDos("Expr10")), "###,###,##0.00"))

                db_acom_63 = db_acom_63




                db_acom_67 = db_acom_67 + 0
                db_acom_65 = db_acom_65 + 0



                db_acom_94 = db_acom_94 + (VAR_11 + VAR_50) 'oDataRowDos("Expr10")

                'folios
                'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - (oDataRow("FOLIO_NUMBER_OPEN") + 1))
                'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1)

                'If oDataRow("FOLIO2_NUMBER_FINAL") = 0 And oDataRow("FOLIO2_NUMBER_FINAL") = 0 Then
                'Else
                '    db_acom_folios2 = db_acom_folios2 + oDataRow("FOLIO2_NUMBER_FINAL") - oDataRow("FOLIO2_NUMBER_INITIAL") + 1
                'End If
                'If oDataRow("FOLIO3_NUMBER_FINAL") = 0 And oDataRow("FOLIO3_NUMBER_FINAL") = 0 Then

                'Else
                '    db_acom_folios3 = db_acom_folios3 + oDataRow("FOLIO3_NUMBER_FINAL") - oDataRow("FOLIO3_NUMBER_INITIAL") + 1
                'End If

                'db_acom_eventos = db_acom_eventos + (oDataRow("FINAL_EVENT_NUMBER") - oDataRow("INITIAL_EVENT_NUMBER") + 1)



                'FOLIO2_NUMBER_INITIAL, FOLIO2_NUMBER_FINAL, FOLIO3_NUMBER_INITIAL, FOLIO3_NUMBER_FINAL



                Dim par63 As New ReportParameter()
                par63.Name = "par63"
                par63.Values.Add(Format(CDec(db_acom_63), "###,###,##0.00"))

                Dim par94 As New ReportParameter()
                par94.Name = "par94"
                'par94.Values.Add(Format(CDec(db_acom_94), "###,###,##0.00"))
                par94.Values.Add(Format(CDec(VAR_11 + db_acom_63), "###,###,##0.00"))

                Dim parametersTitulos_4() As ReportParameter = {par63, par94}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_4)


                Dim par65 As New ReportParameter()
                par65.Name = "par65"
                par65.Values.Add(Format(CDec(db_acom_65), "###,###,##0.00"))

                Dim par67 As New ReportParameter()
                par67.Name = "par67"
                par67.Values.Add(Format(CDec(db_acom_67), "###,###,##0.00"))

                Dim par69 As New ReportParameter()
                par69.Name = "par69"
                par69.Values.Add(Format(db_acom_folios, "###,###,###,##0"))

                Dim par74 As New ReportParameter()
                par74.Name = "par74"
                par74.Values.Add(Format(db_acom_folios2, "###,###,###,##0"))

                Dim par79 As New ReportParameter()
                par79.Name = "par79"
                par79.Values.Add(Format(db_acom_folios3, "###,###,###,##0"))

                Dim par89 As New ReportParameter()
                par89.Name = "par89"
                par89.Values.Add(Format(db_acom_eventos, "###,###,###,##0"))

                Dim parametersTitulos_5() As ReportParameter = {par65, par67, par69, par89, par74, par79}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)



                'dia
            ElseIf int_reporte = 3 Then
                ReportViewer1.LocalReport.DataSources.Clear()
                ReportViewer1.LocalReport.ReportEmbeddedResource = "rptPreliquidacion_Cajero_Receptor_Transito_Vehicular_2.rdlc"

                h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")

                h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")

                'titulos

                Dim par3 As New ReportParameter()
                par3.Name = "par3"
                par3.Values.Add(str_delegacion)

                Dim par5 As New ReportParameter()
                par5.Name = "par5"
                par5.Values.Add(str_Plaza_Cobro)


                'Dim par4 As New ReportParameter()
                'par4.Name = "par4"
                'par4.Values.Add(str_Turno_block)

                Dim par1 As New ReportParameter()
                par1.Name = "par1"
                If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    par1.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "MM/dd/yyyy"))
                Else
                    par1.Values.Add(Format(dt_ini_poste, "MM/dd/yyyy"))
                End If

                Dim par7 As New ReportParameter()
                par7.Name = "par7"
                par7.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim par9 As New ReportParameter()
                par9.Name = "par9"
                par9.Values.Add(Format(Now, "HH:mm:ss"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("PRELIQUIDACIÓN DE DÍA/CASETA DE CARRILES CERRADOS")

                Dim parameters() As ReportParameter = {par3, par5, par1, par7, par9, parTituloReporte}
                ReportViewer1.LocalReport.SetParameters(parameters)
                'fin titulos

                'SACO LOS TURNOS

                VAR_11 = VAR_11
                VAR_50 = VAR_50
                'Dim par63 As New ReportParameter()
                'par63.Name = "par63"
                'par63.Values.Add(Format(CDec(oDataRowDos("Expr10")), "###,###,##0.00"))

                db_acom_63 = db_acom_63




                db_acom_67 = db_acom_67 + 0
                db_acom_65 = db_acom_65 + 0


                db_acom_94 = db_acom_94 + (VAR_11 + VAR_50) 'oDataRowDos("Expr10")

                'folios
                'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - (oDataRow("FOLIO_NUMBER_OPEN") + 1))
                'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1)

                'If oDataRow("FOLIO2_NUMBER_FINAL") = 0 And oDataRow("FOLIO2_NUMBER_FINAL") = 0 Then
                'Else
                '    db_acom_folios2 = db_acom_folios2 + oDataRow("FOLIO2_NUMBER_FINAL") - oDataRow("FOLIO2_NUMBER_INITIAL") + 1
                'End If
                'If oDataRow("FOLIO3_NUMBER_FINAL") = 0 And oDataRow("FOLIO3_NUMBER_FINAL") = 0 Then

                'Else
                '    db_acom_folios3 = db_acom_folios3 + oDataRow("FOLIO3_NUMBER_FINAL") - oDataRow("FOLIO3_NUMBER_INITIAL") + 1
                'End If

                'db_acom_eventos = db_acom_eventos + (oDataRow("FINAL_EVENT_NUMBER") - oDataRow("INITIAL_EVENT_NUMBER") + 1)









                Dim par63 As New ReportParameter()
                par63.Name = "par63"
                par63.Values.Add(Format(CDec(db_acom_63), "###,###,##0.00"))

                Dim par94 As New ReportParameter()
                par94.Name = "par94"
                'par94.Values.Add(Format(CDec(db_acom_94), "###,###,##0.00"))
                par94.Values.Add(Format(CDec(VAR_11 + db_acom_63), "###,###,##0.00"))

                Dim parametersTitulos_4() As ReportParameter = {par63, par94}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_4)


                Dim par65 As New ReportParameter()
                par65.Name = "par65"
                par65.Values.Add(Format(CDec(db_acom_65), "###,###,##0.00"))

                Dim par67 As New ReportParameter()
                par67.Name = "par67"
                par67.Values.Add(Format(CDec(db_acom_67), "###,###,##0.00"))

                Dim par69 As New ReportParameter()
                par69.Name = "par69"
                par69.Values.Add(Format(db_acom_folios, "###,###,###,##0"))

                Dim par74 As New ReportParameter()
                par74.Name = "par74"
                par74.Values.Add(Format(db_acom_folios2, "###,###,###,##0"))

                Dim par79 As New ReportParameter()
                par79.Name = "par79"
                par79.Values.Add(Format(db_acom_folios3, "###,###,###,##0"))


                Dim par89 As New ReportParameter()
                par89.Name = "par89"
                par89.Values.Add(Format(db_acom_eventos, "###,###,###,##0"))

                Dim parametersTitulos_5() As ReportParameter = {par65, par67, par69, par89, par74, par79}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)









                'fin de SACAR TURNOS


            End If

            Dim par11 As New ReportParameter()
            Dim par12 As New ReportParameter()
            Dim par13 As New ReportParameter()
            Dim par14 As New ReportParameter()
            Dim par15 As New ReportParameter()
            Dim par16 As New ReportParameter()
            Dim par17 As New ReportParameter()
            Dim par18 As New ReportParameter()
            Dim par19 As New ReportParameter()
            Dim par20 As New ReportParameter()
            Dim par21 As New ReportParameter()
            Dim par22 As New ReportParameter()
            Dim par23 As New ReportParameter()
            Dim par24 As New ReportParameter()
            Dim par25 As New ReportParameter()
            Dim par26 As New ReportParameter()
            Dim par27 As New ReportParameter()
            Dim par28 As New ReportParameter()
            Dim par29 As New ReportParameter()
            Dim par30 As New ReportParameter()
            Dim par31 As New ReportParameter()
            Dim par32 As New ReportParameter()
            Dim par33 As New ReportParameter()
            Dim par34 As New ReportParameter()
            Dim par35 As New ReportParameter()
            Dim par36 As New ReportParameter()
            Dim par37 As New ReportParameter()
            Dim par38 As New ReportParameter()
            Dim par39 As New ReportParameter()
            Dim par40 As New ReportParameter()
            Dim par41 As New ReportParameter()
            Dim par42 As New ReportParameter()
            Dim par43 As New ReportParameter()

            Dim par140 As New ReportParameter()
            Dim par141 As New ReportParameter()
            Dim par142 As New ReportParameter()
            Dim par143 As New ReportParameter()

            Dim par44 As New ReportParameter()
            Dim par45 As New ReportParameter()
            Dim par46 As New ReportParameter()
            Dim par47 As New ReportParameter()
            Dim par48 As New ReportParameter()
            Dim par49 As New ReportParameter()
            Dim par50 As New ReportParameter()
            Dim par51 As New ReportParameter()
            Dim par52 As New ReportParameter()
            Dim par53 As New ReportParameter()
            Dim par54 As New ReportParameter()
            Dim par55 As New ReportParameter()
            Dim par56 As New ReportParameter()
            Dim par57 As New ReportParameter()
            Dim par58 As New ReportParameter()
            Dim par59 As New ReportParameter()
            Dim par60 As New ReportParameter()
            Dim par61 As New ReportParameter()
            Dim par62 As New ReportParameter()

            par11.Name = "par11"
            par11.Values.Add(Format(VAR_11, "###,###,##0.00"))


            str_id_RESEAU = 0
            int_id_gare = 0
            str_id_voie = 0
            id_plaza_cobro_local = 0

            If int_reporte = 1 Then


                'folio ini
                strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces, MIN(EVENT_NUMBER) AS minimo, MAX(EVENT_NUMBER) as maximo " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
    "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
    "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) AND ID_OBS_PASSAGE <> '1' "

                If int_reporte = 1 Then

                    strQuerys = strQuerys & " " &
                    "AND TRANSACTION.ID_GARE = " & loc_id_gare & " " &
                    "AND VOIE = '" & strCarril & "' "

                ElseIf int_reporte = 2 Then
                    strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
                ElseIf int_reporte = 3 Then
                    strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
                End If

                'strQuerys = strQuerys & "AND (ID_OBS_SEQUENCE = '5') "

                If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then


                    Dim par89 As New ReportParameter()
                    par89.Name = "par89"

                    If oDataRow("Cruces") > 0 Then
                        par89.Values.Add(oDataRow("minimo"))
                    Else
                        par89.Values.Add(0)
                    End If


                    Dim par90 As New ReportParameter()
                    par90.Name = "par90"
                    'par90.Values.Add(oDataRow("Cruces"))

                    If oDataRow("Cruces") > 0 Then
                        par90.Values.Add(oDataRow("maximo"))
                    Else
                        par90.Values.Add(0)
                    End If


                    Dim par91 As New ReportParameter()
                    par91.Name = "par91"
                    par91.Values.Add(oDataRow("Cruces"))

                    Dim par93 As New ReportParameter()
                    par93.Name = "par93"
                    par93.Values.Add(oDataRow("Cruces"))

                    Dim parametersTitulos() As ReportParameter = {par89, par90, par91, par93}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos)




                End If

            Else

                'turno
                'dia carril
                strQuerys = "SELECT ID_NETWORK, ID_PLAZA,ID_LANE, LANE, BEGIN_DHM, END_DHM, BAG_NUMBER, REPORT_FLAG, GENERATION_DHM " &
    "FROM CLOSED_LANE_REPORT, SITE_GARE " &
    "where " &
    "CLOSED_LANE_REPORT.ID_PLAZA	=	SITE_GARE.id_Gare " &
    "AND	SITE_GARE.id_Site		=	'" & id_plaza_cobro & "' "

                If int_reporte = 2 Then


                    If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                        h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                        h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                        No_Turno = "2 MATUTINO"
                    ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                        h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                        h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                        No_Turno = "3 VESPERTINO"
                    ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                        'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                        h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                        'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                        h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                        No_Turno = "1 NOCTURNO"
                    End If

                ElseIf int_reporte = 3 Then
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                End If

                strQuerys = strQuerys & "AND (BEGIN_DHM >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(BEGIN_DHM <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
           "order by BEGIN_DHM"

                If objQuerys.QueryDataSet(strQuerys, "CLOSED_LANE_REPORT") = 1 Then

                    For cont = 0 To oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Count - 1
                        oDataRow = oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Item(cont)


                        strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces, MIN(EVENT_NUMBER) AS minimo, MAX(EVENT_NUMBER) as maximo " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(oDataRow("BEGIN_DHM"), "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(oDataRow("END_DHM"), "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) AND ID_OBS_PASSAGE <> '1' "


                        strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro & " "


                        'strQuerys = strQuerys & "AND (ID_OBS_SEQUENCE = '5') "

                        If objQuerys.QueryDataSetDos(strQuerys, "TRANSACTION") = 1 Then

                            VAR_89 = VAR_89 + oDataRowDos("Cruces")

                        End If

                    Next

                    Dim par89 As New ReportParameter()
                    par89.Name = "par89"
                    par89.Values.Add(VAR_89)


                    Dim parametersTitulos() As ReportParameter = {par89}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos)

                End If



            End If

            'folio fin



            'BOLETOS GENERADOS POR ERROR
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_OBS_SEQUENCE = '5') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par12.Name = "par12"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par12.Values.Add(Format(0, "###,###,##0.00"))
                    VAR_12 = 0
                Else
                    ' par12.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    'VAR_12 = oDataRow("Monto_1")

                    par12.Values.Add(Format(0, "###,###,##0.00"))
                    VAR_12 = 0
                End If


                par13.Name = "par13"
                If IsDBNull(oDataRow("Cruces")) Then
                    par13.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par13.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_13 = oDataRow("Cruces")
                End If


            End If
            '---------------------------------------
            'par12.Name = "par12"
            'par12.Values.Add(Format(0, "###,###,##0.00"))

            'par13.Name = "par13"
            'par13.Values.Add(Format(0, "###,###,##0"))

            'VEHICULOS RESIDENTES PAGO INMEDIATO

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1, SUM(PRIX_TOTAL) AS Monto_2, COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
      "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
    "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
    "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 " &
    "OR ID_PAIEMENT = 72 " &
    "OR ID_PAIEMENT = 73 " &
    "OR ID_PAIEMENT = 74  or ID_PAIEMENT = 10) AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                par14.Name = "par14"
                If IsDBNull(oDataRow("Monto_2")) Then
                    par14.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par14.Values.Add(Format(oDataRow("Monto_2"), "###,###,##0.00"))
                End If

                par15.Name = "par15"
                If IsDBNull(oDataRow("Monto_2")) Then
                    par15.Values.Add(Format(0, "###,###,##0"))
                Else
                    par15.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                End If

                VAR_14 = IIf(IsDBNull(oDataRow("Monto_2")), 0, oDataRow("Monto_2"))
                VAR_15 = IIf(IsDBNull(oDataRow("Cruces")), 0, oDataRow("Cruces"))
            End If

            'SUBTOTAL MARCADO COMO PAGADO
            VAR_16 = VAR_11 + VAR_12
            par16.Name = "par16"
            par16.Values.Add(Format(VAR_16, "###,###,##0.00"))
            '-------------------
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
     "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
    "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
    "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 1 " &
 "OR ID_PAIEMENT = 2 " &
"OR ID_PAIEMENT = 71 " &
                "OR ID_PAIEMENT = 72 " &
                "OR ID_PAIEMENT = 73 " &
                "OR ID_PAIEMENT = 74  or ID_PAIEMENT = 10) " &
                "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            '  strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                par17.Name = "par17"
                If IsDBNull(oDataRow("Cruces")) Then
                    ' par17.Values.Add(Format(0 + VAR_13 + VAR_15, "###,###,##0"))
                    par17.Values.Add(Format(0 + VAR_13, "###,###,##0"))
                Else
                    'par17.Values.Add(Format(oDataRow("Cruces") + VAR_13 + VAR_15, "###,###,##0"))
                    par17.Values.Add(Format(oDataRow("Cruces") + VAR_13, "###,###,##0"))
                End If


                'VAR_17 = IIf(IsDBNull(oDataRow("Cruces")), 0 + VAR_13 + VAR_15, oDataRow("Cruces") + VAR_13 + VAR_15)
                VAR_17 = IIf(IsDBNull(oDataRow("Cruces")), 0 + VAR_13, oDataRow("Cruces") + VAR_13)
            End If

            '2013/10/09
            '-----------------------------
            '          strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            ' "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
 "FROM GEADBA.TRANSACTION,SITE_GARE " &
  "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
 "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
 "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 1 " &
                 "OR ID_PAIEMENT = 2 " &
                 "OR ID_PAIEMENT = 71 " &
                 "OR ID_PAIEMENT = 72 " &
                 "OR ID_PAIEMENT = 73 " &
                 "OR ID_PAIEMENT = 74  or ID_PAIEMENT = 10) " &
                 "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                par18.Name = "par18"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par18.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par18.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                End If

                VAR_18 = IIf(IsDBNull(oDataRow("Monto_1")), 0, oDataRow("Monto_1"))


                par19.Name = "par19"
                If IsDBNull(oDataRow("Cruces")) Then
                    par19.Values.Add(Format(0, "###,###,##0"))
                Else
                    par19.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                End If

                VAR_18 = IIf(IsDBNull(oDataRow("Monto_1")), 0, oDataRow("Monto_1"))
                VAR_19 = IIf(IsDBNull(oDataRow("Cruces")), 0, oDataRow("Cruces"))
            End If

            VAR_20 = VAR_16 - VAR_18
            par20.Name = "par20"
            par20.Values.Add(Format(VAR_20, "###,###,##0.00"))

            VAR_21 = VAR_17 - VAR_19
            par21.Name = "par21"
            par21.Values.Add(Format(VAR_21, "###,###,##0"))



            'BOLETOS RESIDENTES P.A.
            par22.Name = "par22"
            par22.Values.Add(Format(VAR_22, "###,###,##0.00"))

            par23.Name = "par23"
            par23.Values.Add(Format(VAR_23, "###,###,##0"))

            par24.Name = "par24"
            par24.Values.Add(Format(VAR_24, "###,###,##0.00"))

            par25.Name = "par25"
            par25.Values.Add(Format(VAR_25, "###,###,##0"))

            par26.Name = "par26"
            par26.Values.Add(Format(VAR_26, "###,###,##0.00"))

            par27.Name = "par27"
            par27.Values.Add(Format(VAR_27, "###,###,##0"))

            'SISTEMAS ELECTRONICOS
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " '& _
            'nota 2013/10/01
            '"AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par28.Name = "par28"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par28.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par28.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_28 = oDataRow("Monto_1")
                End If

                par29.Name = "par29"
                If IsDBNull(oDataRow("Cruces")) Then
                    par29.Values.Add(Format(0, "###,###,##0"))
                Else
                    par29.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_29 = oDataRow("Cruces")
                End If

            End If

            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " '& _
            '"AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par30.Name = "par30"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par30.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par30.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_30 = oDataRow("Monto_1")
                End If

                par31.Name = "par31"
                If IsDBNull(oDataRow("Cruces")) Then
                    par31.Values.Add(Format(0, "###,###,##0"))
                Else
                    par31.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_31 = oDataRow("Cruces")
                End If

            End If


            'VSC
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') "


            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par32.Name = "par32"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par32.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par32.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_32 = oDataRow("Monto_1")
                End If

                par33.Name = "par33"
                If IsDBNull(oDataRow("Cruces")) Then
                    par33.Values.Add(Format(0, "###,###,##0"))
                Else
                    par33.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_33 = oDataRow("Cruces")
                End If

            End If

            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par34.Name = "par34"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par34.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par34.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_34 = oDataRow("Monto_1")
                End If

                par35.Name = "par35"
                If IsDBNull(oDataRow("Cruces")) Then
                    par35.Values.Add(Format(0, "###,###,##0"))
                Else
                    par35.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_35 = oDataRow("Cruces")
                End If

            End If

            'VEHICULOS RESIDENTES S.P.
            par36.Name = "par36"
            par36.Values.Add(Format(VAR_36, "###,###,##0.00"))

            par37.Name = "par37"
            par37.Values.Add(Format(VAR_37, "###,###,##0"))

            par38.Name = "par38"
            par38.Values.Add(Format(VAR_38, "###,###,##0.00"))

            par39.Name = "par39"
            par39.Values.Add(Format(VAR_39, "###,###,##0"))



            'VEHICULOS ELUDIDOS
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 13 " &
            "AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par40.Name = "par40"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par40.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par40.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_40 = oDataRow("Monto_1")
                End If

                par41.Name = "par41"
                If IsDBNull(oDataRow("Cruces")) Then
                    par41.Values.Add(Format(0, "###,###,##0"))
                Else
                    par41.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_41 = oDataRow("Cruces")
                End If

            End If

            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 13 " &
            "AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par42.Name = "par42"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par42.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par42.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_42 = oDataRow("Monto_1")
                End If

                par43.Name = "par43"
                If IsDBNull(oDataRow("Cruces")) Then
                    par43.Values.Add(Format(0, "###,###,##0"))
                Else
                    par43.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_43 = oDataRow("Cruces")
                End If

            End If

            'debito 140 141 142 143
            par140.Name = "par140"
            par140.Values.Add(Format(0, "###,###,##0.00"))

            par141.Name = "par141"
            par141.Values.Add(Format(0, "###,###,##0"))

            par142.Name = "par142"
            par142.Values.Add(Format(0, "###,###,##0.00"))

            par143.Name = "par143"
            par143.Values.Add(Format(0, "###,###,##0"))

            'TOTALES
            VAR_44 = VAR_16 + VAR_22 + VAR_28 + VAR_32 + VAR_36 + VAR_40
            par44.Name = "par44"
            par44.Values.Add(Format(VAR_44, "###,###,##0.00"))

            VAR_45 = VAR_17 + VAR_23 + VAR_29 + VAR_33 + VAR_37 + VAR_41
            par45.Name = "par45"
            par45.Values.Add(Format(VAR_45, "###,###,##0"))

            VAR_46 = VAR_18 + VAR_24 + VAR_30 + VAR_34 + VAR_38 + VAR_42
            par46.Name = "par46"
            par46.Values.Add(Format(VAR_46, "###,###,##0.00"))

            VAR_47 = VAR_19 + VAR_25 + VAR_31 + VAR_35 + VAR_39 + VAR_43
            par47.Name = "par47"
            par47.Values.Add(Format(VAR_47, "###,###,##0"))

            VAR_48 = VAR_44 - VAR_46
            par48.Name = "par48"
            par48.Values.Add(Format(VAR_48, "###,###,##0.00"))

            VAR_49 = VAR_45 - VAR_47
            par49.Name = "par49"
            par49.Values.Add(Format(VAR_49, "###,###,##0"))


            'EFECTIVO DLLS.
            par50.Name = "par50"
            par50.Values.Add(Format(VAR_50, "###,###,##0.00"))

            'BOLETOS GENERADOS POR ERROR
            par51.Name = "par51"
            par51.Values.Add(Format(VAR_51, "###,###,##0.00"))

            par52.Name = "par52"
            par52.Values.Add(Format(VAR_52, "###,###,##0"))

            'SUBTOTAL MARCADO COMO PAGADO
            par53.Name = "par53"
            par53.Values.Add(Format(VAR_53, "###,###,##0.00"))

            par54.Name = "par54"
            par54.Values.Add(Format(VAR_54, "###,###,##0"))

            par55.Name = "par55"
            par55.Values.Add(Format(VAR_55, "###,###,##0.00"))

            par56.Name = "par56"
            par56.Values.Add(Format(VAR_56, "###,###,##0"))

            VAR_57 = VAR_53 - VAR_55
            par57.Name = "par57"
            par57.Values.Add(Format(VAR_57, "###,###,##0.00"))

            VAR_58 = VAR_54 - VAR_56
            par58.Name = "par58"
            par58.Values.Add(Format(VAR_58, "###,###,##0"))

            'RECLASIFICADOS
            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            'strQuerys = strQuerys & "AND ID_PAIEMENT = 13 " & _
            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'F'"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par59.Name = "par59"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par59.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par59.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_59 = oDataRow("Monto_1")
                End If

                par60.Name = "par60"
                If IsDBNull(oDataRow("Cruces")) Then
                    par60.Values.Add(Format(0, "###,###,##0"))
                Else
                    par60.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_60 = oDataRow("Cruces")
                End If

            End If

            'DETECCIONES ERRONEAS
            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            'strQuerys = strQuerys & "AND ID_PAIEMENT = 13 " & _
            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par61.Name = "par61"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par61.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par61.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_61 = oDataRow("Monto_1")
                End If

                par62.Name = "par62"
                If IsDBNull(oDataRow("Cruces")) Then
                    par62.Values.Add(Format(0, "###,###,##0"))
                Else
                    par62.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_62 = oDataRow("Cruces")
                End If

            End If

            '------------------------------------
            'par61.Name = "par61"
            'par61.Values.Add(Format(VAR_61, "###,###,##0.00"))

            'par62.Name = "par62"
            'par62.Values.Add(Format(VAR_62, "###,###,##0"))


            '--------------------------------------------------------------------------------------------
            Dim parametersDetalle() As ReportParameter = {par11, par12, par13, par14, par15, par16, par17, par18, par19, par20, par21, par22, par23, par24, par25, par26, par27, par28, par29, par30, par31, par32, par33, par34, par35, par36, par37, par38, par39, par40, par41, par42, par43, par44, par45, par46, par47, par48, par49, par50, par51, par52, par53, par54, par55, par56, par57, par58, par59, par60, par61, par62, par140, par141, par142, par143}
            ReportViewer1.LocalReport.SetParameters(parametersDetalle)



            ReportViewer1.SetDisplayMode(DisplayMode.PrintLayout)
            Me.ReportViewer1.RefreshReport()

        Catch ex As Exception
            MsgBox(ex.Message)
        End Try



    End Sub


    'correccion clr
    Private Sub Preliquidacion_Cajero_Receptor_Transito_Vehicular_cerrados_II(ByVal int_reporte As Integer)


        Try

            Dim strQuerys As String
            Dim strQuerys_varios_cortes As String

            'Dim hr_fecha_ini_varios_turnos As Date
            'Dim hr_fecha_fin_varios_turnos As Date
            'Dim bl_varios_turnos As Boolean = False

            Dim odataSetReporte As New DataSet
            Dim oDataTableReporte As DataTable = New DataTable("tabla_reporte")
            Dim oDataColumnaReporte As DataColumn
            Dim oDatarowReporte As DataRow

            Dim strGrupo As String
            Dim strConcepto As String
            Dim strTipoConcepto_A As String
            Dim strTipoConcepto_B As String
            Dim strTipoConcepto_C As String
            Dim strTipoConceptoGenero_A As String
            Dim strTipoConceptoGenero_B As String

            strQuerys = strLinea

            'Dim rpt_reporte As New rptPreliquidacion_Cajero_Receptor_Transito_Vehicular
            'Dim objText As TextObject

            Dim str_id_RESEAU As String
            Dim int_id_gare As Integer
            Dim str_id_voie As String
            Dim int_id_voie As Integer
            Dim int_numero_poste As Integer
            Dim dt_ini_poste As Date
            Dim dt_fin_poste As Date
            Dim str_MATRICULE As String

            Dim str_cajero As String = str_Cajero_Receptor
            Dim id_plaza_cobro_local As String = id_plaza_cobro

            Dim h_inicio_turno As Date
            Dim h_fin_turno As Date

            '        'VARIABLES DE CAMPO
            Dim VAR_11 As Double = 0
            Dim VAR_12 As Double = 0
            Dim VAR_13 As Double = 0
            Dim VAR_14 As Double = 0
            Dim VAR_15 As Double = 0
            Dim VAR_16 As Double = 0
            Dim VAR_17 As Double = 0
            Dim VAR_18 As Double = 0
            Dim VAR_19 As Double = 0
            Dim VAR_20 As Double = 0
            Dim VAR_21 As Double = 0
            Dim VAR_22 As Double = 0
            Dim VAR_23 As Double = 0

            Dim VAR_24 As Double = 0
            Dim VAR_25 As Double = 0
            Dim VAR_26 As Double = 0
            Dim VAR_27 As Double = 0

            Dim VAR_28 As Double = 0
            Dim VAR_29 As Double = 0
            Dim VAR_30 As Double = 0
            Dim VAR_31 As Double = 0
            Dim VAR_32 As Double = 0
            Dim VAR_33 As Double = 0
            Dim VAR_34 As Double = 0
            Dim VAR_35 As Double = 0
            Dim VAR_36 As Double = 0
            Dim VAR_37 As Double = 0
            Dim VAR_38 As Double = 0
            Dim VAR_39 As Double = 0

            Dim VAR_40 As Double = 0
            Dim VAR_41 As Double = 0
            Dim VAR_42 As Double = 0
            Dim VAR_43 As Double = 0
            Dim VAR_44 As Double = 0
            Dim VAR_45 As Double = 0
            Dim VAR_46 As Double = 0
            Dim VAR_47 As Double = 0
            Dim VAR_48 As Double = 0
            Dim VAR_49 As Double = 0

            Dim VAR_50 As Double = 0
            Dim VAR_51 As Double = 0
            Dim VAR_52 As Double = 0
            Dim VAR_53 As Double = 0
            Dim VAR_54 As Double = 0
            Dim VAR_55 As Double = 0
            Dim VAR_56 As Double = 0
            Dim VAR_57 As Double = 0
            Dim VAR_58 As Double = 0
            Dim VAR_59 As Double = 0

            Dim VAR_60 As Double = 0
            Dim VAR_61 As Double = 0
            Dim VAR_62 As Double = 0
            Dim VAR_63 As Double = 0
            Dim VAR_64 As Double = 0
            Dim VAR_65 As Double = 0
            Dim VAR_66 As Double = 0
            Dim VAR_67 As Double = 0
            Dim VAR_68 As Double = 0
            Dim VAR_69 As Double = 0

            Dim VAR_70 As Double = 0
            Dim VAR_71 As Double = 0
            Dim VAR_72 As Double = 0
            Dim VAR_73 As Double = 0
            Dim VAR_74 As Double = 0
            Dim VAR_75 As Double = 0
            Dim VAR_76 As Double = 0
            Dim VAR_77 As Double = 0
            Dim VAR_78 As Double = 0
            Dim VAR_79 As Double = 0

            Dim VAR_80 As Double = 0
            Dim VAR_81 As Double = 0
            Dim VAR_82 As Double = 0
            Dim VAR_83 As Double = 0
            Dim VAR_84 As Double = 0
            Dim VAR_85 As Double = 0
            Dim VAR_86 As Double = 0
            Dim VAR_87 As Double = 0
            Dim VAR_88 As Double = 0
            Dim VAR_89 As Double = 0

            Dim VAR_90 As Double = 0
            Dim VAR_91 As Double = 0
            Dim VAR_92 As Double = 0
            Dim VAR_93 As Double = 0
            Dim VAR_94 As Double = 0
            Dim VAR_95 As Double = 0
            Dim VAR_96 As Double = 0
            Dim VAR_97 As Double = 0
            Dim VAR_98 As Double = 0
            Dim VAR_99 As Double = 0


            Dim cont As Double

            Dim db_acom_63 As Double = 0
            Dim db_acom_94 As Double = 0
            Dim db_acom_65 As Double = 0
            Dim db_acom_67 As Double = 0
            Dim db_acom_folios As Double = 0
            Dim db_acom_folios2 As Double = 0
            Dim db_acom_folios3 As Double = 0
            Dim db_acom_eventos As Double = 0

            Dim No_Turno As String

            Dim saco As String

            Dim loc_operador As String
            'Dim loc_id_site As Integer
            Dim loc_id_site As String
            'Dim loc_id_gare As Integer

            'Dim strCarril As String
            Dim IdCarril As Integer

            '
            Dim cont2 As Integer

            'reporte cajero receptor
            If int_reporte = 1 Then

                loc_operador = str_Cajero_Receptor
                loc_id_site = id_plaza_cobro

                str_id_voie = strCarril
                int_id_voie = IdCarril

                ReportViewer1.LocalReport.DataSources.Clear()
                ReportViewer1.LocalReport.ReportEmbeddedResource = "rptPreliquidacion_Cajero_Receptor_Transito_Vehicular.rdlc"


                '**************************************************
                '--------------------------------------------------
                '--------------------------------------------------
                '**************************************************



                'verifico cuantos cortes tiene en ese turno CERRADOS
                '               strQuerys = "SELECT ID_NETWORK, ID_PLAZA,ID_LANE, LANE, BEGIN_DHM, END_DHM, BAG_NUMBER, REPORT_FLAG, GENERATION_DHM " & _
                '"FROM CLOSED_LANE_REPORT, SITE_GARE " & _
                '"where " & _
                '"CLOSED_LANE_REPORT.ID_PLAZA	=	SITE_GARE.id_Gare " & _
                ' "AND	SITE_GARE.id_Site		=	'" & loc_id_site & "' "


                '               If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                '                   h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                '                   h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                '                   No_Turno = "5 MATUTINO"
                '               ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                '                   h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                '                   h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                '                   No_Turno = "6 VESPERTINO"
                '               ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                '                   'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                '                   h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                '                   'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                '                   h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                '                   No_Turno = "4 NOCTURNO"
                '               End If

                '               strQuerys = strQuerys & "AND (BEGIN_DHM >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '          "(BEGIN_DHM <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
                '          "order by BEGIN_DHM"

                '               If objQuerys.QueryDataSet(strQuerys, "CLOSED_LANE_REPORT") = 1 Then

                '                   'If oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Count = 1 Then
                '                   'ElseIf oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Count > 1 Then

                '                   Dim frmListas As New frmLineas
                '                   objControl.limpia_Catalogos()
                '                   frmListas.Tag = 5

                '                   strLinea = strQuerys

                '                   frmListas.ShowDialog()
                '                   If Trim(strLinea1) <> "" Then

                '                       bl_varios_turnos = True

                '                       hr_fecha_ini_varios_turnos = CDate(strLinea1)
                '                       hr_fecha_fin_varios_turnos = CDate(strLinea2)
                '                       strCarril = strLinea3
                '                       loc_id_gare = strLinea4



                '                   Else
                '                       Me.Close()
                '                       Exit Sub
                '                   End If

                '                   'End If

                '               End If


                '000----
                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "5 MATUTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "6 VESPERTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "4 NOCTURNO"
                End If


                Dim frmListas As New frmLineas
                objControl.limpia_Catalogos()
                frmListas.Tag = 6

                strLinea = strQuerys

                strLinea2 = h_inicio_turno
                strLinea3 = h_fin_turno


                frmListas.ShowDialog()
                If Trim(strLinea1) <> "" Then

                    bl_varios_turnos = True

                    hr_fecha_ini_varios_turnos = CDate(strLinea1)
                    hr_fecha_fin_varios_turnos = CDate(strLinea2)
                    strCarril = strLinea3
                    loc_id_gare = loc_id_site 'strLinea4



                Else
                    Me.Close()
                    Exit Sub
                End If
                '000----



                'fin de verifico cuantos cortes tiene en ese turno


                '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Inicio
                'DATOS GENERALES

                '     strQuerys = "SELECT GEADBA.FIN_POSTE.ID_RESEAU, GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE_L2, GEADBA.FIN_POSTE.VOIE, TO_CHAR(GEADBA.FIN_POSTE.NUMERO_POSTE, 'FM09') AS Expr1, " & _
                ' "TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'MM/DD/YY') AS Expr2, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'HH24:MI') AS Expr3, " & _
                ' "GEADBA.FIN_POSTE.MATRICULE, GEADBA.FIN_POSTE.SAC AS Expr4, GEADBA.FIN_POSTE.ID_VOIE, " & _
                ' "TO_CHAR(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE, 'YYYYMMDDHH24MISS') AS Expr5, TO_CHAR(GEADBA.FIN_POSTE.DATE_FIN_POSTE, 'YYYYMMDDHH24MISS') AS Expr6, GEADBA.TYPE_VOIE.LIBELLE_COURT_VOIE, 0 AS Expr7, " & _
                ' "FOLIO_NUMBER_OPEN, FOLIO_NUMBER_CLOSE, INITIAL_EVENT_NUMBER, FINAL_EVENT_NUMBER, FOLIO_ECT_NUMBER_INITIAL, FOLIO_ECT_NUMBER_FINAL, " & _
                ' "FOLIO2_NUMBER_INITIAL,FOLIO2_NUMBER_FINAL,FOLIO3_NUMBER_INITIAL,FOLIO3_NUMBER_FINAL " & _
                ' "FROM GEADBA.TYPE_VOIE, GEADBA.FIN_POSTE, GEADBA.SITE_GARE " & _
                ' "WHERE GEADBA.TYPE_VOIE.ID_VOIE = GEADBA.FIN_POSTE.ID_VOIE AND GEADBA.FIN_POSTE.ID_RESEAU = GEADBA.SITE_GARE.ID_RESEAU AND " & _
                ' "GEADBA.FIN_POSTE.ID_GARE = GEADBA.SITE_GARE.ID_GARE AND (GEADBA.SITE_GARE.ID_RESEAU = '01') AND (GEADBA.SITE_GARE.ID_SITE = '" & id_plaza_cobro_local & "') AND " & _
                ' "(GEADBA.FIN_POSTE.ID_MODE_VOIE IN (1, 6, 7)) "


                '     If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                '         h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                '         h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                '     ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                '         h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                '         h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                '     ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                '         'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                '         h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                '         'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                '         h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                '     End If

                '     If bl_varios_turnos = False Then

                '         strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '"(GEADBA.FIN_POSTE.DATE_DEBUT_POSTE <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "

                '     Else


                '         strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_DEBUT_POSTE >= TO_DATE('" & Format(hr_fecha_ini_varios_turnos, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '"(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(hr_fecha_fin_varios_turnos, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "


                '     End If

                '     '    strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.DATE_FIN_POSTE >= TO_DATE('" & Format(dt_Fecha_Inicio, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " & _
                '     '"(GEADBA.FIN_POSTE.DATE_FIN_POSTE <= TO_DATE('" & Format(dt_Fecha_Fin, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) "
                '     strQuerys = strQuerys & "AND (GEADBA.FIN_POSTE.ID_VOIE = '1' OR " & _
                '  "GEADBA.FIN_POSTE.ID_VOIE = '2' OR " & _
                '  "GEADBA.FIN_POSTE.ID_VOIE = '3' OR " & _
                '  "GEADBA.FIN_POSTE.ID_VOIE = '4') " & _
                '  "AND (GEADBA.FIN_POSTE.MATRICULE = '" & str_cajero & "') " & _
                '  "ORDER BY GEADBA.FIN_POSTE.ID_GARE, GEADBA.TYPE_VOIE.ID_VOIE, GEADBA.FIN_POSTE.VOIE, GEADBA.FIN_POSTE.DATE_FIN_POSTE, " & _
                '  "GEADBA.FIN_POSTE.NUMERO_POSTE, GEADBA.FIN_POSTE.MATRICULE, Expr4"
                '     'AND (GEADBA.FIN_POSTE.NUMERO_POSTE = " & id_Turno & ")


                ' If objQuerys.QueryDataSet(strQuerys, "TYPE_VOIE") = 1 Then

                'For PosicionFilaActual = 0 To oDataSet.Tables("TYPE_VOIE").Rows.Count - 1



                'oDataRow = oDataSet.Tables("TYPE_VOIE").Rows(PosicionFilaActual)



                Dim par3 As New ReportParameter()
                par3.Name = "par3"
                par3.Values.Add(str_delegacion)

                Dim par8 As New ReportParameter()
                par8.Name = "par8"
                par8.Values.Add(strCarril)


                'int_numero_poste = CInt(oDataRow("Expr1"))


                Dim par7 As New ReportParameter()
                par7.Name = "par7"


                If bl_varios_turnos = False Then
                    'par7.Values.Add(str_Turno_block)
                    par7.Values.Add(No_Turno)
                Else

                    If CInt(Format((hr_fecha_ini_varios_turnos), "HH")) >= 6 And CInt(Format((hr_fecha_ini_varios_turnos), "HH")) < 14 Then
                        'par7.Values.Add(gl_turno_2)
                        par7.Values.Add(No_Turno)
                    ElseIf CInt(Format((hr_fecha_ini_varios_turnos), "HH")) >= 14 And CInt(Format((hr_fecha_ini_varios_turnos), "HH")) < 22 Then
                        par7.Values.Add(No_Turno)
                        'par7.Values.Add(gl_turno_3)
                    Else
                        par7.Values.Add(No_Turno)
                        'par7.Values.Add(gl_turno_1)
                    End If

                End If

                Dim par4 As New ReportParameter()
                par4.Name = "par4"
                'par4.Values.Add(Format((hr_fecha_ini_varios_turnos), "MM/dd/yyyy HH:mm:ss"))
                par4.Values.Add(Format((hr_fecha_ini_varios_turnos), "HH:mm:ss"))
                dt_ini_poste = Format((hr_fecha_ini_varios_turnos), "MM/dd/yyyy HH:mm:ss")

                Dim par1 As New ReportParameter()
                par1.Name = "par1"
                'par1.Values.Add(Format((hr_fecha_ini_varios_turnos), "MM/dd/yyyy"))
                'par1.Values.Add(Format((hr_fecha_ini_varios_turnos), "dd/MM/yyyy"))
                par1.Values.Add(Format((dt_Fecha_Inicio), "dd/MM/yyyy"))

                Dim par6 As New ReportParameter()
                par6.Name = "par6"
                'par6.Values.Add(Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy HH:mm:ss"))
                par6.Values.Add(Format((hr_fecha_fin_varios_turnos), "HH:mm:ss"))
                dt_fin_poste = Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy HH:mm:ss")

                'folios
                Dim par69 As New ReportParameter()
                par69.Name = "par69"
                par69.Values.Add(0)


                Dim par70 As New ReportParameter()
                par70.Name = "par70"
                par70.Values.Add(0)

                Dim par71 As New ReportParameter()
                par71.Name = "par71"
                par71.Values.Add(0)

                Dim par73 As New ReportParameter()
                par73.Name = "par73"
                par73.Values.Add(0)

                'FOLIOS 2
                Dim par74 As New ReportParameter()
                par74.Name = "par74"
                par74.Values.Add(0)

                Dim par75 As New ReportParameter()
                par75.Name = "par75"
                par75.Values.Add(0)

                Dim par76 As New ReportParameter()
                par76.Name = "par76"

                par76.Values.Add(0)



                Dim par78 As New ReportParameter()
                par78.Name = "par78"
                par78.Values.Add(0)





                'FOLIOS 3
                Dim par79 As New ReportParameter()
                par79.Name = "par79"
                par79.Values.Add(0)

                Dim par80 As New ReportParameter()
                par80.Name = "par80"
                par80.Values.Add(0)

                Dim par81 As New ReportParameter()
                par81.Name = "par81"

                par81.Values.Add(0)



                Dim par83 As New ReportParameter()
                par83.Name = "par83"

                par83.Values.Add(0)


                'par74, par75, par76, par78, par79, par80,par81, par83
                '---------------------------------
                Dim par84 As New ReportParameter()
                par84.Name = "par84"
                'par84.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_INITIAL"), "###,###,###,##0"))
                par84.Values.Add(0)

                Dim par85 As New ReportParameter()
                par85.Name = "par85"
                par85.Values.Add(0)

                Dim par86 As New ReportParameter()
                par86.Name = "par86"
                'par86.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_FINAL") - oDataRow("FOLIO_ECT_NUMBER_INITIAL") + 1, "###,###,###,##0"))
                par86.Values.Add(0)

                Dim par88 As New ReportParameter()
                par88.Name = "par88"
                'par88.Values.Add(Format(oDataRow("FOLIO_ECT_NUMBER_FINAL") - oDataRow("FOLIO_ECT_NUMBER_INITIAL") + 1, "###,###,###,##0"))
                par88.Values.Add(0)

                '-----------------------------------------------------------------------------





                Dim parametersTitulos() As ReportParameter = {par3, par8, par7, par8, par4, par1, par6, par69, par70, par71, par73, par74, par75, par76, par78, par79, par80, par81, par83, par84, par85, par86, par88}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos)

                'Next


                'Else
                '    ' rpt_reporte = Nothing
                '    ReportViewer1 = Nothing
                '    MsgBox("No existen datos", MsgBoxStyle.Exclamation, "PRELIQUIDACION DE CAJERO RECEPTOR")
                '    Me.Close()
                'End If

                'OPERADOR
                strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
             "FROM TABLE_PERSONNEL " &
             "WHERE Matricule = '" & loc_operador & "'"
                If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                    'Dim par97 As New ReportParameter()
                    'par97.Name = "par97"
                    'par97.Values.Add(Trim(oDataRowTres("MATRICULE")) & "     " & Trim(oDataRowTres("nombre")))

                    'Dim par98 As New ReportParameter()
                    'par98.Name = "par98"
                    'par98.Values.Add(Trim(oDataRowTres("MATRICULE")) & "     " & Trim(oDataRowTres("nombre")))

                    'str_MATRICULE = Trim(oDataRowTres("MATRICULE"))

                    'Dim parametersTitulos_2() As ReportParameter = {par97, par98}
                    'ReportViewer1.LocalReport.SetParameters(parametersTitulos_2)

                End If

                'Jorge
                Dim par97 As New ReportParameter()
                par97.Name = "par97"
                par97.Values.Add(Trim(oDataRowTres("MATRICULE")) & "     " & Trim(oDataRowTres("nombre")))

                Dim par98 As New ReportParameter()
                par98.Name = "par98"
                'par98.Values.Add(srt_Encargado_Reporte) 'Jorge
                par98.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", int_Encargado_Reporte.ToString())) & "     " & srt_Encargado_Reporte)

                '***** JORGE - Comentario linea uno (1)
                Dim parLineaUno As New ReportParameter()
                parLineaUno.Name = "parLineaUno"
                parLineaUno.Values.Add(PrimeraLinea)

                Dim parLineaDos As New ReportParameter()
                parLineaDos.Name = "parLineaDos"
                parLineaDos.Values.Add(SegundaLinea)

                Dim parLineaTres As New ReportParameter()
                parLineaTres.Name = "parLineaTres"
                parLineaTres.Values.Add(TerceraLinea)

                Dim parametersTitulos_2() As ReportParameter = {par97, par98, parLineaUno, parLineaDos, parLineaTres}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_2)

                '*****

                'encargado de plaza
                strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
             "FROM TABLE_PERSONNEL " &
             "WHERE Matricule = '" & objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", "encargado_plaza") & "'"


                If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                    Dim par99 As New ReportParameter()
                    par99.Name = "par99"

                    par99.Values.Add(Trim(objControl.LeeINI(Application.StartupPath & "\operadores.ini", "operadores", oDataRowTres("Matricule"))) & "     " & Trim(oDataRowTres("nombre")))

                    Dim parametersTitulos_admon() As ReportParameter = {par99}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_admon)

                End If






                strQuerys = "SELECT  ID_RESEAU, ID_GARE, NOM_GARE, NOM_GARE_L2 " &
             "FROM GEADBA.TYPE_GARE " &
             "WHERE ID_GARE = " & loc_id_gare & ""

                strQuerys = "SELECT ID_SITE, NOM_SITE, NOM_SITE_L2 " &
                "FROM GEADBA.TYPE_SITE where ID_SITE = '" & loc_id_site & "'"

                If objQuerys.QueryDataSetTres(strQuerys, "TYPE_GARE") = 1 Then

                    Dim par5 As New ReportParameter()
                    par5.Name = "par5"
                    'par5.Values.Add(oDataRowTres("NOM_GARE"))

                    If id_plaza_cobro_local <> "08" Then
                        If id_plaza_cobro_local <> "09" Then
                            par5.Values.Add("1" & id_plaza_cobro_local & " " & oDataRowTres("NOM_SITE"))
                        Else
                            par5.Values.Add("001 BIS" & " " & oDataRowTres("NOM_SITE"))
                        End If

                    Else
                        par5.Values.Add("001" & " " & oDataRowTres("NOM_SITE"))
                    End If
                    '123
                    'int_id_gare = oDataRowTres("ID_GARE")

                    'str_id_RESEAU = oDataRowTres("ID_RESEAU")

                    Dim parametersTitulos_3() As ReportParameter = {par5}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos_3)

                End If


                'pantalla:RESUMEN DE INGRESO CAJERO
                'strQuerys = "SELECT MATRICULE,SAC AS Expr1, NVL(NB_POSTE, 0) + NVL(NB_POSTE_POS, 0) AS Expr2, NVL(RED_RCT_MONNAIE1, 0) AS Expr3, " & _
                '            "NVL(RED_RCT_CHQ, 0) AS Expr4, NVL(RED_NB_CHQ, 0) AS Expr5, NVL(RED_RCT_DEVISE, 0) AS Expr6, NVL(RED_RCT_MONNAIE3, 0) AS Expr7, " & _
                '            "NVL(RED_RCT_MONNAIE4, 0) AS Expr8, NVL(RED_CPT1, 0) AS Expr9, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) + NVL(RED_RCT_MONNAIE3, 0) " & _
                '            "+ NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_CHQ, 0) + NVL(RED_RCT_DEVISE, 0) AS Expr10, NVL(POSTE_RCT_MONNAIE1, 0) + NVL(POSTE_RCT_MONNAIE2, 0) " & _
                '            "+ NVL(POSTE_RCT_MONNAIE3, 0) + NVL(POSTE_RCT_MONNAIE4, 0) + NVL(POSTE_RCT_DEVISE, 0) + NVL(POSTE_RCT_CHQ, 0) + NVL(POSTE_POS_RCT_MONNAIE1, " & _
                '            "0) + NVL(POSTE_POS_RMB_MONNAIE1, 0) + NVL(POSTE_POS_RCT_MONNAIE2, 0) + NVL(POSTE_POS_RCT_MONNAIE3, 0) + NVL(POSTE_POS_RCT_MONNAIE4, 0) " & _
                '            "+ NVL(POSTE_POS_RCT_DEVISE, 0) + NVL(POSTE_POS_RCT_CHQ, 0) AS Expr11, NVL(RED_RCT_MONNAIE1, 0) + NVL(RED_RCT_MONNAIE2, 0) " & _
                '            "+ NVL(RED_RCT_MONNAIE3, 0) + NVL(RED_RCT_MONNAIE4, 0) + NVL(RED_RCT_DEVISE, 0) + NVL(RED_RCT_CHQ, 0) - NVL(POSTE_RCT_MONNAIE1, 0) " & _
                '            "- NVL(POSTE_RCT_MONNAIE2, 0) - NVL(POSTE_RCT_MONNAIE3, 0) - NVL(POSTE_RCT_MONNAIE4, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_RCT_CHQ, 0) " & _
                '            "- NVL(POSTE_POS_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE2, 0) - NVL(POSTE_POS_RCT_MONNAIE3, 0) " & _
                '            "- NVL(POSTE_POS_RCT_MONNAIE4, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr12, NVL(RED_RCT_MONNAIE1, 0) " & _
                '            "- NVL(POSTE_RCT_MONNAIE1, 0) - NVL(POSTE_POS_RMB_MONNAIE1, 0) - NVL(POSTE_POS_RCT_MONNAIE1, 0) AS Expr13, NVL(RED_RCT_CHQ, 0) " & _
                '            "- NVL(POSTE_RCT_CHQ, 0) - NVL(POSTE_POS_RCT_CHQ, 0) AS Expr14, NVL(RED_RCT_DEVISE, 0) - NVL(POSTE_RCT_DEVISE, 0) - NVL(POSTE_POS_RCT_DEVISE, 0) " & _
                '            "AS Expr15, NVL(RED_CPT24, 0) AS Expr16, NVL(RED_CPT25, 0) AS Expr17, NVL(RED_JETON, 0) - NVL(POSTE_JETON, 0) AS Expr18, NVL(RED_RDD, 0) " & _
                '            "- NVL(POSTE_RDD, 0) AS Expr19, NVL(RED_GRATUIT, 0) + NVL(RED_CPT2, 0) - NVL(POSTE_GRATUIT, 0) AS Expr20, MATRICULE_COMMENTAIRE, COMMENTAIRE, " & _
                '            "0 AS Expr21, TO_CHAR(DATE_REDDITION, 'YYYYMMDDHH24MISS') AS Expr22, ID_SITE, RED_CPT21, NB_POSTE, ETAT_REDDITION, " & _
                '            "NVL(Red_Rct_Monnaie1,0)	+ NVL(Red_Rct_Devise,0)	+ NVL(Red_Rct_Chq,0) + NVL(Red_cpt21,0)	- NVL(Poste_Rct_Monnaie1,0) - NVL(Poste_Rct_Devise,0) - NVL(Poste_Rct_Chq,0) AS Expr23 " & _
                '            "FROM REDDITION " & _
                '            "WHERE  (ID_SITE = '" & id_plaza_cobro_local & "') AND (MATRICULE = '" & oDataRow("MATRICULE") & "') AND (SAC = '" & oDataRow("Expr4") & "')"
                ''(DATE_REDDITION = TO_DATE('20130206071615', 'YYYYMMDDHH24MISS')) AND 'no se obtiene

                'If objQuerys.QueryDataSetDos(strQuerys, "REDDITION") = 1 Then

                VAR_11 = 0
                VAR_50 = 0
                VAR_63 = 0

                VAR_67 = 0
                VAR_65 = 0

                Dim par9 As New ReportParameter()
                par9.Name = "par9"
                'par9.Values.Add(Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy"))
                par9.Values.Add(Format((hr_fecha_fin_varios_turnos), "dd/MM/yyyy"))

                Dim par10 As New ReportParameter()
                par10.Name = "par10"
                par10.Values.Add(Format((hr_fecha_fin_varios_turnos), "HH:mm:ss"))

                Dim par2 As New ReportParameter()
                par2.Name = "par2"
                par2.Values.Add(Format((hr_fecha_fin_varios_turnos), "yyyy") & Format((hr_fecha_fin_varios_turnos), "MM") & Format((hr_fecha_fin_varios_turnos), "dd") & Format((hr_fecha_fin_varios_turnos), "HH") & Format((hr_fecha_fin_varios_turnos), "mm") & Format((hr_fecha_fin_varios_turnos), "ss"))
                '2013/10/01
                Dim par63 As New ReportParameter()
                par63.Name = "par63"
                par63.Values.Add(Format(VAR_63, "###,###,##0.00"))

                Dim par65 As New ReportParameter()
                par65.Name = "par65"
                par65.Values.Add(Format(VAR_65, "###,###,##0.00"))

                Dim par67 As New ReportParameter()
                par67.Name = "par67"
                par67.Values.Add(Format(VAR_67, "###,###,##0.00"))

                Dim par94 As New ReportParameter()
                par94.Name = "par94"
                par94.Values.Add(Format(CDec(VAR_11 + VAR_63), "###,###,##0.00"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("PRELIQUIDACIÓN DE CAJERO-RECEPTOR DE CARRILES CERRADOS")

                Dim parametersTitulos_4() As ReportParameter = {par2, par9, par10, par63, par94, parTituloReporte}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_4)

                Dim parametersTitulos_5() As ReportParameter = {par65, par67}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)

                'End If

                'turno carril
            ElseIf int_reporte = 2 Then
                ReportViewer1.LocalReport.DataSources.Clear()
                ReportViewer1.LocalReport.ReportEmbeddedResource = "rptPreliquidacion_Cajero_Receptor_Transito_Vehicular_2.rdlc"

                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "2 MATUTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "3 VESPERTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "1 NOCTURNO"
                End If


                'titulos

                Dim par3 As New ReportParameter()
                par3.Name = "par3"
                par3.Values.Add(str_delegacion)

                Dim par5 As New ReportParameter()
                par5.Name = "par5"
                par5.Values.Add(str_Plaza_Cobro)


                Dim par4 As New ReportParameter()
                par4.Name = "par4"
                'par4.Values.Add(str_Turno_block)
                'No_Turno
                par4.Values.Add(No_Turno)

                Dim par1 As New ReportParameter()
                par1.Name = "par1"
                If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    par1.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "MM/dd/yyyy"))
                Else
                    par1.Values.Add(Format(dt_ini_poste, "MM/dd/yyyy"))
                End If

                Dim par7 As New ReportParameter()
                par7.Name = "par7"
                par7.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim par9 As New ReportParameter()
                par9.Name = "par9"
                par9.Values.Add(Format(Now, "HH:mm:ss"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("PRELIQUIDACIÓN DE TURNO/CARRILES DE CARRILES CERRADOS")

                Dim parameters() As ReportParameter = {par3, par5, par4, par1, par7, par9, parTituloReporte}
                ReportViewer1.LocalReport.SetParameters(parameters)
                'fin titulos




                VAR_11 = VAR_11
                VAR_50 = VAR_50

                'Dim par63 As New ReportParameter()
                'par63.Name = "par63"
                'par63.Values.Add(Format(CDec(oDataRowDos("Expr10")), "###,###,##0.00"))

                db_acom_63 = db_acom_63




                db_acom_67 = db_acom_67 + 0
                db_acom_65 = db_acom_65 + 0



                db_acom_94 = db_acom_94 + (VAR_11 + VAR_50) 'oDataRowDos("Expr10")

                'folios
                'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - (oDataRow("FOLIO_NUMBER_OPEN") + 1))
                'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1)

                'If oDataRow("FOLIO2_NUMBER_FINAL") = 0 And oDataRow("FOLIO2_NUMBER_FINAL") = 0 Then
                'Else
                '    db_acom_folios2 = db_acom_folios2 + oDataRow("FOLIO2_NUMBER_FINAL") - oDataRow("FOLIO2_NUMBER_INITIAL") + 1
                'End If
                'If oDataRow("FOLIO3_NUMBER_FINAL") = 0 And oDataRow("FOLIO3_NUMBER_FINAL") = 0 Then

                'Else
                '    db_acom_folios3 = db_acom_folios3 + oDataRow("FOLIO3_NUMBER_FINAL") - oDataRow("FOLIO3_NUMBER_INITIAL") + 1
                'End If

                'db_acom_eventos = db_acom_eventos + (oDataRow("FINAL_EVENT_NUMBER") - oDataRow("INITIAL_EVENT_NUMBER") + 1)



                'FOLIO2_NUMBER_INITIAL, FOLIO2_NUMBER_FINAL, FOLIO3_NUMBER_INITIAL, FOLIO3_NUMBER_FINAL



                Dim par63 As New ReportParameter()
                par63.Name = "par63"
                par63.Values.Add(Format(CDec(db_acom_63), "###,###,##0.00"))

                Dim par94 As New ReportParameter()
                par94.Name = "par94"
                'par94.Values.Add(Format(CDec(db_acom_94), "###,###,##0.00"))
                par94.Values.Add(Format(CDec(VAR_11 + db_acom_63), "###,###,##0.00"))

                Dim parametersTitulos_4() As ReportParameter = {par63, par94}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_4)


                Dim par65 As New ReportParameter()
                par65.Name = "par65"
                par65.Values.Add(Format(CDec(db_acom_65), "###,###,##0.00"))

                Dim par67 As New ReportParameter()
                par67.Name = "par67"
                par67.Values.Add(Format(CDec(db_acom_67), "###,###,##0.00"))

                Dim par69 As New ReportParameter()
                par69.Name = "par69"
                par69.Values.Add(Format(db_acom_folios, "###,###,###,##0"))

                Dim par74 As New ReportParameter()
                par74.Name = "par74"
                par74.Values.Add(Format(db_acom_folios2, "###,###,###,##0"))

                Dim par79 As New ReportParameter()
                par79.Name = "par79"
                par79.Values.Add(Format(db_acom_folios3, "###,###,###,##0"))

                Dim par89 As New ReportParameter()
                par89.Name = "par89"
                par89.Values.Add(Format(db_acom_eventos, "###,###,###,##0"))

                Dim parametersTitulos_5() As ReportParameter = {par65, par67, par69, par89, par74, par79}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)



                'dia
            ElseIf int_reporte = 3 Then
                ReportViewer1.LocalReport.DataSources.Clear()
                ReportViewer1.LocalReport.ReportEmbeddedResource = "rptPreliquidacion_Cajero_Receptor_Transito_Vehicular_2.rdlc"

                h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")

                h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")

                'titulos

                Dim par3 As New ReportParameter()
                par3.Name = "par3"
                par3.Values.Add(str_delegacion)

                Dim par5 As New ReportParameter()
                par5.Name = "par5"
                par5.Values.Add(str_Plaza_Cobro)


                'Dim par4 As New ReportParameter()
                'par4.Name = "par4"
                'par4.Values.Add(str_Turno_block)

                Dim par1 As New ReportParameter()
                par1.Name = "par1"
                If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    par1.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "MM/dd/yyyy"))
                Else
                    par1.Values.Add(Format(dt_ini_poste, "MM/dd/yyyy"))
                End If

                Dim par7 As New ReportParameter()
                par7.Name = "par7"
                par7.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim par9 As New ReportParameter()
                par9.Name = "par9"
                par9.Values.Add(Format(Now, "HH:mm:ss"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("PRELIQUIDACIÓN DE DÍA/CASETA DE CARRILES CERRADOS")

                Dim parameters() As ReportParameter = {par3, par5, par1, par7, par9, parTituloReporte}
                ReportViewer1.LocalReport.SetParameters(parameters)
                'fin titulos

                'SACO LOS TURNOS

                VAR_11 = VAR_11
                VAR_50 = VAR_50
                'Dim par63 As New ReportParameter()
                'par63.Name = "par63"
                'par63.Values.Add(Format(CDec(oDataRowDos("Expr10")), "###,###,##0.00"))

                db_acom_63 = db_acom_63




                db_acom_67 = db_acom_67 + 0
                db_acom_65 = db_acom_65 + 0


                db_acom_94 = db_acom_94 + (VAR_11 + VAR_50) 'oDataRowDos("Expr10")

                'folios
                'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - (oDataRow("FOLIO_NUMBER_OPEN") + 1))
                'db_acom_folios = db_acom_folios + (oDataRow("FOLIO_NUMBER_CLOSE") - oDataRow("FOLIO_NUMBER_OPEN") + 1)

                'If oDataRow("FOLIO2_NUMBER_FINAL") = 0 And oDataRow("FOLIO2_NUMBER_FINAL") = 0 Then
                'Else
                '    db_acom_folios2 = db_acom_folios2 + oDataRow("FOLIO2_NUMBER_FINAL") - oDataRow("FOLIO2_NUMBER_INITIAL") + 1
                'End If
                'If oDataRow("FOLIO3_NUMBER_FINAL") = 0 And oDataRow("FOLIO3_NUMBER_FINAL") = 0 Then

                'Else
                '    db_acom_folios3 = db_acom_folios3 + oDataRow("FOLIO3_NUMBER_FINAL") - oDataRow("FOLIO3_NUMBER_INITIAL") + 1
                'End If

                'db_acom_eventos = db_acom_eventos + (oDataRow("FINAL_EVENT_NUMBER") - oDataRow("INITIAL_EVENT_NUMBER") + 1)









                Dim par63 As New ReportParameter()
                par63.Name = "par63"
                par63.Values.Add(Format(CDec(db_acom_63), "###,###,##0.00"))

                Dim par94 As New ReportParameter()
                par94.Name = "par94"
                'par94.Values.Add(Format(CDec(db_acom_94), "###,###,##0.00"))
                par94.Values.Add(Format(CDec(VAR_11 + db_acom_63), "###,###,##0.00"))

                Dim parametersTitulos_4() As ReportParameter = {par63, par94}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_4)


                Dim par65 As New ReportParameter()
                par65.Name = "par65"
                par65.Values.Add(Format(CDec(db_acom_65), "###,###,##0.00"))

                Dim par67 As New ReportParameter()
                par67.Name = "par67"
                par67.Values.Add(Format(CDec(db_acom_67), "###,###,##0.00"))

                Dim par69 As New ReportParameter()
                par69.Name = "par69"
                par69.Values.Add(Format(db_acom_folios, "###,###,###,##0"))

                Dim par74 As New ReportParameter()
                par74.Name = "par74"
                par74.Values.Add(Format(db_acom_folios2, "###,###,###,##0"))

                Dim par79 As New ReportParameter()
                par79.Name = "par79"
                par79.Values.Add(Format(db_acom_folios3, "###,###,###,##0"))


                Dim par89 As New ReportParameter()
                par89.Name = "par89"
                par89.Values.Add(Format(db_acom_eventos, "###,###,###,##0"))

                Dim parametersTitulos_5() As ReportParameter = {par65, par67, par69, par89, par74, par79}
                ReportViewer1.LocalReport.SetParameters(parametersTitulos_5)









                'fin de SACAR TURNOS


            End If

            Dim par11 As New ReportParameter()
            Dim par12 As New ReportParameter()
            Dim par13 As New ReportParameter()
            Dim par14 As New ReportParameter()
            Dim par15 As New ReportParameter()
            Dim par16 As New ReportParameter()
            Dim par17 As New ReportParameter()
            Dim par18 As New ReportParameter()
            Dim par19 As New ReportParameter()
            Dim par20 As New ReportParameter()
            Dim par21 As New ReportParameter()
            Dim par22 As New ReportParameter()
            Dim par23 As New ReportParameter()
            Dim par24 As New ReportParameter()
            Dim par25 As New ReportParameter()
            Dim par26 As New ReportParameter()
            Dim par27 As New ReportParameter()
            Dim par28 As New ReportParameter()
            Dim par29 As New ReportParameter()
            Dim par30 As New ReportParameter()
            Dim par31 As New ReportParameter()
            Dim par32 As New ReportParameter()
            Dim par33 As New ReportParameter()
            Dim par34 As New ReportParameter()
            Dim par35 As New ReportParameter()
            Dim par36 As New ReportParameter()
            Dim par37 As New ReportParameter()
            Dim par38 As New ReportParameter()
            Dim par39 As New ReportParameter()
            Dim par40 As New ReportParameter()
            Dim par41 As New ReportParameter()
            Dim par42 As New ReportParameter()
            Dim par43 As New ReportParameter()

            Dim par140 As New ReportParameter()
            Dim par141 As New ReportParameter()
            Dim par142 As New ReportParameter()
            Dim par143 As New ReportParameter()

            Dim par44 As New ReportParameter()
            Dim par45 As New ReportParameter()
            Dim par46 As New ReportParameter()
            Dim par47 As New ReportParameter()
            Dim par48 As New ReportParameter()
            Dim par49 As New ReportParameter()
            Dim par50 As New ReportParameter()
            Dim par51 As New ReportParameter()
            Dim par52 As New ReportParameter()
            Dim par53 As New ReportParameter()
            Dim par54 As New ReportParameter()
            Dim par55 As New ReportParameter()
            Dim par56 As New ReportParameter()
            Dim par57 As New ReportParameter()
            Dim par58 As New ReportParameter()
            Dim par59 As New ReportParameter()
            Dim par60 As New ReportParameter()
            Dim par61 As New ReportParameter()
            Dim par62 As New ReportParameter()

            par11.Name = "par11"
            par11.Values.Add(Format(VAR_11, "###,###,##0.00"))


            str_id_RESEAU = 0
            int_id_gare = 0
            str_id_voie = 0
            id_plaza_cobro_local = 0

            If int_reporte = 1 Then


                'folio ini
                strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces, MIN(EVENT_NUMBER) AS minimo, MAX(EVENT_NUMBER) as maximo " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
    "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
    "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
    "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) and EVENT_NUMBER <> 0 " &
       "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
    "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) and EVENT_NUMBER <> 0 AND ID_OBS_PASSAGE <> '1' "

                If int_reporte = 1 Then

                    strQuerys = strQuerys & " " &
                    "AND VOIE = '" & strCarril & "' "

                    '                    "AND TRANSACTION.ID_GARE = " & loc_id_gare & " " & _

                ElseIf int_reporte = 2 Then
                    strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
                ElseIf int_reporte = 3 Then
                    strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
                End If

                'strQuerys = strQuerys & "AND (ID_OBS_SEQUENCE = '5') "

                If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then


                    Dim par89 As New ReportParameter()
                    par89.Name = "par89"

                    If oDataRow("Cruces") > 0 Then
                        par89.Values.Add(oDataRow("minimo"))
                    Else
                        par89.Values.Add(0)
                    End If


                    Dim par90 As New ReportParameter()
                    par90.Name = "par90"
                    'par90.Values.Add(oDataRow("Cruces"))

                    If oDataRow("Cruces") > 0 Then
                        par90.Values.Add(oDataRow("maximo"))
                    Else
                        par90.Values.Add(0)
                    End If


                    Dim par91 As New ReportParameter()
                    par91.Name = "par91"
                    par91.Values.Add(oDataRow("Cruces"))

                    Dim par93 As New ReportParameter()
                    par93.Name = "par93"
                    par93.Values.Add(oDataRow("Cruces"))

                    Dim parametersTitulos() As ReportParameter = {par89, par90, par91, par93}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos)




                End If

            Else

                'turno
                'dia carril
                strQuerys = "SELECT ID_NETWORK, ID_PLAZA,ID_LANE, LANE, BEGIN_DHM, END_DHM, BAG_NUMBER, REPORT_FLAG, GENERATION_DHM " &
    "FROM CLOSED_LANE_REPORT, SITE_GARE " &
    "where " &
    "CLOSED_LANE_REPORT.ID_PLAZA	=	SITE_GARE.id_Gare " &
    "AND	SITE_GARE.id_Site		=	'" & id_plaza_cobro & "' "

                If int_reporte = 2 Then


                    If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                        h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                        h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                        No_Turno = "2 MATUTINO"
                    ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                        h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                        h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                        No_Turno = "3 VESPERTINO"
                    ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                        'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                        h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                        'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                        h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                        No_Turno = "1 NOCTURNO"
                    End If

                ElseIf int_reporte = 3 Then
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                End If

                strQuerys = strQuerys & "AND (BEGIN_DHM >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(BEGIN_DHM <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
           "order by BEGIN_DHM"

                If objQuerys.QueryDataSet(strQuerys, "CLOSED_LANE_REPORT") = 1 Then

                    For cont = 0 To oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Count - 1
                        oDataRow = oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Item(cont)


                        strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces, MIN(EVENT_NUMBER) AS minimo, MAX(EVENT_NUMBER) as maximo " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(oDataRow("BEGIN_DHM"), "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(oDataRow("END_DHM"), "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) AND ID_OBS_PASSAGE <> '1' "


                        strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro & " "


                        'strQuerys = strQuerys & "AND (ID_OBS_SEQUENCE = '5') "

                        If objQuerys.QueryDataSetDos(strQuerys, "TRANSACTION") = 1 Then

                            VAR_89 = VAR_89 + oDataRowDos("Cruces")

                        End If

                    Next

                    Dim par89 As New ReportParameter()
                    par89.Name = "par89"
                    par89.Values.Add(VAR_89)


                    Dim parametersTitulos() As ReportParameter = {par89}
                    ReportViewer1.LocalReport.SetParameters(parametersTitulos)

                End If



            End If

            'folio fin



            'BOLETOS GENERADOS POR ERROR
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_OBS_SEQUENCE = '5') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par12.Name = "par12"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par12.Values.Add(Format(0, "###,###,##0.00"))
                    VAR_12 = 0
                Else
                    ' par12.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    'VAR_12 = oDataRow("Monto_1")

                    par12.Values.Add(Format(0, "###,###,##0.00"))
                    VAR_12 = 0
                End If


                par13.Name = "par13"
                If IsDBNull(oDataRow("Cruces")) Then
                    par13.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par13.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_13 = oDataRow("Cruces")
                End If


            End If
            '---------------------------------------
            'par12.Name = "par12"
            'par12.Values.Add(Format(0, "###,###,##0.00"))

            'par13.Name = "par13"
            'par13.Values.Add(Format(0, "###,###,##0"))

            'VEHICULOS RESIDENTES PAGO INMEDIATO

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1, SUM(PRIX_TOTAL) AS Monto_2, COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
      "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
    "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
    "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 " &
    "OR ID_PAIEMENT = 72 " &
    "OR ID_PAIEMENT = 73 " &
    "OR ID_PAIEMENT = 74  or ID_PAIEMENT = 10) AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                par14.Name = "par14"
                If IsDBNull(oDataRow("Monto_2")) Then
                    par14.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par14.Values.Add(Format(oDataRow("Monto_2"), "###,###,##0.00"))
                End If

                par15.Name = "par15"
                If IsDBNull(oDataRow("Monto_2")) Then
                    par15.Values.Add(Format(0, "###,###,##0"))
                Else
                    par15.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                End If

                VAR_14 = IIf(IsDBNull(oDataRow("Monto_2")), 0, oDataRow("Monto_2"))
                VAR_15 = IIf(IsDBNull(oDataRow("Cruces")), 0, oDataRow("Cruces"))
            End If

            'SUBTOTAL MARCADO COMO PAGADO
            VAR_16 = VAR_11 + VAR_12
            par16.Name = "par16"
            par16.Values.Add(Format(VAR_16, "###,###,##0.00"))
            '-------------------
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
    "FROM GEADBA.TRANSACTION,SITE_GARE " &
     "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
    "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
    "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 1 " &
 "OR ID_PAIEMENT = 2 " &
"OR ID_PAIEMENT = 71 " &
                "OR ID_PAIEMENT = 72 " &
                "OR ID_PAIEMENT = 73 " &
                "OR ID_PAIEMENT = 74  or ID_PAIEMENT = 10) " &
                "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            '  strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                par17.Name = "par17"
                If IsDBNull(oDataRow("Cruces")) Then
                    ' par17.Values.Add(Format(0 + VAR_13 + VAR_15, "###,###,##0"))
                    par17.Values.Add(Format(0 + VAR_13, "###,###,##0"))
                Else
                    'par17.Values.Add(Format(oDataRow("Cruces") + VAR_13 + VAR_15, "###,###,##0"))
                    par17.Values.Add(Format(oDataRow("Cruces") + VAR_13, "###,###,##0"))
                End If


                'VAR_17 = IIf(IsDBNull(oDataRow("Cruces")), 0 + VAR_13 + VAR_15, oDataRow("Cruces") + VAR_13 + VAR_15)
                VAR_17 = IIf(IsDBNull(oDataRow("Cruces")), 0 + VAR_13, oDataRow("Cruces") + VAR_13)
            End If

            '2013/10/09
            '-----------------------------
            '          strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            ' "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
 "FROM GEADBA.TRANSACTION,SITE_GARE " &
  "WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
 "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
 "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 1 " &
                 "OR ID_PAIEMENT = 2 " &
                 "OR ID_PAIEMENT = 71 " &
                 "OR ID_PAIEMENT = 72 " &
                 "OR ID_PAIEMENT = 73 " &
                 "OR ID_PAIEMENT = 74  or ID_PAIEMENT = 10) " &
                 "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                par18.Name = "par18"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par18.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par18.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                End If

                VAR_18 = IIf(IsDBNull(oDataRow("Monto_1")), 0, oDataRow("Monto_1"))


                par19.Name = "par19"
                If IsDBNull(oDataRow("Cruces")) Then
                    par19.Values.Add(Format(0, "###,###,##0"))
                Else
                    par19.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                End If

                VAR_18 = IIf(IsDBNull(oDataRow("Monto_1")), 0, oDataRow("Monto_1"))
                VAR_19 = IIf(IsDBNull(oDataRow("Cruces")), 0, oDataRow("Cruces"))
            End If

            VAR_20 = VAR_16 - VAR_18
            par20.Name = "par20"
            par20.Values.Add(Format(VAR_20, "###,###,##0.00"))

            VAR_21 = VAR_17 - VAR_19
            par21.Name = "par21"
            par21.Values.Add(Format(VAR_21, "###,###,##0"))



            'BOLETOS RESIDENTES P.A.
            par22.Name = "par22"
            par22.Values.Add(Format(VAR_22, "###,###,##0.00"))

            par23.Name = "par23"
            par23.Values.Add(Format(VAR_23, "###,###,##0"))

            par24.Name = "par24"
            par24.Values.Add(Format(VAR_24, "###,###,##0.00"))

            par25.Name = "par25"
            par25.Values.Add(Format(VAR_25, "###,###,##0"))

            par26.Name = "par26"
            par26.Values.Add(Format(VAR_26, "###,###,##0.00"))

            par27.Name = "par27"
            par27.Values.Add(Format(VAR_27, "###,###,##0"))

            'SISTEMAS ELECTRONICOS
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " '& _
            'nota 2013/10/01
            '"AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par28.Name = "par28"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par28.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par28.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_28 = oDataRow("Monto_1")
                End If

                par29.Name = "par29"
                If IsDBNull(oDataRow("Cruces")) Then
                    par29.Values.Add(Format(0, "###,###,##0"))
                Else
                    par29.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_29 = oDataRow("Cruces")
                End If

            End If

            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " '& _
            '"AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par30.Name = "par30"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par30.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par30.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_30 = oDataRow("Monto_1")
                End If

                par31.Name = "par31"
                If IsDBNull(oDataRow("Cruces")) Then
                    par31.Values.Add(Format(0, "###,###,##0"))
                Else
                    par31.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_31 = oDataRow("Cruces")
                End If

            End If


            'VSC
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') "


            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par32.Name = "par32"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par32.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par32.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_32 = oDataRow("Monto_1")
                End If

                par33.Name = "par33"
                If IsDBNull(oDataRow("Cruces")) Then
                    par33.Values.Add(Format(0, "###,###,##0"))
                Else
                    par33.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_33 = oDataRow("Cruces")
                End If

            End If

            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND (ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par34.Name = "par34"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par34.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par34.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_34 = oDataRow("Monto_1")
                End If

                par35.Name = "par35"
                If IsDBNull(oDataRow("Cruces")) Then
                    par35.Values.Add(Format(0, "###,###,##0"))
                Else
                    par35.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_35 = oDataRow("Cruces")
                End If

            End If

            'VEHICULOS RESIDENTES S.P.
            par36.Name = "par36"
            par36.Values.Add(Format(VAR_36, "###,###,##0.00"))

            par37.Name = "par37"
            par37.Values.Add(Format(VAR_37, "###,###,##0"))

            par38.Name = "par38"
            par38.Values.Add(Format(VAR_38, "###,###,##0.00"))

            par39.Name = "par39"
            par39.Values.Add(Format(VAR_39, "###,###,##0"))



            'VEHICULOS ELUDIDOS
            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 13 " &
            "AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par40.Name = "par40"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par40.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par40.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_40 = oDataRow("Monto_1")
                End If

                par41.Name = "par41"
                If IsDBNull(oDataRow("Cruces")) Then
                    par41.Values.Add(Format(0, "###,###,##0"))
                Else
                    par41.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_41 = oDataRow("Cruces")
                End If

            End If

            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 13 " &
            "AND ID_OBS_SEQUENCE = '7' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par42.Name = "par42"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par42.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par42.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_42 = oDataRow("Monto_1")
                End If

                par43.Name = "par43"
                If IsDBNull(oDataRow("Cruces")) Then
                    par43.Values.Add(Format(0, "###,###,##0"))
                Else
                    par43.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_43 = oDataRow("Cruces")
                End If

            End If

            'debito 140 141 142 143
            par140.Name = "par140"
            par140.Values.Add(Format(0, "###,###,##0.00"))

            par141.Name = "par141"
            par141.Values.Add(Format(0, "###,###,##0"))

            par142.Name = "par142"
            par142.Values.Add(Format(0, "###,###,##0.00"))

            par143.Name = "par143"
            par143.Values.Add(Format(0, "###,###,##0"))

            'TOTALES
            VAR_44 = VAR_16 + VAR_22 + VAR_28 + VAR_32 + VAR_36 + VAR_40
            par44.Name = "par44"
            par44.Values.Add(Format(VAR_44, "###,###,##0.00"))

            VAR_45 = VAR_17 + VAR_23 + VAR_29 + VAR_33 + VAR_37 + VAR_41
            par45.Name = "par45"
            par45.Values.Add(Format(VAR_45, "###,###,##0"))

            VAR_46 = VAR_18 + VAR_24 + VAR_30 + VAR_34 + VAR_38 + VAR_42
            par46.Name = "par46"
            par46.Values.Add(Format(VAR_46, "###,###,##0.00"))

            VAR_47 = VAR_19 + VAR_25 + VAR_31 + VAR_35 + VAR_39 + VAR_43
            par47.Name = "par47"
            par47.Values.Add(Format(VAR_47, "###,###,##0"))

            VAR_48 = VAR_44 - VAR_46
            par48.Name = "par48"
            par48.Values.Add(Format(VAR_48, "###,###,##0.00"))

            VAR_49 = VAR_45 - VAR_47
            par49.Name = "par49"
            par49.Values.Add(Format(VAR_49, "###,###,##0"))


            'EFECTIVO DLLS.
            par50.Name = "par50"
            par50.Values.Add(Format(VAR_50, "###,###,##0.00"))

            'BOLETOS GENERADOS POR ERROR
            par51.Name = "par51"
            par51.Values.Add(Format(VAR_51, "###,###,##0.00"))

            par52.Name = "par52"
            par52.Values.Add(Format(VAR_52, "###,###,##0"))

            'SUBTOTAL MARCADO COMO PAGADO
            par53.Name = "par53"
            par53.Values.Add(Format(VAR_53, "###,###,##0.00"))

            par54.Name = "par54"
            par54.Values.Add(Format(VAR_54, "###,###,##0"))

            par55.Name = "par55"
            par55.Values.Add(Format(VAR_55, "###,###,##0.00"))

            par56.Name = "par56"
            par56.Values.Add(Format(VAR_56, "###,###,##0"))

            VAR_57 = VAR_53 - VAR_55
            par57.Name = "par57"
            par57.Values.Add(Format(VAR_57, "###,###,##0.00"))

            VAR_58 = VAR_54 - VAR_56
            par58.Name = "par58"
            par58.Values.Add(Format(VAR_58, "###,###,##0"))

            'RECLASIFICADOS
            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            'strQuerys = strQuerys & "AND ID_PAIEMENT = 13 " & _
            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'F'"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par59.Name = "par59"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par59.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par59.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_59 = oDataRow("Monto_1")
                End If

                par60.Name = "par60"
                If IsDBNull(oDataRow("Cruces")) Then
                    par60.Values.Add(Format(0, "###,###,##0"))
                Else
                    par60.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_60 = oDataRow("Cruces")
                End If

            End If

            'DETECCIONES ERRONEAS
            '2013/10/09
            '            strQuerys = "SELECT SUM(TRANSACTION_CPT1/100) AS Monto_1,  COUNT(*) AS Cruces " & _
            '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
            '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces " &
"FROM GEADBA.TRANSACTION,SITE_GARE " &
"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND TRANSACTION.ID_RESEAU = '" & str_id_RESEAU & "' " &
                "AND TRANSACTION.ID_GARE = " & int_id_gare & " " &
                "AND ID_VOIE = " & int_id_voie & " " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " "
            End If

            'strQuerys = strQuerys & "AND ID_PAIEMENT = 13 " & _
            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6' "

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
                par61.Name = "par61"
                If IsDBNull(oDataRow("Monto_1")) Then
                    par61.Values.Add(Format(0, "###,###,##0.00"))
                Else
                    par61.Values.Add(Format(oDataRow("Monto_1"), "###,###,##0.00"))
                    VAR_61 = oDataRow("Monto_1")
                End If

                par62.Name = "par62"
                If IsDBNull(oDataRow("Cruces")) Then
                    par62.Values.Add(Format(0, "###,###,##0"))
                Else
                    par62.Values.Add(Format(oDataRow("Cruces"), "###,###,##0"))
                    VAR_62 = oDataRow("Cruces")
                End If

            End If

            '------------------------------------
            'par61.Name = "par61"
            'par61.Values.Add(Format(VAR_61, "###,###,##0.00"))

            'par62.Name = "par62"
            'par62.Values.Add(Format(VAR_62, "###,###,##0"))


            '--------------------------------------------------------------------------------------------
            Dim parametersDetalle() As ReportParameter = {par11, par12, par13, par14, par15, par16, par17, par18, par19, par20, par21, par22, par23, par24, par25, par26, par27, par28, par29, par30, par31, par32, par33, par34, par35, par36, par37, par38, par39, par40, par41, par42, par43, par44, par45, par46, par47, par48, par49, par50, par51, par52, par53, par54, par55, par56, par57, par58, par59, par60, par61, par62, par140, par141, par142, par143}
            ReportViewer1.LocalReport.SetParameters(parametersDetalle)



            ReportViewer1.SetDisplayMode(DisplayMode.PrintLayout)
            Me.ReportViewer1.RefreshReport()

        Catch ex As Exception
            MsgBox(ex.Message)
        End Try



    End Sub


    Private Sub Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular_cerrados_II(ByVal int_reporte As Integer)

        'tabla 1
        Dim strQuerys As String
        Dim odataSetReporte As New DataSet
        Dim oDataTableReporte As DataTable = New DataTable("tabla_reporte")
        Dim oDataColumnaReporte As DataColumn
        Dim oDatarowReporte As DataRow

        Dim odataSetReporte_total As New DataSet
        Dim oDataTableReporte_total As DataTable = New DataTable("tabla_reporte_total")
        Dim oDataColumnaReporte_total As DataColumn
        Dim oDatarowReporte_total As DataRow

        'tabla 2
        '------------------
        Dim odataSetReporte_2 As New DataSet
        Dim oDataTableReporte_2 As DataTable = New DataTable("tabla_reporte_2")
        Dim oDataColumnaReporte_2 As DataColumn
        Dim oDatarowReporte_2 As DataRow

        Dim odataSetReporte_total_2 As New DataSet
        Dim oDataTableReporte_total_2 As DataTable = New DataTable("tabla_reporte_total_2")
        Dim oDataColumnaReporte_total_2 As DataColumn
        Dim oDatarowReporte_total_2 As DataRow
        '------------------
        'tabla 3
        '------------------
        Dim odataSetReporte_3 As New DataSet
        Dim oDataTableReporte_3 As DataTable = New DataTable("tabla_reporte_3")
        Dim oDataColumnaReporte_3 As DataColumn
        Dim oDatarowReporte_3 As DataRow

        Dim odataSetReporte_total_3 As New DataSet
        Dim oDataTableReporte_total_3 As DataTable = New DataTable("tabla_reporte_total_3")
        Dim oDataColumnaReporte_total_3 As DataColumn
        Dim oDatarowReporte_total_3 As DataRow

        'tabla 4
        '------------------
        Dim odataSetReporte_4 As New DataSet
        Dim oDataTableReporte_4 As DataTable = New DataTable("tabla_reporte_4")
        Dim oDataColumnaReporte_4 As DataColumn
        Dim oDatarowReporte_4 As DataRow

        Dim odataSetReporte_total_4 As New DataSet
        Dim oDataTableReporte_total_4 As DataTable = New DataTable("tabla_reporte_total_4")
        Dim oDataColumnaReporte_total_4 As DataColumn
        Dim oDatarowReporte_total_4 As DataRow
        '------------------

        'tabla 5
        '------------------
        Dim odataSetReporte_5 As New DataSet
        Dim oDataTableReporte_5 As DataTable = New DataTable("tabla_reporte_5")
        Dim oDataColumnaReporte_5 As DataColumn
        Dim oDatarowReporte_5 As DataRow

        Dim odataSetReporte_total_5 As New DataSet
        Dim oDataTableReporte_total_5 As DataTable = New DataTable("tabla_reporte_total_5")
        Dim oDataColumnaReporte_total_5 As DataColumn
        Dim oDatarowReporte_total_5 As DataRow
        '------------------

        'tabla 6
        '------------------
        Dim odataSetReporte_6 As New DataSet
        Dim oDataTableReporte_6 As DataTable = New DataTable("tabla_reporte_6")
        Dim oDataColumnaReporte_6 As DataColumn
        Dim oDatarowReporte_6 As DataRow

        Dim odataSetReporte_total_6 As New DataSet
        Dim oDataTableReporte_total_6 As DataTable = New DataTable("tabla_reporte_total_6")
        Dim oDataColumnaReporte_total_6 As DataColumn
        Dim oDatarowReporte_total_6 As DataRow


        'tabla 7
        '------------------
        Dim odataSetReporte_7 As New DataSet
        Dim oDataTableReporte_7 As DataTable = New DataTable("tabla_reporte_7")
        Dim oDataColumnaReporte_7 As DataColumn
        Dim oDatarowReporte_7 As DataRow

        Dim odataSetReporte_total_7 As New DataSet
        Dim oDataTableReporte_total_7 As DataTable = New DataTable("tabla_reporte_total_7")
        Dim oDataColumnaReporte_total_7 As DataColumn
        Dim oDatarowReporte_total_7 As DataRow

        'tabla 8
        '------------------
        Dim odataSetReporte_8 As New DataSet
        Dim oDataTableReporte_8 As DataTable = New DataTable("tabla_reporte_8")
        Dim oDataColumnaReporte_8 As DataColumn
        Dim oDatarowReporte_8 As DataRow

        Dim odataSetReporte_total_8 As New DataSet
        Dim oDataTableReporte_total_8 As DataTable = New DataTable("tabla_reporte_total_8")
        Dim oDataColumnaReporte_total_8 As DataColumn
        Dim oDatarowReporte_total_8 As DataRow

        'tabla 9
        '------------------
        Dim odataSetReporte_9 As New DataSet
        Dim oDataTableReporte_9 As DataTable = New DataTable("tabla_reporte_9")
        Dim oDataColumnaReporte_9 As DataColumn
        Dim oDatarowReporte_9 As DataRow

        Dim odataSetReporte_total_9 As New DataSet
        Dim oDataTableReporte_total_9 As DataTable = New DataTable("tabla_reporte_total_9")
        Dim oDataColumnaReporte_total_9 As DataColumn
        Dim oDatarowReporte_total_9 As DataRow

        'tabla 10 tarjetas bancarias
        '------------------
        Dim odataSetReporte_10 As New DataSet
        Dim oDataTableReporte_10 As DataTable = New DataTable("tabla_reporte_10")
        Dim oDataColumnaReporte_10 As DataColumn
        Dim oDatarowReporte_10 As DataRow

        Dim odataSetReporte_total_10 As New DataSet
        Dim oDataTableReporte_total_10 As DataTable = New DataTable("tabla_reporte_total_10")
        Dim oDataColumnaReporte_total_10 As DataColumn
        Dim oDatarowReporte_total_10 As DataRow


        Dim strGrupo As String
        Dim strConcepto As String



        '---------------------------------------------------
        '--------------------------------------------------
        Dim strQuerys_varios_cortes As String

        'Dim hr_fecha_ini_varios_turnos As Date
        'Dim hr_fecha_fin_varios_turnos As Date
        'Dim bl_varios_turnos As Boolean = False

        Dim str_id_RESEAU As String
        Dim int_id_gare As Integer
        Dim str_id_voie As String
        Dim int_id_voie As Integer
        Dim int_numero_poste As Integer
        Dim dt_ini_poste As Date
        Dim dt_fin_poste As Date
        Dim str_MATRICULE As String

        Dim str_cajero As String = str_Cajero_Receptor
        Dim id_plaza_cobro_local As String = id_plaza_cobro

        Dim h_inicio_turno As Date
        Dim h_fin_turno As Date

        Dim dvEvento As DataView
        Dim dvEventoDos As DataView
        Dim dvTarifa As DataView

        'Dim strCarril As String
        Dim IdCarril As Integer

        Dim cont As Integer

        Dim db_tot_14 As Double
        Dim db_tot_15 As Double
        Dim db_tot_16 As Double
        Dim db_tot_18 As Double
        Dim db_tot_20 As Double
        Dim db_tot_22 As Double
        Dim db_tot_24 As Double
        Dim db_tot_26 As Double
        Dim db_tot_28 As Double
        Dim db_tot_30 As Double
        Dim db_tot_32 As Double

        Dim db_tot_35 As Double
        Dim db_tot_36 As Double

        Dim db_tot_38 As Double

        Dim db_tot_45 As Double
        Dim db_tot_451 As Double
        Dim db_tot_452 As Double
        Dim db_tot_453 As Double

        Dim db_tot_46 As Double
        Dim db_tot_461 As Double
        Dim db_tot_462 As Double
        Dim db_tot_463 As Double

        Dim db_tot_47 As Double
        Dim db_tot_471 As Double
        Dim db_tot_472 As Double
        Dim db_tot_473 As Double

        Dim db_tot_48 As Double
        Dim db_tot_49 As Double
        Dim db_tot_50 As Double

        Dim db_tot_53 As Double
        Dim db_tot_531 As Double
        Dim db_tot_532 As Double

        Dim db_tot_54 As Double
        Dim db_tot_541 As Double
        Dim db_tot_542 As Double

        Dim db_tot_55 As Double
        Dim db_tot_56 As Double
        Dim db_tot_57 As Double
        Dim db_tot_58 As Double


        Dim db_tot_77 As Double
        Dim db_tot_78 As Double
        Dim db_tot_80 As Double
        Dim db_tot_81 As Double


        Dim db_tot_61 As Double
        Dim db_tot_63 As Double


        Dim db_tot_67 As Double
        Dim db_tot_69 As Double

        Dim db_tot_73 As Double
        Dim db_tot_75 As Double

        'tarjetas bancarias
        Dim db_tot_146 As Double
        Dim db_tot_1461 As Double


        Dim db_tot_147 As Double
        Dim db_tot_1471 As Double


        Dim db_tot_148 As Double
        Dim db_tot_149 As Double
        Dim db_tot_150 As Double


        Dim int_version_tarifa As Double
        Dim dbl_tarifa_excedentes_asignada As Double
        'int_reporte
        'cajero-receptor = 1
        'turno = 2
        'caseta = 3

        Dim No_Turno As String

        Dim loc_operador As String
        Dim loc_id_site As Integer
        'Dim loc_id_gare As Integer

        '---------------------------------------------------
        '--------------------------------------------------
        Try

            ReportViewer2.LocalReport.DataSources.Clear()
            ReportViewer2.LocalReport.ReportEmbeddedResource = "rpt_Comparativo_Preliminar_Aforo_Ingreso_Transito_Vehicular.rdlc"


            'reporte cajero receptor
            If int_reporte = 1 Then

                loc_operador = str_Cajero_Receptor
                loc_id_site = id_plaza_cobro
                '--------------------------------------------------------
                '--------------------------------------------------------
                'verifico cuantos cortes tiene en ese turno CERRADOS
                strQuerys = "SELECT ID_NETWORK, ID_PLAZA,ID_LANE, LANE, BEGIN_DHM, END_DHM, BAG_NUMBER, REPORT_FLAG, GENERATION_DHM " &
 "FROM CLOSED_LANE_REPORT, SITE_GARE " &
 "where " &
 "CLOSED_LANE_REPORT.ID_PLAZA	=	SITE_GARE.id_Gare " &
  "AND	SITE_GARE.id_Site		=	'" & loc_id_site & "' "


                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "5 MATUTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "6 VESPERTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    h_inicio_turno = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    h_fin_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "4 NOCTURNO"
                End If

                strQuerys = strQuerys & "AND (BEGIN_DHM >= TO_DATE('" & Format(h_inicio_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) AND " &
           "(BEGIN_DHM <= TO_DATE('" & Format(h_fin_turno, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
           "order by BEGIN_DHM"

                If objQuerys.QueryDataSet(strQuerys, "CLOSED_LANE_REPORT") = 1 Then

                    'If oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Count = 1 Then
                    'ElseIf oDataSet.Tables("CLOSED_LANE_REPORT").Rows.Count > 1 Then

                    'Dim frmListas As New frmLineas
                    'objControl.limpia_Catalogos()
                    'frmListas.Tag = 5

                    strLinea = strQuerys
                    If strCarril = Nothing Then
                        Exit Sub
                    End If

                    'frmListas.ShowDialog()
                    'If Trim(strLinea1) <> "" Then

                    'bl_varios_turnos = True

                    'hr_fecha_ini_varios_turnos = CDate(strLinea1)
                    'hr_fecha_fin_varios_turnos = CDate(strLinea2)
                    'strCarril = strLinea3
                    'loc_id_gare = strLinea4



                    'Else
                    '    Me.Close()
                    '    Exit Sub
                    'End If

                    'End If

                End If

                'fin de verifico cuantos cortes tiene en ese turno




                '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Inicio
                'DATOS GENERALES



                Dim par1 As New ReportParameter()
                Dim par2 As New ReportParameter()
                Dim par3 As New ReportParameter()
                Dim par4 As New ReportParameter()
                Dim par5 As New ReportParameter()
                Dim par6 As New ReportParameter()
                Dim par7 As New ReportParameter()
                Dim par8 As New ReportParameter()
                Dim par9 As New ReportParameter()
                Dim par10 As New ReportParameter()
                Dim par11 As New ReportParameter()
                Dim parTituloCajeroReceptor As New ReportParameter()
                Dim parTituloNoCarril As New ReportParameter()
                Dim parTituloHoraInicial As New ReportParameter()
                Dim parTituloHoraFinal As New ReportParameter()
                Dim parTituloFolioInicial As New ReportParameter()
                Dim parTituloFolioFinal As New ReportParameter()
                Dim parTituloTurno As New ReportParameter()

                Dim parTituloNoNombreDelegacion As New ReportParameter()
                Dim parNoNombreCaseta As New ReportParameter()
                Dim parFechaOperacion As New ReportParameter()
                Dim parFechaEdicion As New ReportParameter()
                Dim parTituloReporte As New ReportParameter()





                par1.Name = "par1"
                par1.Values.Add(str_delegacion)

                par3.Name = "par3"
                par3.Values.Add(strCarril)

                str_id_voie = strCarril
                int_id_voie = IdCarril
                'int_numero_poste = CInt(oDataRow("Expr1"))

                par4.Name = "par4"
                par4.Values.Add(No_Turno)



                par6.Name = "par6"
                par6.Values.Add(Format((hr_fecha_fin_varios_turnos), "dd/MM/yyyy"))

                par8.Name = "par8"
                'par8.Values.Add(Format((hr_fecha_ini_varios_turnos), "MM/dd/yyyy HH:mm:ss"))
                par8.Values.Add(Format((hr_fecha_ini_varios_turnos), "HH:mm:ss"))
                dt_ini_poste = Format((hr_fecha_ini_varios_turnos), "MM/dd/yyyy HH:mm:ss")

                par9.Name = "par9"
                par9.Values.Add(Format((hr_fecha_fin_varios_turnos), "HH:mm:ss"))
                'dt_fin_poste = Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy HH:mm:ss")
                dt_fin_poste = Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy HH:mm:ss")

                par10.Name = "par10"
                'par10.Values.Add(oDataRow("FOLIO_NUMBER_OPEN"))
                par10.Values.Add(0)

                par11.Name = "par11"
                ''par11.Values.Add(oDataRow("FOLIO_NUMBER_CLOSE"))
                par11.Values.Add(0)

                '                strQuerys = "SELECT SUM(PRIX_TOTAL) AS Monto_1,  COUNT(*) AS Cruces, MIN(EVENT_NUMBER) AS minimo, MAX(EVENT_NUMBER) as maximo " & _
                '"FROM GEADBA.TRANSACTION,SITE_GARE " & _
                '"WHERE TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " & _
                '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
                '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                '                strQuerys = strQuerys & " " & _
                '                 "AND TRANSACTION.ID_GARE = " & loc_id_gare & " " & _
                '                 "AND VOIE = '" & strCarril & "' "

                '                If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then

                '                    'Dim par10 As New ReportParameter()
                '                    par10.Name = "par10"

                '                    If oDataRow("Cruces") > 0 Then
                '                        par10.Values.Add(oDataRow("minimo"))
                '                    Else
                '                        par10.Values.Add(0)
                '                    End If


                '                    'Dim par11 As New ReportParameter()
                '                    par11.Name = "par11"

                '                    If oDataRow("Cruces") > 0 Then
                '                        par11.Values.Add(oDataRow("maximo"))
                '                    Else
                '                        par11.Values.Add(0)
                '                    End If

                '                End If
                '---------------------------------




                'OPERADOR
                strQuerys = "SELECT MATRICULE , rtrim(NOM)||' '||rtrim(PRENOM) as nombre " &
             "FROM TABLE_PERSONNEL " &
             "WHERE Matricule = '" & loc_operador & "'"
                If objQuerys.QueryDataSetTres(strQuerys, "TABLE_PERSONNEL") = 1 Then

                    par7.Name = "par7"
                    par7.Values.Add(Trim(oDataRowTres("MATRICULE")) & "     " & Trim(oDataRowTres("nombre")))
                    str_MATRICULE = Trim(oDataRowTres("MATRICULE"))
                End If

                strQuerys = "SELECT  ID_RESEAU, ID_GARE, NOM_GARE, NOM_GARE_L2 " &
             "FROM GEADBA.TYPE_GARE " &
             "WHERE ID_GARE = " & loc_id_gare & ""

                strQuerys = "SELECT ID_SITE, NOM_SITE, NOM_SITE_L2 " &
            "FROM GEADBA.TYPE_SITE where ID_SITE = '" & loc_id_site & "'"

                If objQuerys.QueryDataSetTres(strQuerys, "TYPE_GARE") = 1 Then

                    par2.Name = "par2"


                    'par2.Values.Add(oDataRowTres("NOM_GARE"))
                    If id_plaza_cobro_local <> "08" Then
                        If id_plaza_cobro_local <> "09" Then
                            par2.Values.Add("1" & id_plaza_cobro_local & " " & oDataRowTres("NOM_SITE"))
                        Else
                            par2.Values.Add("001 BIS" & " " & oDataRowTres("NOM_SITE"))
                        End If

                    Else
                        par2.Values.Add("001" & " " & oDataRowTres("NOM_SITE"))
                    End If



                    'int_id_gare = oDataRowTres("ID_GARE")

                    'str_id_RESEAU = oDataRowTres("ID_RESEAU")

                End If

                'pantalla:RESUMEN DE INGRESO CAJERO




                par5.Name = "par5"
                'par5.Values.Add(Format((hr_fecha_fin_varios_turnos), "MM/dd/yyyy HH:mm:ss"))
                'par5.Values.Add(Format((hr_fecha_fin_varios_turnos), "dd/MM/yyyy"))
                par5.Values.Add(Format((dt_Fecha_Inicio), "dd/MM/yyyy"))



                parTituloCajeroReceptor.Name = "parTituloCajeroReceptor"
                parTituloCajeroReceptor.Values.Add("No. y Nombre del C-Receptor:")

                parTituloNoCarril.Name = "parTituloNoCarril"
                parTituloNoCarril.Values.Add("No.Carril:")

                parTituloHoraInicial.Name = "parTituloHoraInicial"
                parTituloHoraInicial.Values.Add("Hora Inicial:")

                parTituloHoraFinal.Name = "parTituloHoraFinal"
                parTituloHoraFinal.Values.Add("Hora Final:")

                parTituloFolioInicial.Name = "parTituloFolioInicial"
                parTituloFolioInicial.Values.Add("Folio Inicial:")

                parTituloFolioFinal.Name = "parTituloFolioFinal"
                parTituloFolioFinal.Values.Add("Folio Final:")

                parTituloTurno.Name = "porTituloTurno"
                parTituloTurno.Values.Add("No.Turno:")

                parTituloNoNombreDelegacion.Name = "parTituloNoNombreDelegacion"
                parTituloNoNombreDelegacion.Values.Add("No. y Nombre de Delegación:")

                parNoNombreCaseta.Name = "parNoNombreCaseta"
                parNoNombreCaseta.Values.Add("No. y Nombre de Caseta:")

                parFechaOperacion.Name = "parFechaOperacion"
                parFechaOperacion.Values.Add("Fecha de Operación:")

                parFechaEdicion.Name = "parFechaEdicion"
                parFechaEdicion.Values.Add("Fecha de emisión:")

                'parTituloReporte
                'REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR CAJERO-RECEPTOR
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR CAJERO-RECEPTOR DE CARRILES CERRADOS")

                Dim parameters() As ReportParameter = {par1, par2, par3, par4, par5, par6, par7, par8, par9, par10, par11, parTituloCajeroReceptor, parTituloNoCarril, parTituloHoraInicial, parTituloHoraFinal, parTituloFolioInicial, parTituloFolioFinal, parTituloTurno, parTituloNoNombreDelegacion, parNoNombreCaseta, parFechaOperacion, parFechaEdicion, parTituloReporte}
                ReportViewer2.LocalReport.SetParameters(parameters)

                'reporte turno
            ElseIf int_reporte = 2 Then


                If Mid(Trim(str_Turno_block), 1, 2) = "06" Then
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 06:00:00")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 13:59:59")
                    No_Turno = "5 MATUTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "14" Then
                    dt_ini_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")
                    No_Turno = "6 VESPERTINO"
                ElseIf Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                    dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                    'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                    dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 05:59:59")
                    No_Turno = "4 NOCTURNO"
                End If




                Dim parNoNombreCaseta As New ReportParameter()
                Dim par2 As New ReportParameter()

                parNoNombreCaseta.Name = "parNoNombreCaseta"
                parNoNombreCaseta.Values.Add("No. y Nombre de Delegación:")

                par2.Name = "par2"
                par2.Values.Add(str_delegacion)

                Dim parTituloCajeroReceptor As New ReportParameter()
                Dim par7 As New ReportParameter()

                parTituloCajeroReceptor.Name = "parTituloCajeroReceptor"
                parTituloCajeroReceptor.Values.Add("No. y Nombre de Caseta:")

                par7.Name = "par7"
                par7.Values.Add(str_Plaza_Cobro)

                Dim parTituloNoCarril As New ReportParameter()
                Dim par3 As New ReportParameter()

                parTituloNoCarril.Name = "parTituloNoCarril"
                parTituloNoCarril.Values.Add("No.Turno:")

                par3.Name = "par3"
                par3.Values.Add(No_Turno)

                Dim parTituloHoraInicial As New ReportParameter()

                parTituloHoraInicial.Name = "parTituloHoraInicial"
                parTituloHoraInicial.Values.Add("Tipo de Cambio Aplicado")

                Dim porTituloTurno As New ReportParameter()
                Dim par4 As New ReportParameter()

                porTituloTurno.Name = "porTituloTurno"
                porTituloTurno.Values.Add("Fecha de Operación:")

                par4.Name = "par4"

                If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                    par4.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "MM/dd/yyyy"))
                Else
                    par4.Values.Add(Format(dt_ini_poste, "MM/dd/yyyy"))
                End If

                Dim parTituloHoraFinal As New ReportParameter()
                Dim par9 As New ReportParameter()

                parTituloHoraFinal.Name = "parTituloHoraFinal"
                parTituloHoraFinal.Values.Add("Fecha de emisión:")

                par9.Name = "par9"
                par9.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR TURNO  DE CARRILES CERRADOS")

                Dim parameters() As ReportParameter = {parNoNombreCaseta, par2, parTituloCajeroReceptor, par7, parTituloNoCarril, par3, parTituloHoraInicial, porTituloTurno, par4, parTituloHoraFinal, par9, parTituloReporte, parTituloReporte}
                ReportViewer2.LocalReport.SetParameters(parameters)

                'dt_ini_poste()
                'dt_fin_poste()


            ElseIf int_reporte = 3 Then

                'h_inicio_turno = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 14:00:00")
                dt_ini_poste = CDate(Format(DateAdd(DateInterval.Day, -1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 22:00:00")
                'h_fin_turno = CDate(Format(DateAdd(DateInterval.Day, 1, dt_Fecha_Inicio), "MM/dd/yyyy") & " 05:59:59")
                dt_fin_poste = CDate(Format(dt_Fecha_Inicio, "MM/dd/yyyy") & " 21:59:59")


                Dim parNoNombreCaseta As New ReportParameter()
                Dim par2 As New ReportParameter()

                parNoNombreCaseta.Name = "parNoNombreCaseta"
                parNoNombreCaseta.Values.Add("No. y Nombre de Delegación:")

                par2.Name = "par2"
                par2.Values.Add(str_delegacion)

                Dim parTituloCajeroReceptor As New ReportParameter()
                Dim par7 As New ReportParameter()

                parTituloCajeroReceptor.Name = "parTituloCajeroReceptor"
                parTituloCajeroReceptor.Values.Add("No. y Nombre de Caseta:")

                par7.Name = "par7"
                par7.Values.Add(str_Plaza_Cobro)

                'Dim parTituloNoCarril As New ReportParameter()
                'Dim par3 As New ReportParameter()

                'parTituloNoCarril.Name = "parTituloNoCarril"
                'parTituloNoCarril.Values.Add("No.Turno:")

                'par3.Name = "par3"
                'par3.Values.Add(str_Turno_block)

                Dim parTituloHoraInicial As New ReportParameter()

                parTituloHoraInicial.Name = "parTituloHoraInicial"
                parTituloHoraInicial.Values.Add("Tipo de Cambio Aplicado")

                Dim porTituloTurno As New ReportParameter()
                Dim par4 As New ReportParameter()

                porTituloTurno.Name = "porTituloTurno"
                porTituloTurno.Values.Add("Fecha de Operación:")

                par4.Name = "par4"

                'If Mid(Trim(str_Turno_block), 1, 2) = "22" Then
                '    par4.Values.Add(Format(DateAdd(DateInterval.Day, 1, dt_ini_poste), "ddm/MM/yyyy"))
                'Else
                par4.Values.Add(Format(dt_fin_poste, "MM/dd/yyyy"))
                'End If

                Dim parTituloHoraFinal As New ReportParameter()
                Dim par9 As New ReportParameter()

                parTituloHoraFinal.Name = "parTituloHoraFinal"
                parTituloHoraFinal.Values.Add("Fecha de emisión:")

                par9.Name = "par9"
                par9.Values.Add(Format(Now, "MM/dd/yyyy"))

                Dim parTituloReporte As New ReportParameter()
                parTituloReporte.Name = "parTituloReporte"
                parTituloReporte.Values.Add("REPORTE COMPARATIVO Y PRELIMINAR DE AFORO E INGRESO POR DIA  DE CARRILES CERRADOS")

                Dim parameters() As ReportParameter = {parNoNombreCaseta, par2, parTituloCajeroReceptor, par7, parTituloHoraInicial, porTituloTurno, par4, parTituloHoraFinal, par9, parTituloReporte, parTituloReporte}
                ReportViewer2.LocalReport.SetParameters(parameters)


            End If

            'temino titulos

            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Grupo")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Concepto")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Descricion_clase")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "Numero_clase")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 1, "Numero")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            objControl.agregar_datacolum(oDataColumnaReporte, 2, "strNumero")
            oDataTableReporte.Columns.Add(oDataColumnaReporte)

            odataSetReporte.Tables.Add(oDataTableReporte)
            '--------------------------------------------------------
            '--------------------------------------------------------

            int_version_tarifa = 8

            'armo mis encabezados con las clases
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
            "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
            "FROM TYPE_CLASSE WHERE ID_CLASSE >= 1 AND ID_CLASSE <= 18"

            If objQuerys.QueryDataSetSiete(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'clases sin excedentes
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE ((ID_CLASSE >= 1 AND ID_CLASSE <= 9) or (ID_CLASSE >= 12 AND ID_CLASSE <= 15)) "

            If objQuerys.QueryDataSetCuatro(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'clases con excedentes
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE ((ID_CLASSE >= 10 AND ID_CLASSE <= 11) or (ID_CLASSE >= 16 AND ID_CLASSE <= 18)) "

            If objQuerys.QueryDataSetSeis(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'clases con excedentes asignados
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE ID_CLASSE >= 16 AND ID_CLASSE <= 17 "

            If objQuerys.QueryDataSetOcho(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'solo excedentes directos aclase
            strQuerys = "SELECT ID_CLASSE, ORDRE_AFFICHAGE, LIBELLE_CLASSE , LIBELLE_CLASSE_L2, LIBELLE_COURT1, " &
           "LIBELLE_COURT1_L2, LIBELLE_COURT2, LIBELLE_COURT2_L2 " &
           "FROM TYPE_CLASSE WHERE (ID_CLASSE >= 10 AND ID_CLASSE <= 11) or (ID_CLASSE = 18)"

            If objQuerys.QueryDataSetNueve(strQuerys, "TYPE_CLASSE") = 1 Then
            End If

            'Totales Tabla 1
            'Tarifa referenciada normal C12A
            'INICIO TARIFAS
            int_version_tarifa = 5

            'TRES MARIAS 
            'int_version_tarifa = 4


            strQuerys = "SELECT " &
                "TYPE_PAIEMENT.libelle_paiement_L2 " &
                ",Prix_Cl01 ,Prix_Cl02 ,Prix_Cl03 ,Prix_Cl04 ,Prix_Cl05 ,Prix_Cl06 ,Prix_Cl07 ,Prix_Cl08 ,Prix_Cl09 " &
                ",Prix_Cl10 ,Prix_Cl11 ,Prix_Cl12 ,Prix_Cl13 ,Prix_Cl14 ,Prix_Cl15 ,Prix_Cl16 ,Prix_Cl17 ,Prix_Cl18 " &
                ",Prix_Cl19, Prix_Cl20 " &
                ",TYPE_PAIEMENT.libelle_paiement " &
                ",TABLE_TARIF.CODE " &
                "FROM TABLE_TARIF, " &
                "TYPE_PAIEMENT " &
                "WHERE   TABLE_TARIF.CODE =	TYPE_PAIEMENT.Id_Paiement(+) "

            If int_reporte = 1 Then
                'strQuerys = strQuerys & "AND TABLE_TARIF.Id_Gare = '" & int_id_gare & "' "
            End If

            strQuerys = strQuerys & "AND TABLE_TARIF.Version_Tarif = " & int_version_tarifa & " " &
           "ORDER BY TABLE_TARIF.CODE "

            If objQuerys.QueryDataSetTarifa(strQuerys, "TABLE_TARIF") = 1 Then
            End If

            dvTarifa = oDataSetTarifa.Tables("TABLE_TARIF").DefaultView
            dvTarifa.RowFilter = "CODE = 1 "

            For cont = 0 To oDataSetSiete.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSiete = oDataSetSiete.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " TARIFA REF. Normal"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowSiete("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                'oDatarowReporte("strNumero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                'oDatarowReporte("Numero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                oDatarowReporte("Numero") = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSiete("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSiete("ID_CLASSE")), oDataRowSiete("ID_CLASSE"))), "###,###,##0.00")

                oDataTableReporte.Rows.Add(oDatarowReporte)
            Next

            '-------------------------------------------------------------------------
            dvTarifa = oDataSetTarifa.Tables("TABLE_TARIF").DefaultView
            dvTarifa.RowFilter = "CODE = 2 "

            For cont = 0 To oDataSetSiete.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSiete = oDataSetSiete.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " TARIFA REF. Reducida"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowSiete("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                'oDatarowReporte("strNumero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                'oDatarowReporte("Numero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                oDatarowReporte("Numero") = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSiete("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSiete("ID_CLASSE")), oDataRowSiete("ID_CLASSE"))), "###,###,##0.00")

                oDataTableReporte.Rows.Add(oDatarowReporte)
            Next

            '-------------------------------------------------------------------------
            dvTarifa = oDataSetTarifa.Tables("TABLE_TARIF").DefaultView
            dvTarifa.RowFilter = "CODE = 72 "

            For cont = 0 To oDataSetSiete.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSiete = oDataSetSiete.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "TARIFA REF. Pago Inmediato "

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowSiete("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                'oDatarowReporte("strNumero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                'oDatarowReporte("Numero") = Format(oDataRow("Prix_CL" & IIf(Len(CStr(oDataRowCuatro("ID_CLASSE"))) = 1, "0" & CStr(oDataRowCuatro("ID_CLASSE")), oDataRowCuatro("ID_CLASSE"))), "###,###,##0.00")
                oDatarowReporte("Numero") = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSiete("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSiete("ID_CLASSE")), oDataRowSiete("ID_CLASSE"))), "###,###,##0.00")

                oDataTableReporte.Rows.Add(oDatarowReporte)
            Next
            ' ''''''''''''''''''FIN TARIFAS





            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea



                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Normal Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea




                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "b"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'reducida aforo C17 C19 new


            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea




                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea




                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "c"
                strConcepto = " REDUCIDA Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "c"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next




            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "d"
                strConcepto = " Res. Pago Inmediato Aforo"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

                strGrupo = "d"
                strConcepto = "Ingreso"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'res pago inmediato aforo C21  C23 new fin




            '''''''''''''''''''''''''''''''
            'normal
            '''''''''''''''''''''''''''''''



            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea


                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


            Next

            'aforo total new fin


            'ingreso sin iva new
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''ingreso sin iva new fin


            ''IVA NEW
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next
            'IVA NEW FIN

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''



            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


            Next

            'aforo total new fin


            'ingreso sin iva new
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''ingreso sin iva new fin


            ''IVA NEW
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea


            '        oDatarowReporte("Numero") = 0
            '        oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea


            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next
            ''IVA NEW FIN

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''


            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "e"
                strConcepto = "Aforo Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0")

                oDataTableReporte.Rows.Add(oDatarowReporte)


            Next

            'aforo total new fin


            'ingreso sin iva new
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "f"
            '    strConcepto = "Ingreso S/I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''ingreso sin iva new fin


            ''IVA NEW
            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''excedentes asignados
            'For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto

            '    If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(1)
            '    ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
            '        oDatarowReporte("Descricion_clase") = encabezados_clases(9)
            '    End If

            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next

            ''solo exedentes
            'For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next


            ''solo excedentes directos aclase
            'For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "g"
            '    strConcepto = "I.V.A."

            '    oDatarowReporte = oDataTableReporte.NewRow

            '    oDatarowReporte("Grupo") = strGrupo
            '    oDatarowReporte("Concepto") = strConcepto
            '    oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
            '    oDatarowReporte("Numero_clase") = strLinea

            '    oDatarowReporte("Numero") = 0
            '    oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


            '    oDataTableReporte.Rows.Add(oDatarowReporte)

            'Next
            'IVA NEW FIN

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "h"
                strConcepto = "Ingreso Total"

                oDatarowReporte = oDataTableReporte.NewRow

                oDatarowReporte("Grupo") = strGrupo
                oDatarowReporte("Concepto") = strConcepto
                oDatarowReporte("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte("Numero_clase") = strLinea

                oDatarowReporte("Numero") = 0
                oDatarowReporte("strNumero") = Format(0, "###,###,##0.00")


                oDataTableReporte.Rows.Add(oDatarowReporte)

            Next
            'Ingreso Total new fin



            Dim rds As New ReportDataSource
            rds.Name = "DataSet1"
            rds.Value = odataSetReporte.Tables("tabla_reporte")

            ReportViewer2.LocalReport.DataSources.Add(rds)



            'Totales Tabla 1
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "Cantidad")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "Total")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "Tipo_Total")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            objControl.agregar_datacolum(oDataColumnaReporte_total, 2, "strNumero")
            oDataTableReporte_total.Columns.Add(oDataColumnaReporte_total)

            odataSetReporte_total.Tables.Add(oDataTableReporte_total)
            '--------------------------------------------------------


            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "001"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Nothing

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)

            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "002"
            oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = " Ingreso s/IVA"
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Nothing

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)



            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "003"
            oDatarowReporte_total("Total") = "             Total           "
            ' oDatarowReporte_total("Tipo_Total") = "I.V.A"
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Nothing

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '----------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "14"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_14, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "15"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Format(db_tot_15, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "15"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_15 - (db_tot_15 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "18"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_18, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "20"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Format(db_tot_20 / 1.16, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "20"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_20 - (db_tot_20 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '22
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "22"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_22, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "24"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Format(db_tot_24, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "24"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_24 - (db_tot_24 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "26"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Aforo"
            oDatarowReporte_total("strNumero") = Format(db_tot_26, "###,###,##0")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '------------------------------------------------------------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "28"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total("strNumero") = Format(db_tot_28, "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            '---------------
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "30"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total("strNumero") = Format(db_tot_30, "###,###,##0.00")

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)
            '---------------
            'Total
            'oDatarowReporte_total = oDataTableReporte_total.NewRow

            'oDatarowReporte_total("Cantidad") = "32"
            'oDatarowReporte_total("Total") = "             Total           "
            'oDatarowReporte_total("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total("strNumero") = "Total:"

            'oDataTableReporte_total.Rows.Add(oDatarowReporte_total)

            oDatarowReporte_total = oDataTableReporte_total.NewRow

            oDatarowReporte_total("Cantidad") = "32"
            oDatarowReporte_total("Total") = "             Total           "
            oDatarowReporte_total("Tipo_Total") = " Ingreso"
            oDatarowReporte_total("strNumero") = Format(db_tot_32, "###,###,##0.00")

            oDataTableReporte_total.Rows.Add(oDatarowReporte_total)

            '--------------------------------------------------------------------



            Dim rds_Total As New ReportDataSource
            rds_Total.Name = "DataSet2"
            rds_Total.Value = odataSetReporte_total.Tables("tabla_reporte_total")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total)




            'Tabla Dos
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Grupo")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Concepto")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Descricion_clase")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "Numero_clase")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 1, "Numero")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            objControl.agregar_datacolum(oDataColumnaReporte_2, 2, "strNumero")
            oDataTableReporte_2.Columns.Add(oDataColumnaReporte_2)

            odataSetReporte_2.Tables.Add(oDataTableReporte_2)
            '--------------------------------------------------------
            'pago en efectivo dollares new
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 1000 " &
    "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("Total")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 'dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_2("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_2("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("excedentes")
                    oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_2("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_2("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_2("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_2 = oDataTableReporte_2.NewRow

                oDatarowReporte_2("Grupo") = strGrupo
                oDatarowReporte_2("Concepto") = strConcepto
                oDatarowReporte_2("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_2("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_2("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_2("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_2("Numero") = 0
                    oDatarowReporte_2("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_2.Rows.Add(oDatarowReporte_2)

            Next










            Dim rds_2 As New ReportDataSource
            rds_2.Name = "DataSet3"
            rds_2.Value = odataSetReporte_2.Tables("tabla_reporte_2")

            ReportViewer2.LocalReport.DataSources.Add(rds_2)


            'Totales Tabla 2
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "Cantidad")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "Total")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "Tipo_Total")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            objControl.agregar_datacolum(oDataColumnaReporte_total_2, 2, "strNumero")
            oDataTableReporte_total_2.Columns.Add(oDataColumnaReporte_total_2)

            odataSetReporte_total_2.Tables.Add(oDataTableReporte_total_2)
            '--------------------------------------------------------
            oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            oDatarowReporte_total_2("Cantidad") = "36"
            oDatarowReporte_total_2("Total") = "             Total           "
            oDatarowReporte_total_2("Tipo_Total") = " Aforo"
            oDatarowReporte_total_2("strNumero") = Format(db_tot_36, "###,###,##0")

            oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            'oDatarowReporte_total_2("Cantidad") = "36"
            'oDatarowReporte_total_2("Total") = "             Total           "
            'oDatarowReporte_total_2("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_2("strNumero") = Format(db_tot_35 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '-------------------------------------------------------
            'oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            'oDatarowReporte_total_2("Cantidad") = "36"
            'oDatarowReporte_total_2("Total") = "             Total           "
            'oDatarowReporte_total_2("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_2("strNumero") = Format(db_tot_35 - (db_tot_35 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '-------------------------------------------------------
            'oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            'oDatarowReporte_total_2("Cantidad") = "38"
            'oDatarowReporte_total_2("Total") = "             Total           "
            'oDatarowReporte_total_2("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_2("strNumero") = "Total:"

            'oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '---------------------------------------------------
            oDatarowReporte_total_2 = oDataTableReporte_total_2.NewRow

            oDatarowReporte_total_2("Cantidad") = "38"
            oDatarowReporte_total_2("Total") = "             Total           "
            oDatarowReporte_total_2("Tipo_Total") = " Ingreso "
            oDatarowReporte_total_2("strNumero") = Format(db_tot_35, "###,###,##0.00")

            oDataTableReporte_total_2.Rows.Add(oDatarowReporte_total_2)
            '-------------------------------------------------------


            Dim rds_Total_2 As New ReportDataSource
            rds_Total_2.Name = "DataSet4"
            rds_Total_2.Value = odataSetReporte_total_2.Tables("tabla_reporte_total_2")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_2)



            'Tabla 3
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Grupo")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Concepto")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Descricion_clase")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "Numero_clase")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 1, "Numero")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            objControl.agregar_datacolum(oDataColumnaReporte_3, 2, "strNumero")
            oDataTableReporte_3.Columns.Add(oDataColumnaReporte_3)

            odataSetReporte_3.Tables.Add(oDataTableReporte_3)
            '--------------------------------------------------------
            'PAGO ANTICIPADO RESIDENTES NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 1000 " &
    "AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("Total")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 'dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_36 = db_tot_36 + 0 'dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_3("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_3("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("excedentes")
                    oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_3("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_3("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo"

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_3("Numero") = 0 'dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_36 = db_tot_36 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)


                strGrupo = "a"
                strConcepto = " Tarifa Ref."

                oDatarowReporte_3 = oDataTableReporte_3.NewRow

                oDatarowReporte_3("Grupo") = strGrupo
                oDatarowReporte_3("Concepto") = strConcepto
                oDatarowReporte_3("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_3("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = 0 'Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_3("Numero") = 0 'dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_3("strNumero") = 0 'Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_35 = db_tot_35 + 0 '(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_3("Numero") = 0
                    oDatarowReporte_3("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_3.Rows.Add(oDatarowReporte_3)

            Next


            Dim rds_3 As New ReportDataSource
            rds_3.Name = "DataSet5"
            rds_3.Value = odataSetReporte_3.Tables("tabla_reporte_3")

            ReportViewer2.LocalReport.DataSources.Add(rds_3)


            'Totales Tabla 3
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "Cantidad")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "Total")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "Tipo_Total")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            objControl.agregar_datacolum(oDataColumnaReporte_total_3, 2, "strNumero")
            oDataTableReporte_total_3.Columns.Add(oDataColumnaReporte_total_3)

            odataSetReporte_total_3.Tables.Add(oDataTableReporte_total_3)
            '--------------------------------------------------------
            oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            oDatarowReporte_total_3("Cantidad") = "36"
            oDatarowReporte_total_3("Total") = "             Total           "
            oDatarowReporte_total_3("Tipo_Total") = " Aforo"
            oDatarowReporte_total_3("strNumero") = Format(db_tot_36, "###,###,##0")

            oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            'oDatarowReporte_total_3("Cantidad") = "36"
            'oDatarowReporte_total_3("Total") = "             Total           "
            'oDatarowReporte_total_3("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_3("strNumero") = Format(db_tot_35 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '-------------------------------------------------------
            'oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            'oDatarowReporte_total_3("Cantidad") = "36"
            'oDatarowReporte_total_3("Total") = "             Total           "
            'oDatarowReporte_total_3("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_3("strNumero") = Format(db_tot_35 - (db_tot_35 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '-------------------------------------------------------
            'oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            'oDatarowReporte_total_3("Cantidad") = "38"
            'oDatarowReporte_total_3("Total") = "             Total           "
            'oDatarowReporte_total_3("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_3("strNumero") = "Total:"

            'oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '---------------------------------------------------
            oDatarowReporte_total_3 = oDataTableReporte_total_3.NewRow

            oDatarowReporte_total_3("Cantidad") = "38"
            oDatarowReporte_total_3("Total") = "             Total           "
            oDatarowReporte_total_3("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_3("strNumero") = Format(db_tot_35, "###,###,##0.00")

            oDataTableReporte_total_3.Rows.Add(oDatarowReporte_total_3)
            '-------------------------------------------------------


            Dim rds_Total_3 As New ReportDataSource
            rds_Total_3.Name = "DataSet6"
            rds_Total_3.Value = odataSetReporte_total_3.Tables("tabla_reporte_total_3")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_3)
            'fin tabla 3


            'tabla 4
            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Grupo")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Concepto")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Descricion_clase")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "Numero_clase")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 1, "Numero")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            objControl.agregar_datacolum(oDataColumnaReporte_4, 2, "strNumero")
            oDataTableReporte_4.Columns.Add(oDataColumnaReporte_4)

            odataSetReporte_4.Tables.Add(oDataTableReporte_4)

            'c45
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                    db_tot_47 = db_tot_47 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            Next


            '++++++++++++++++++++++++++
            'excedentes asignados
            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    'db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                    db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_4("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_46 = db_tot_46 + dvEvento(0).Item("excedentes")
                    db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")


                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES
            '++++++++++++++++++++++++++





            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)



            'c48 (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                    db_tot_50 = db_tot_50 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            Next


            '++++++++++++++++++++++++++++++++++++
            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_4("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                    'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                    db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                    db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    'oDatarowReporte_4("Numero") = dvEvento(0).Item("excedentes")
                    'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")

                    'db_tot_49 = db_tot_49 + dvEvento(0).Item("excedentes")
                    db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso IAVE"

                oDatarowReporte_4 = oDataTableReporte_4.NewRow

                oDatarowReporte_4("Grupo") = strGrupo
                oDatarowReporte_4("Concepto") = strConcepto
                oDatarowReporte_4("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_4("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11
                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces") * 2
                        'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")

                        ' db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        'db_tot_49 = db_tot_49 + (dvEvento(0).Item("cruces") * 2)
                        db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        'oDatarowReporte_4("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_4("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        oDatarowReporte_4("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_4("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_50 = db_tot_50 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_4("Numero") = 0
                    oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_4.Rows.Add(oDatarowReporte_4)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES

            '+++++++++++++++++++++++++++++++++++++



            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)

            oDatarowReporte_4 = oDataTableReporte_4.NewRow
            oDatarowReporte_4("Grupo") = strGrupo
            oDatarowReporte_4("Concepto") = strConcepto
            oDatarowReporte_4("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_4("Numero_clase") = strLinea
            oDatarowReporte_4("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_4.Rows.Add(oDatarowReporte_4)


            Dim rds_4 As New ReportDataSource
            rds_4.Name = "DataSet7"
            rds_4.Value = odataSetReporte_4.Tables("tabla_reporte_4")

            ReportViewer2.LocalReport.DataSources.Add(rds_4)


            'Fin Tabla 4----------------------------
            'inicio tabla 4 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "Cantidad")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "Total")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "Tipo_Total")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            objControl.agregar_datacolum(oDataColumnaReporte_total_4, 2, "strNumero")
            oDataTableReporte_total_4.Columns.Add(oDataColumnaReporte_total_4)

            odataSetReporte_total_4.Tables.Add(oDataTableReporte_total_4)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            oDatarowReporte_total_4("Cantidad") = "46"
            oDatarowReporte_total_4("Total") = "             Total           "
            oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            oDatarowReporte_total_4("strNumero") = Format(db_tot_46, "###,###,##0")

            oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "46"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_47 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            '--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "461"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_461, "###,###,##0")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "461"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_471 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            '--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "462"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_462, "###,###,##0")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "462"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_472 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            '--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "463"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_463, "###,###,##0")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "463"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_473 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "463"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_463, "###,###,##0")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "463"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_473 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------

            '--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "49"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_49, "###,###,##0")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''--------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "49"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_50 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            oDatarowReporte_total_4("Cantidad") = "49"
            oDatarowReporte_total_4("Total") = "             Total           "
            oDatarowReporte_total_4("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_4("strNumero") = Format(db_tot_50 - (db_tot_50 / 1.16), "###,###,##0.00")

            oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '----------------------------------------------------------------------------
            '-------------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "52"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_4("strNumero") = "Total:"

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            ''---------------------------------------------------
            'oDatarowReporte_total_4 = oDataTableReporte_total_4.NewRow

            'oDatarowReporte_total_4("Cantidad") = "52"
            'oDatarowReporte_total_4("Total") = "             Total           "
            'oDatarowReporte_total_4("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_4("strNumero") = Format(db_tot_50, "###,###,##0.00")

            'oDataTableReporte_total_4.Rows.Add(oDatarowReporte_total_4)
            '-------------------------------------------------------

            Dim rds_Total_4 As New ReportDataSource
            rds_Total_4.Name = "DataSet8"
            rds_Total_4.Value = odataSetReporte_total_4.Tables("tabla_reporte_total_4")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_4)
            'fin tabla 4 totoales

            '+++++++++++++++
            '***************
            'tarjetas bancarias inicia


            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Grupo")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Concepto")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Descricion_clase")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "Numero_clase")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 1, "Numero")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            objControl.agregar_datacolum(oDataColumnaReporte_10, 2, "strNumero")
            oDataTableReporte_10.Columns.Add(oDataColumnaReporte_10)

            odataSetReporte_10.Tables.Add(oDataTableReporte_10)

            'c45
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " ' & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 12 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_146 = db_tot_146 + dvEvento(0).Item("cruces")
                    db_tot_147 = db_tot_147 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    'db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_146 = db_tot_146 + dvEvento(0).Item("cruces")
                    db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_46 = db_tot_46 + dvEvento(0).Item("excedentes")
                    db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Crédito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")


                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_147 = db_tot_147 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES

            'excedentes fin

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            'inicio tarjeta de debito

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " ' & _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 14 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_1461 = db_tot_1461 + dvEvento(0).Item("cruces")
                    db_tot_1471 = db_tot_1471 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    'db_tot_15 = db_tot_15 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_1461 = db_tot_1461 + dvEvento(0).Item("cruces")
                    db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_46 = db_tot_46 + dvEvento(0).Item("excedentes")
                    db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Tarjeta de Débito"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")


                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        db_tot_1471 = db_tot_1471 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES

            'excedentes fin

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            'fin tarjeta de debito



            'c48 (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " '& _
            '"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " & _
            '"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            ElseIf int_reporte = 3 Then

                strQuerys = strQuerys & "AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
                "AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND MATRICULE <> '000000' "
            End If


            ' or ID_PAIEMENT = 12 or ID_PAIEMENT = 14
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 12 or ID_PAIEMENT = 14) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    db_tot_150 = db_tot_150 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'éxcedentes iave
            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    'db_tot_49 = db_tot_49 + dvEvento(0).Item("excedentes")
                    db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        ' db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        'db_tot_49 = db_tot_49 + (dvEvento(0).Item("cruces") * 2)
                        db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES



            'fin excedentes iave


            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            '***ingreso tarjetas bancarias
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_10("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    'db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    'db_tot_150 = db_tot_150 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            Next

            'éxcedentes iave
            'excedentes
            ' 1 excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_10("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                    'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")

                    '----------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    'db_tot_149 = db_tot_149 + dvEvento(0).Item("cruces")
                    'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '---------------------------------------------------------------------------------------------------

            Next

            '2 solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    'oDatarowReporte_10("Numero") = dvEvento(0).Item("excedentes")
                    'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")
                    '---------------------------------------------------------------------------------------
                    dvTarifa.RowFilter = "CODE = 1 "
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    'db_tot_49 = db_tot_49 + dvEvento(0).Item("excedentes")
                    'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

                '------------------------------------------------------------

            Next


            '3 solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Ingreso Tarjetas Bancarias"

                oDatarowReporte_10 = oDataTableReporte_10.NewRow

                oDatarowReporte_10("Grupo") = strGrupo
                oDatarowReporte_10("Concepto") = strConcepto
                oDatarowReporte_10("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_10("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11
                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                        'db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces")
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces") * 2
                        'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")

                        ' db_tot_46 = db_tot_46 + dvEvento(0).Item("cruces") * 2
                        'db_tot_47 = db_tot_47 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        'db_tot_49 = db_tot_49 + (dvEvento(0).Item("cruces") * 2)
                        'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        'oDatarowReporte_10("Numero") = dvEvento(0).Item("cruces")
                        'oDatarowReporte_10("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                        '-----------------------------------------------
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        oDatarowReporte_10("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_10("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")

                        'db_tot_49 = db_tot_49 + dvEvento(0).Item("cruces")
                        'db_tot_150 = db_tot_150 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_10("Numero") = 0
                    oDatarowReporte_10("strNumero") = Format(0, "###,###,##0.00")
                End If
                oDataTableReporte_10.Rows.Add(oDatarowReporte_10)
                '-----------------------------------------------------

            Next
            'FIN EXCEDENTES



            'fin excedentes iave


            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(10)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)

            oDatarowReporte_10 = oDataTableReporte_10.NewRow
            oDatarowReporte_10("Grupo") = strGrupo
            oDatarowReporte_10("Concepto") = strConcepto
            oDatarowReporte_10("Descricion_clase") = encabezados_clases(16)
            oDatarowReporte_10("Numero_clase") = strLinea
            oDatarowReporte_10("strNumero") = Format(0, "###,###,##0")
            oDataTableReporte_10.Rows.Add(oDatarowReporte_10)


            '***ingreso tarjetas bancarias fin



            Dim rds_10 As New ReportDataSource
            rds_10.Name = "DataSet19"
            rds_10.Value = odataSetReporte_10.Tables("tabla_reporte_10")

            ReportViewer2.LocalReport.DataSources.Add(rds_10)


            'Fin Tabla 4----------------------------
            'inicio tabla 4 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "Cantidad")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "Total")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "Tipo_Total")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            objControl.agregar_datacolum(oDataColumnaReporte_total_10, 2, "strNumero")
            oDataTableReporte_total_10.Columns.Add(oDataColumnaReporte_total_10)

            odataSetReporte_total_10.Tables.Add(oDataTableReporte_total_10)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "146"
            oDatarowReporte_total_10("Total") = "             Total           "
            oDatarowReporte_total_10("Tipo_Total") = " Aforo"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_146, "###,###,##0")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '--------------------------------------------------------
            'oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            'oDatarowReporte_total_10("Cantidad") = "146"
            'oDatarowReporte_total_10("Total") = "             Total           "
            'oDatarowReporte_total_10("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_10("strNumero") = Format(db_tot_147 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '----------------------------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "1461"
            oDatarowReporte_total_10("Total") = "             Total           "
            oDatarowReporte_total_10("Tipo_Total") = " Aforo"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_1461, "###,###,##0")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '--------------------------------------------------------
            'oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow



            ' ''tarjeta bancaria
            ' ''fin tarjeta bancaria
            ''--------------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "149"
            oDatarowReporte_total_10("Total") = "             Total           "
            oDatarowReporte_total_10("Tipo_Total") = " Aforo"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_149, "###,###,##0")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '--------------------------------------------------------

            '---------------------------------------------------
            oDatarowReporte_total_10 = oDataTableReporte_total_10.NewRow

            oDatarowReporte_total_10("Cantidad") = "152"
            oDatarowReporte_total_10("Total") = "             Total           "
            'oDatarowReporte_total_10("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_10("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_10("strNumero") = Format(db_tot_150, "###,###,##0.00")

            oDataTableReporte_total_10.Rows.Add(oDatarowReporte_total_10)
            '-------------------------------------------------------

            Dim rds_Total_10 As New ReportDataSource
            rds_Total_10.Name = "DataSet20"
            rds_Total_10.Value = odataSetReporte_total_10.Tables("tabla_reporte_total_10")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_10)


            'tarjetas bancarias fin
            '***************
            '+++++++++++++++







            'inicio_tabla_5


            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Grupo")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Concepto")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Descricion_clase")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "Numero_clase")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 1, "Numero")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            objControl.agregar_datacolum(oDataColumnaReporte_5, 2, "strNumero")
            oDataTableReporte_5.Columns.Add(oDataColumnaReporte_5)

            odataSetReporte_5.Tables.Add(oDataTableReporte_5)



            'c45b (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If


            strQuerys = strQuerys & "AND ID_PAIEMENT = 1000 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView


            'residente new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_531 = db_tot_531 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_541 = db_tot_541 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_531 = db_tot_531 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_5("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_531 = db_tot_531 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Residente"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_531 = db_tot_531 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_541 = db_tot_541 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next
            'residente new fin

            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "a"
            '    strConcepto = "Residente"

            '    oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '    oDatarowReporte_5("Grupo") = strGrupo
            '    oDatarowReporte_5("Concepto") = strConcepto
            '    oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_5("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_531 = db_tot_531 + dvEvento(0).Item("cruces")
            '        db_tot_541 = db_tot_541 + dvEvento(0).Item("cruces")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            'Next

            'c45c (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If


            strQuerys = strQuerys & "AND (ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            'gruas
            '            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or " & _
            '"  (ID_PAIEMENT = 0 AND ID_OBS_SEQUENCE = 'E')) " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'VSC NEW
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_532 = db_tot_532 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_542 = db_tot_542 + dvEvento(0).Item("Total")
                Else

                End If



            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_532 = db_tot_532 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If



            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_5("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_532 = db_tot_532 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If



            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "V.S.C."

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_532 = db_tot_532 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)




                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_542 = db_tot_542 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else

                End If



            Next
            'VSC NEW FIN




            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "a"
            '    strConcepto = "V.S.C."

            '    oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '    oDatarowReporte_5("Grupo") = strGrupo
            '    oDatarowReporte_5("Concepto") = strConcepto
            '    oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_5("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_532 = db_tot_532 + dvEvento(0).Item("cruces")
            '        db_tot_542 = db_tot_542 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            'Next




            'c48 (pend)
            '---------------------------------------------------------------------------------
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133)) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            'gruas
            '            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or " & _
            '"  (ID_PAIEMENT = 0 AND ID_OBS_SEQUENCE = 'E')) " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"



            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'aforo total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_56 = db_tot_56 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_57 = db_tot_57 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_5("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_56 = db_tot_56 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_5("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_56 = db_tot_56 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "Aforo Total"

                oDatarowReporte_5 = oDataTableReporte_5.NewRow

                oDatarowReporte_5("Grupo") = strGrupo
                oDatarowReporte_5("Concepto") = strConcepto
                oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_5("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_5("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_56 = db_tot_56 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_5("Numero") = 0
                    oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_57 = db_tot_57 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next

            'aforo total new fin


            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "b"
            '    strConcepto = "Aforo Total"

            '    oDatarowReporte_5 = oDataTableReporte_5.NewRow

            '    oDatarowReporte_5("Grupo") = strGrupo
            '    oDatarowReporte_5("Concepto") = strConcepto
            '    oDatarowReporte_5("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_5("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_5("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_56 = db_tot_56 + dvEvento(0).Item("cruces")
            '        db_tot_57 = db_tot_57 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_5("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_5.Rows.Add(oDatarowReporte_5)

            'Next


            Dim rds_5 As New ReportDataSource
            rds_5.Name = "DataSet9"
            rds_5.Value = odataSetReporte_5.Tables("tabla_reporte_5")

            ReportViewer2.LocalReport.DataSources.Add(rds_5)


            'Fin Tabla 4----------------------------
            'inicio tabla 4 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "Cantidad")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "Total")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "Tipo_Total")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            objControl.agregar_datacolum(oDataColumnaReporte_total_5, 2, "strNumero")
            oDataTableReporte_total_5.Columns.Add(oDataColumnaReporte_total_5)

            odataSetReporte_total_5.Tables.Add(oDataTableReporte_total_5)
            '--------------------------------------------------------
            '--------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "53"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            'oDatarowReporte_total_5("strNumero") = Format(db_tot_53, "###,###,##0")

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '--------------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "531"
            oDatarowReporte_total_5("Total") = "             Total           "
            oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_531, "###,###,##0")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)

            '--------------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "532"
            oDatarowReporte_total_5("Total") = "             Total           "
            oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_532, "###,###,##0")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '--------------------------------------------------------

            '--------------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "56"
            oDatarowReporte_total_5("Total") = "             Total           "
            oDatarowReporte_total_5("Tipo_Total") = " Aforo"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_56, "###,###,##0")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '--------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "56"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_5("strNumero") = Format(db_tot_57 / 1.16, "###,###,##0.00")

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            ''----------------------------------------------------------------------------
            ''--------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "56"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_5("strNumero") = Format(db_tot_57 - (db_tot_57 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            ''----------------------------------------------------------------------------
            ''-------------------------------------------------------
            'oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            'oDatarowReporte_total_5("Cantidad") = "59"
            'oDatarowReporte_total_5("Total") = "             Total           "
            'oDatarowReporte_total_5("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_5("strNumero") = "Total:"

            'oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '---------------------------------------------------
            oDatarowReporte_total_5 = oDataTableReporte_total_5.NewRow

            oDatarowReporte_total_5("Cantidad") = "59"
            oDatarowReporte_total_5("Total") = "             Total           "
            oDatarowReporte_total_5("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_5("strNumero") = Format(db_tot_57, "###,###,##0.00")

            oDataTableReporte_total_5.Rows.Add(oDatarowReporte_total_5)
            '-------------------------------------------------------

            Dim rds_Total_5 As New ReportDataSource
            rds_Total_5.Name = "DataSet10"
            rds_Total_5.Value = odataSetReporte_total_5.Tables("tabla_reporte_total_5")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_5)
            'fin tabla 5

            'tabla 6
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Grupo")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Concepto")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Descricion_clase")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "Numero_clase")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 1, "Numero")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            objControl.agregar_datacolum(oDataColumnaReporte_6, 2, "strNumero")
            oDataTableReporte_6.Columns.Add(oDataColumnaReporte_6)

            odataSetReporte_6.Tables.Add(oDataTableReporte_6)
            '--------------------------------------------------------

            'Pago en efectivo dlls por cajero-receptor C77 C78 (pend)
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
    "FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
    "WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
    "AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
    "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
    "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If


            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'F' " &
    "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            'AND ID_PAIEMENT = 0

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'reclasificaciones new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_77 = db_tot_77 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_78 = db_tot_78 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_77 = db_tot_77 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_6("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_77 = db_tot_77 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = " Reclasificaciones"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_77 = db_tot_77 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_78 = db_tot_78 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next

            'reclasificaciones new fin


            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)


            '    strGrupo = "a"
            '    strConcepto = " Reclasificaciones"

            '    oDatarowReporte_6 = oDataTableReporte_6.NewRow

            '    oDatarowReporte_6("Grupo") = strGrupo
            '    oDatarowReporte_6("Concepto") = strConcepto
            '    oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_6("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_77 = db_tot_77 + dvEvento(0).Item("cruces")
            '        db_tot_78 = db_tot_78 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_6.Rows.Add(oDatarowReporte_6)


            'Next


            'Pago en efectivo dlls por cajero-receptor C77 C78 (pend)
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
    "FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
    "WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
    "AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
    "AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
    "AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            'ID_CLASSE TAB_ID_CLASSE
            '        strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'F' " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6' " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView


            '"De" new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_80 = db_tot_80 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    db_tot_81 = db_tot_81 + dvEvento(0).Item("Total")
                Else

                End If

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_6("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_80 = db_tot_80 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))
                    db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else

                End If

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_6("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_80 = db_tot_80 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")


                    db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else

                End If

            Next

            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = "De"

                oDatarowReporte_6 = oDataTableReporte_6.NewRow

                oDatarowReporte_6("Grupo") = strGrupo
                oDatarowReporte_6("Concepto") = strConcepto
                oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_6("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_6("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_80 = db_tot_80 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_6("Numero") = 0
                    oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")

                        db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")

                        db_tot_81 = db_tot_81 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If

                Else

                End If

            Next
            '"De" new fin


            'If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            'End If

            'dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            'For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
            '    oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

            '    strGrupo = "b"
            '    strConcepto = "De"

            '    oDatarowReporte_6 = oDataTableReporte_6.NewRow

            '    oDatarowReporte_6("Grupo") = strGrupo
            '    oDatarowReporte_6("Concepto") = strConcepto
            '    oDatarowReporte_6("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
            '    oDatarowReporte_6("Numero_clase") = strLinea

            '    dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

            '    If dvEvento.Count >= 1 Then
            '        'oDatarowReporte("Numero") = dvEvento(0).Item("Total")
            '        oDatarowReporte_6("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
            '        db_tot_80 = db_tot_80 + dvEvento(0).Item("cruces")
            '        db_tot_81 = db_tot_81 + dvEvento(0).Item("Total")
            '    Else
            '        'oDatarowReporte("Numero") = 0
            '        oDatarowReporte_6("strNumero") = Format(0, "###,###,##0")
            '    End If

            '    oDataTableReporte_6.Rows.Add(oDatarowReporte_6)

            'Next



            Dim rds_6 As New ReportDataSource
            rds_6.Name = "DataSet11"
            rds_6.Value = odataSetReporte_6.Tables("tabla_reporte_6")

            ReportViewer2.LocalReport.DataSources.Add(rds_6)


            'Totales Tabla 6
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "Cantidad")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "Total")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "Tipo_Total")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            objControl.agregar_datacolum(oDataColumnaReporte_total_6, 2, "strNumero")
            oDataTableReporte_total_6.Columns.Add(oDataColumnaReporte_total_6)

            odataSetReporte_total_6.Tables.Add(oDataTableReporte_total_6)
            '--------------------------------------------------------
            oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            oDatarowReporte_total_6("Cantidad") = "77"
            oDatarowReporte_total_6("Total") = "             Total           "
            oDatarowReporte_total_6("Tipo_Total") = " Aforo"
            oDatarowReporte_total_6("strNumero") = Format(db_tot_77, "###,###,##0")

            oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "77"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_6("strNumero") = "Total:"

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "77"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_6("strNumero") = Format(db_tot_78, "###,###,##0.00")

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------
            '-------------------------------------------------------
            oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            oDatarowReporte_total_6("Cantidad") = "80"
            oDatarowReporte_total_6("Total") = "             Total           "
            oDatarowReporte_total_6("Tipo_Total") = " Aforo"
            oDatarowReporte_total_6("strNumero") = Format(db_tot_80, "###,###,##0")

            oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "80"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_6("strNumero") = "Total:"

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------
            '-----------------------------------------------------------------------------

            'oDatarowReporte_total_6 = oDataTableReporte_total_6.NewRow

            'oDatarowReporte_total_6("Cantidad") = "80"
            'oDatarowReporte_total_6("Total") = "             Total           "
            'oDatarowReporte_total_6("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_6("strNumero") = Format(db_tot_81, "###,###,##0.00")

            'oDataTableReporte_total_6.Rows.Add(oDatarowReporte_total_6)
            '-------------------------------------------------------

            Dim rds_Total_6 As New ReportDataSource
            rds_Total_6.Name = "DataSet12"
            rds_Total_6.Value = odataSetReporte_total_6.Tables("tabla_reporte_total_6")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_6)


            'fin tabla 6


            'inicio tabla 7

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Grupo")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Concepto")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Descricion_clase")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "Numero_clase")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 1, "Numero")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            objControl.agregar_datacolum(oDataColumnaReporte_7, 2, "strNumero")
            oDataTableReporte_7.Columns.Add(oDataColumnaReporte_7)

            odataSetReporte_7.Tables.Add(oDataTableReporte_7)

            'TOTAL MARCADO POR CAJERO RECEPTOR NEW
            'TABLA1 TABLA 7 NEW
            'aforo total new
            '''''''''''''''''''''''''''''''
            'normal
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
               "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_7("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next
            'Ingreso Total new fin

            'TABLA1 TABLA 7 NEW FIN

            'TABLA 4 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'TABLA 4 TABLA 7 FIN

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133)) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'TABLA 5 TABLA 7 NEW FIN

            'TABLA 6 TABLA 7 NEW FIN

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'FFFF' " &
  "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'TABLA 6 TABLA 7 NEW FIN


            'TABLA 6_2 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6666' " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_61 = db_tot_61 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_7("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_7("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_7("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_61 = db_tot_61 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_7 = oDataTableReporte_7.NewRow

                oDatarowReporte_7("Grupo") = strGrupo
                oDatarowReporte_7("Concepto") = strConcepto
                oDatarowReporte_7("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_7("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_7("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_7("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_63 = db_tot_63 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_7("Numero") = 0
                    oDatarowReporte_7("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_7.Rows.Add(oDatarowReporte_7)

            Next


            Dim rds_7 As New ReportDataSource
            rds_7.Name = "DataSet13"
            rds_7.Value = odataSetReporte_7.Tables("tabla_reporte_7")

            ReportViewer2.LocalReport.DataSources.Add(rds_7)



            'inicio tabla 7 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "Cantidad")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "Total")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "Tipo_Total")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            objControl.agregar_datacolum(oDataColumnaReporte_total_7, 2, "strNumero")
            oDataTableReporte_total_7.Columns.Add(oDataColumnaReporte_total_7)

            odataSetReporte_total_7.Tables.Add(oDataTableReporte_total_7)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            oDatarowReporte_total_7("Cantidad") = "61"
            oDatarowReporte_total_7("Total") = "             Total           "
            oDatarowReporte_total_7("Tipo_Total") = " Aforo"
            oDatarowReporte_total_7("strNumero") = Format(db_tot_61, "###,###,##0")

            oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            '--------------------------------------------------------

            oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            oDatarowReporte_total_7("Cantidad") = "63"
            oDatarowReporte_total_7("Total") = "             Total           "
            oDatarowReporte_total_7("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_7("strNumero") = Format(db_tot_63, "###,###,##0.00")

            oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            '----------------------------------------------------------------------------

            '--------------------------------------------------------
            'oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            'oDatarowReporte_total_7("Cantidad") = "63"
            'oDatarowReporte_total_7("Total") = "             Total           "
            'oDatarowReporte_total_7("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_7("strNumero") = Format(db_tot_63 - (db_tot_63 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            ''----------------------------------------------------------------------------
            ''-------------------------------------------------------
            'oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            'oDatarowReporte_total_7("Cantidad") = "65"
            'oDatarowReporte_total_7("Total") = "             Total           "
            'oDatarowReporte_total_7("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_7("strNumero") = "Total:"

            'oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            ''---------------------------------------------------
            'oDatarowReporte_total_7 = oDataTableReporte_total_7.NewRow

            'oDatarowReporte_total_7("Cantidad") = "65"
            'oDatarowReporte_total_7("Total") = "             Total           "
            'oDatarowReporte_total_7("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_7("strNumero") = Format(db_tot_63, "###,###,##0.00")

            'oDataTableReporte_total_7.Rows.Add(oDatarowReporte_total_7)
            '-------------------------------------------------------

            Dim rds_Total_7 As New ReportDataSource
            rds_Total_7.Name = "DataSet14"
            rds_Total_7.Value = odataSetReporte_total_7.Tables("tabla_reporte_total_7")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_7)

            'fin tabla 7



            'TABLA 8
            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Grupo")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Concepto")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Descricion_clase")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "Numero_clase")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 1, "Numero")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            objControl.agregar_datacolum(oDataColumnaReporte_8, 2, "strNumero")
            oDataTableReporte_8.Columns.Add(oDataColumnaReporte_8)

            odataSetReporte_8.Tables.Add(oDataTableReporte_8)


            'TOTAL DETECTADO POR EL EQUIPO DE CONTROL
            'TABLA1 TABLA 8 NEW
            'aforo total new
            '''''''''''''''''''''''''''''''
            'normal
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) " &
"AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            strQuerys = strQuerys & "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_8("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next
            'Ingreso Total new fin

            'TABLA1 TABLA 7 NEW FIN

            'TABLA 4 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_PAIEMENT = 15 " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'TABLA 4 TABLA 7 FIN

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133)) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'TABLA 5 TABLA 7 NEW FIN

            'TABLA 6 TABLA 7 NEW FIN

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'FFFF' " &
  "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'TABLA 6 TABLA 7 NEW FIN


            'TABLA 6_2 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6666' " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_67 = db_tot_67 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_8("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_8("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_8("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_67 = db_tot_67 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_8 = oDataTableReporte_8.NewRow

                oDatarowReporte_8("Grupo") = strGrupo
                oDatarowReporte_8("Concepto") = strConcepto
                oDatarowReporte_8("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_8("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_8("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_8("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_69 = db_tot_69 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_8("Numero") = 0
                    oDatarowReporte_8("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_8.Rows.Add(oDatarowReporte_8)

            Next






            Dim rds_8 As New ReportDataSource
            rds_8.Name = "DataSet15"
            rds_8.Value = odataSetReporte_8.Tables("tabla_reporte_8")

            ReportViewer2.LocalReport.DataSources.Add(rds_8)




            'inicio tabla 8 totoales
            '---------------------
            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "Cantidad")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "Total")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "Tipo_Total")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            objControl.agregar_datacolum(oDataColumnaReporte_total_8, 2, "strNumero")
            oDataTableReporte_total_8.Columns.Add(oDataColumnaReporte_total_8)

            odataSetReporte_total_8.Tables.Add(oDataTableReporte_total_8)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            oDatarowReporte_total_8("Cantidad") = "61"
            oDatarowReporte_total_8("Total") = "             Total           "
            oDatarowReporte_total_8("Tipo_Total") = " Aforo"
            oDatarowReporte_total_8("strNumero") = Format(db_tot_67, "###,###,##0")

            oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            '--------------------------------------------------------

            oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            oDatarowReporte_total_8("Cantidad") = "63"
            oDatarowReporte_total_8("Total") = "             Total           "
            oDatarowReporte_total_8("Tipo_Total") = " Ingreso"
            oDatarowReporte_total_8("strNumero") = Format(db_tot_69, "###,###,##0.00")

            oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            '----------------------------------------------------------------------------

            '--------------------------------------------------------
            'oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            'oDatarowReporte_total_8("Cantidad") = "63"
            'oDatarowReporte_total_8("Total") = "             Total           "
            'oDatarowReporte_total_8("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_8("strNumero") = Format(db_tot_69 - (db_tot_69 / 1.16), "###,###,##0.00")

            'oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            ''----------------------------------------------------------------------------
            ''-------------------------------------------------------
            'oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            'oDatarowReporte_total_8("Cantidad") = "65"
            'oDatarowReporte_total_8("Total") = "             Total           "
            'oDatarowReporte_total_8("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_8("strNumero") = "Total:"

            'oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            ''---------------------------------------------------
            'oDatarowReporte_total_8 = oDataTableReporte_total_8.NewRow

            'oDatarowReporte_total_8("Cantidad") = "65"
            'oDatarowReporte_total_8("Total") = "             Total           "
            'oDatarowReporte_total_8("Tipo_Total") = "I.V.A"
            'oDatarowReporte_total_8("strNumero") = Format(db_tot_69, "###,###,##0.00")

            'oDataTableReporte_total_8.Rows.Add(oDatarowReporte_total_8)
            '-------------------------------------------------------

            Dim rds_Total_8 As New ReportDataSource
            rds_Total_8.Name = "DataSet16"
            rds_Total_8.Value = odataSetReporte_total_8.Tables("tabla_reporte_total_8")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_8)


            'FIN TABLA 8

            'inicio tabla 9
            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Grupo")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Concepto")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Descricion_clase")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "Numero_clase")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 1, "Numero")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            objControl.agregar_datacolum(oDataColumnaReporte_9, 2, "strNumero")
            oDataTableReporte_9.Columns.Add(oDataColumnaReporte_9)

            odataSetReporte_9.Tables.Add(oDataTableReporte_9)

            'DIFERENCIA ENTRE TOTAL MARCADO POR EL CAJERO Y EL EQUIPO DE CONTROL DE TRANSITO NEW

            'DIF TABLA 7
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        oDatarowReporte_9("strNumero") = Format((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin

            'TABLA1 TABLA 7 NEW FIN

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133)) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'TABLA 5 TABLA 7 NEW FIN

            'TABLA 6 TABLA 7 NEW FIN

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'FFFF' " &
  "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'TABLA 6 TABLA 7 NEW FIN


            'TABLA 6_2 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.TAB_ID_CLASSE = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6666' " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("Total")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    db_tot_73 = db_tot_73 + dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = dvEvento(0).Item("excedentes")
                    oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("excedentes"), "###,###,##0")
                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")
                    'oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("Total"), "###,###,##0.00")
                    oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"), "###,###,##0.00")
                    db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces") * 2
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces") * 2, "###,###,##0")
                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dvEvento(0).Item("cruces"), "###,###,##0")
                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0")
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")
                        oDatarowReporte_9("strNumero") = Format(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"), "###,###,##0.00")
                        db_tot_75 = db_tot_75 + (dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'DIF TABLA 7 FIN

            'DIF TABLA 8
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) " &
"AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys &
                                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            strQuerys = strQuerys & "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"



            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces") * 2

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin

            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If

                Else
                    oDatarowReporte_9("Numero") = 0
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin


            'abc
            'aforo total new
            '''''''''''''''''''''''''''''''
            'REDUCIDA Aforo
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            '            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0
                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces") * 2

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 2 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin


            'EFG
            'aforo total new
            '''''''''''''''''''''''''''''''
            'RES PAGO INMEDIATO AFORO
            '''''''''''''''''''''''''''''''
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) " &
"AND (DATE_DEBUT_POSTE >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_DEBUT_POSTE <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            '" Normal Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 1 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '" REDUCIDA Aforo"
            '            strQuerys = strQuerys & "AND ID_PAIEMENT = 2 " & _
            '"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " & _
            '"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            '            '" Res. Pago Inmediato Aforo"
            strQuerys = strQuerys & "AND (ID_PAIEMENT = 71 or ID_PAIEMENT = 72 or ID_PAIEMENT = 73 or ID_PAIEMENT = 74 or ID_PAIEMENT = 10) " &
"AND (ID_OBS_SEQUENCE = '7' or ID_OBS_SEQUENCE = 'F') " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")
                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)




            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces") * 2

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_14 = db_tot_14 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


            Next

            'aforo total new fin



            'Ingreso Total new
            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                    db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes")))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 72 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + ((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2)))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -((dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces")))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0
                    oDatarowReporte_9("strNumero") = Format(0, "###,###,##0.00")
                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next
            'Ingreso Total new fin

            'TABLA1 TABLA 7 NEW FIN

            'TABLA 5 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ((ID_PAIEMENT = 27 and ID_OBS_SEQUENCE = '0') or (ID_PAIEMENT = 133)) " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -(dvEvento(0).Item("cruces") * 2)

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'TABLA 5 TABLA 7 NEW FIN

            'TABLA 6 TABLA 7 NEW FIN

            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_SEQUENCE = 'FFFF' " &
  "GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -(dvEvento(0).Item("cruces") * 2)

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'TABLA 6 TABLA 7 NEW FIN


            'TABLA 6_2 TABLA 7 NEW
            strQuerys = "SELECT TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2,SUM(PRIX_TOTAL) AS Total, count(*) as cruces, SUM(code_grille_tarif) as excedentes  " &
"FROM TRANSACTION, TYPE_CLASSE,SITE_GARE " &
"WHERE TRANSACTION.ACD_CLASS = TYPE_CLASSE.ID_CLASSE " &
"AND TRANSACTION.ID_GARE = SITE_GARE.ID_GARE " &
"AND (DATE_TRANSACTION >= TO_DATE('" & Format(dt_ini_poste, "yyyyMMddHHmmss") & "', 'YYYYMMDDHH24MISS')) " &
"AND (DATE_TRANSACTION <= TO_DATE('" & Format(dt_fin_poste, "yyyyMMddHHmmss") & "','YYYYMMDDHH24MISS')) "

            If int_reporte = 1 Then

                strQuerys = strQuerys & "AND (MATRICULE = '" & str_MATRICULE & "') " &
                "AND VOIE = '" & str_id_voie & "' "

            ElseIf int_reporte = 2 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            ElseIf int_reporte = 3 Then
                strQuerys = strQuerys & "AND ID_SITE = " & id_plaza_cobro_local & " AND ID_OBS_PASSAGE = 3 AND MATRICULE = '000000' "
            End If

            strQuerys = strQuerys & "AND ID_OBS_PASSAGE = '6666' " &
"GROUP BY TYPE_CLASSE.ID_CLASSE, TYPE_CLASSE.ORDRE_AFFICHAGE, TYPE_CLASSE.LIBELLE_CLASSE, TYPE_CLASSE.LIBELLE_CLASSE_L2, TYPE_CLASSE.LIBELLE_COURT1, TYPE_CLASSE.LIBELLE_COURT2"

            If objQuerys.QueryDataSet(strQuerys, "TRANSACTION") = 1 Then
            End If

            dvEvento = oDataSet.Tables("TRANSACTION").DefaultView

            For cont = 0 To oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowCuatro = oDataSetCuatro.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowCuatro("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowCuatro("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("Total")

                    db_tot_75 = db_tot_75 + -dvEvento(0).Item("Total")
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'excedentes asignados
            For cont = 0 To gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowSeis = gloDataSetSeis.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then
                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    db_tot_73 = db_tot_73 + -dvEvento(0).Item("cruces")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto

                If oDataRowSeis("ID_CLASSE") = 10 Or oDataRowSeis("ID_CLASSE") = 11 Or oDataRowSeis("ID_CLASSE") = 17 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(1)
                ElseIf oDataRowSeis("ID_CLASSE") = 16 Or oDataRowSeis("ID_CLASSE") = 17 Or oDataRowSeis("ID_CLASSE") = 18 Then
                    oDatarowReporte_9("Descricion_clase") = encabezados_clases(9)
                End If

                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowSeis("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowSeis("ID_CLASSE"))) = 1, "0" & CStr(oDataRowSeis("ID_CLASSE")), oDataRowSeis("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & asignacion_excedente_clase(oDataRowSeis("ID_CLASSE")))

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next

            'solo exedentes
            For cont = 0 To oDataSetOcho.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowOcho = oDataSetOcho.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,12

                    oDatarowReporte_9("Numero") = -dvEvento(0).Item("excedentes")

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowOcho("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowOcho("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "
                    'dbl_tarifa_excedentes_asignada = dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE")))
                    dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL" & IIf(Len(CStr(oDataRowOcho("ID_CLASSE"))) = 1, "0" & CStr(oDataRowOcho("ID_CLASSE")), oDataRowOcho("ID_CLASSE"))), "###,###,##0.00")

                    oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))

                    db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("excedentes"))
                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next


            'solo excedentes directos aclase
            For cont = 0 To oDataSetNueve.Tables("TYPE_CLASSE").Rows.Count - 1
                oDataRowNueve = oDataSetNueve.Tables("TYPE_CLASSE").Rows.Item(cont)

                strGrupo = "a"
                strConcepto = "Aforo"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    '10,11

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        oDatarowReporte_9("Numero") = -(dvEvento(0).Item("cruces") * 2)

                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then
                        oDatarowReporte_9("Numero") = -dvEvento(0).Item("cruces")

                    End If

                    'db_tot_73 = db_tot_73 + dvEvento(0).Item("excedentes")

                Else
                    oDatarowReporte_9("Numero") = 0

                End If
                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)


                strGrupo = "b"
                strConcepto = " Ingreso"

                oDatarowReporte_9 = oDataTableReporte_9.NewRow

                oDatarowReporte_9("Grupo") = strGrupo
                oDatarowReporte_9("Concepto") = strConcepto
                oDatarowReporte_9("Descricion_clase") = encabezados_clases(oDataRowNueve("ID_CLASSE"))
                oDatarowReporte_9("Numero_clase") = strLinea

                dvEvento.RowFilter = "ID_CLASSE = " & oDataRowNueve("ID_CLASSE") & " "

                If dvEvento.Count >= 1 Then

                    dvTarifa.RowFilter = "CODE = 1 "

                    If oDataRowNueve("ID_CLASSE") = 10 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    ElseIf oDataRowNueve("ID_CLASSE") = 11 Then
                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL17"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * (dvEvento(0).Item("cruces") * 2))


                    ElseIf oDataRowNueve("ID_CLASSE") = 18 Then

                        dbl_tarifa_excedentes_asignada = Format(dvTarifa(0).Item("Prix_CL16"), "###,###,##0.00")
                        oDatarowReporte_9("Numero") = -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                        db_tot_75 = db_tot_75 + -(dbl_tarifa_excedentes_asignada * dvEvento(0).Item("cruces"))

                    End If



                Else
                    oDatarowReporte_9("Numero") = 0

                End If

                oDataTableReporte_9.Rows.Add(oDatarowReporte_9)

            Next




            Dim rds_9 As New ReportDataSource
            rds_9.Name = "DataSet17"
            rds_9.Value = odataSetReporte_9.Tables("tabla_reporte_9")

            ReportViewer2.LocalReport.DataSources.Add(rds_9)


            'tabla 9 totales
            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "Cantidad")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "Total")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "Tipo_Total")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            objControl.agregar_datacolum(oDataColumnaReporte_total_9, 2, "strNumero")
            oDataTableReporte_total_9.Columns.Add(oDataColumnaReporte_total_9)

            odataSetReporte_total_9.Tables.Add(oDataTableReporte_total_9)
            '--------------------------------------------------------
            '--------------------------------------------------------
            oDatarowReporte_total_9 = oDataTableReporte_total_9.NewRow

            oDatarowReporte_total_9("Cantidad") = "73"
            oDatarowReporte_total_9("Total") = "             Total           "
            oDatarowReporte_total_9("Tipo_Total") = " Aforo"
            oDatarowReporte_total_9("strNumero") = Format(db_tot_73, "###,###,##0")

            oDataTableReporte_total_9.Rows.Add(oDatarowReporte_total_9)
            '--------------------------------------------------------

            'oDatarowReporte_total_9 = oDataTableReporte_total_9.NewRow

            'oDatarowReporte_total_9("Cantidad") = "75"
            'oDatarowReporte_total_9("Total") = "             Total           "
            'oDatarowReporte_total_9("Tipo_Total") = " Ingreso s/IVA"
            'oDatarowReporte_total_9("strNumero") = "Total:"

            'oDataTableReporte_total_9.Rows.Add(oDatarowReporte_total_9)
            '----------------------------------------------------------------------------

            '--------------------------------------------------------
            oDatarowReporte_total_9 = oDataTableReporte_total_9.NewRow

            oDatarowReporte_total_9("Cantidad") = "75"
            oDatarowReporte_total_9("Total") = "             Total           "
            oDatarowReporte_total_9("Tipo_Total") = "I.V.A"
            oDatarowReporte_total_9("strNumero") = Format(db_tot_75, "###,###,##0.00")

            oDataTableReporte_total_9.Rows.Add(oDatarowReporte_total_9)
            '----------------------------------------------------------------------------
            '-------------------------------------------------------

            Dim rds_Total_9 As New ReportDataSource
            rds_Total_9.Name = "DataSet18"
            rds_Total_9.Value = odataSetReporte_total_9.Tables("tabla_reporte_total_9")

            ReportViewer2.LocalReport.DataSources.Add(rds_Total_9)

            'fin tabla 9




            ReportViewer2.SetDisplayMode(DisplayMode.PrintLayout)
            Me.ReportViewer2.RefreshReport()




        Catch ex As Exception
            'MsgBox(ex.ToString)
        End Try



    End Sub

    Private Sub BindingSource1_CurrentChanged(sender As Object, e As EventArgs) Handles BindingSource1.CurrentChanged

    End Sub

End Class
